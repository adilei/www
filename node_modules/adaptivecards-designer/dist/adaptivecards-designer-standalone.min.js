var ACDesigner=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=40)}([function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(37)),i(n(4)),i(n(19)),i(n(7)),i(n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(39),o=function(){function e(e,t){this.supportsActionBar=!1,this.name=e,this.styleSheet=t,this._cardHost=document.createElement("div"),this._cardHost.className="cardHost"}return e.prototype.initialize=function(){i.AdaptiveCard.elementTypeRegistry.reset(),i.AdaptiveCard.actionTypeRegistry.reset(),i.AdaptiveCard.useMarkdownInRadioButtonAndCheckbox=!0,i.AdaptiveCard.useAdvancedCardBottomTruncation=!1,i.AdaptiveCard.useAdvancedTextBlockTruncation=!0},e.prototype.getBackgroundColor=function(){return"#F6F6F6"},e.prototype.parseElement=function(e,t){},e.prototype.anchorClicked=function(e,t){return!1},e.prototype.getHostConfig=function(){return new i.HostConfig(r)},Object.defineProperty(e.prototype,"cardHost",{get:function(){return this._cardHost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFixedHeight",{get:function(){return!1},enumerable:!0,configurable:!0}),e}();t.HostContainer=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_TAB=9,t.KEY_ENTER=13,t.KEY_ESCAPE=27,t.KEY_UP=38,t.KEY_DOWN=40,t.KEY_DELETE=46},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.prototype.validateRootElement=function(e){},e.prototype.keyDown=function(e){},Object.defineProperty(e.prototype,"rootElement",{get:function(){return this._rootElement},enumerable:!0,configurable:!0}),e.prototype.attach=function(e){var t=this;this.validateRootElement(e),this._rootElement=e,this._rootElement.onkeydown=function(e){t.keyDown(e)}},e}();t.InputControl=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.Default="default",e.Positive="positive",e.Destructive="destructive",e}();t.ActionStyle=i,function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(t.Size||(t.Size={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(t.SizeUnit||(t.SizeUnit={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(t.TextSize||(t.TextSize={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(t.TextWeight||(t.TextWeight={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(t.FontType||(t.FontType={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(t.Spacing||(t.Spacing={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(t.TextColor||(t.TextColor={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(t.ActionAlignment||(t.ActionAlignment={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(t.ImageStyle||(t.ImageStyle={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(t.ShowCardActionMode||(t.ShowCardActionMode={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(t.FillMode||(t.FillMode={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(t.ActionIconPlacement||(t.ActionIconPlacement={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email"}(t.InputTextStyle||(t.InputTextStyle={})),function(e){e[e.Optional=0]="Optional",e[e.Required=1]="Required",e[e.RequiredWithVisualCue=2]="RequiredWithVisualCue"}(t.InputValidationNecessity||(t.InputValidationNecessity={}));var r=function(){function e(){}return e.Default="default",e.Emphasis="emphasis",e.Accent="accent",e.Good="good",e.Attention="attention",e.Warning="warning",e}();t.ContainerStyle=r,function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId"}(t.ValidationError||(t.ValidationError={})),function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(t.ContainerFitStatus||(t.ContainerFitStatus={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(21),r=function(){function e(){}return e.getLongDayName=function(t){if(t>=0&&t<e.longDayNames.length)return e.longDayNames[t];throw new Error("Day index out of range: "+t)},e.getShortDayName=function(t){if(t>=0&&t<e.shortDayNames.length)return e.shortDayNames[t];throw new Error("Day index out of range: "+t)},e.getInitialDayName=function(t){if(t>=0&&t<e.minimalDayNames.length)return e.minimalDayNames[t];throw new Error("Day index out of range: "+t)},e.getLongMonthName=function(t){if(t>=0&&t<e.longMonthNames.length)return e.longMonthNames[t];throw new Error("Month index out of range: "+t)},e.getShortMonthName=function(t){if(t>=0&&t<e.shortMonthNames.length)return e.shortMonthNames[t];throw new Error("Month index out of range: "+t)},e.monthsInYear=12,e.daysInWeek=7,e.firstDayOfWeek=i.DayOfWeek.Sunday,e.longDayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.shortDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.minimalDayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],e.longMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],e.shortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e}();function o(e,t){var n=new Date(e.getTime());return n.setDate(n.getDate()+t),n}t.CalendarSettings=r,t.daysInMonth=function(e,t){switch(t){case 1:return e%4==0&&e%100||e%400==0?29:28;case 3:case 5:case 8:case 10:return 30;default:return 31}},t.addDays=o,t.addMonths=function(e,t){var n=new Date(e.getTime()),i=n.getMonth()+t;return n.setMonth(i),n.getMonth()!==(i%r.monthsInYear+r.monthsInYear)%r.monthsInYear&&(n=o(n,-n.getDate())),n},t.areDatesEqual=function(e,t){return e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()},t.getScrollX=function(){return window.pageXOffset},t.getScrollY=function(){return window.pageYOffset},t.getAttributeValueAsBool=function(e,t,n){var i=e.attributes[t];return i?"true"===i.value:n},t.getAttributeValueAsString=function(e,t,n){var i=e.attributes[t];return i?i.value:n},t.getAttributeValueAsInt=function(e,t,n){var i=e.attributes[t];if(i){var r=parseInt(i.value);if(!isNaN(r))return r}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DRAG_THRESHOLD=10;var i=function(){function e(){}return e.prototype.releasePointerCapture=function(e){this.getDragSourceElement().releasePointerCapture(e),this._isPointerDown=!1},Object.defineProperty(e.prototype,"isPointerOver",{get:function(){return this._isPointerOver},set:function(e){e!=this._isPointerOver&&(this._isPointerOver=e,this.updateLayout())},enumerable:!0,configurable:!0}),e.prototype.startDrag=function(){this.isDraggable()&&!this.dragging&&(this.dragging=!0,this.onStartDrag&&this.onStartDrag(this))},e.prototype.pointerDown=function(e){this._isPointerDown||(this._isPointerDown=!0,this._lastClickedPoint={x:e.offsetX,y:e.offsetY},this.getDragSourceElement().setPointerCapture(e.pointerId))},e.prototype.pointerUp=function(e){this._isPointerDown&&(this.releasePointerCapture(e.pointerId),this.endDrag())},e.prototype.pointerMove=function(e){this._isPointerDown&&(Math.abs(e.offsetX-this._lastClickedPoint.x)>=t.DRAG_THRESHOLD||Math.abs(e.offsetY-this._lastClickedPoint.y)>=t.DRAG_THRESHOLD)&&(this.releasePointerCapture(e.pointerId),this.startDrag())},e.prototype.click=function(e){this.onClick&&this.onDoubleClick(this)},e.prototype.doubleClick=function(e){this.onDoubleClick&&this.onDoubleClick(this)},e.prototype.internalUpdateCssStyles=function(){},e.prototype.internalUpdateLayout=function(){},e.prototype.getDragSourceElement=function(){return this._renderedElement},e.prototype.isDraggable=function(){return!0},e.prototype.endDrag=function(){this.dragging&&(this.dragging=!1,this.onEndDrag&&this.onEndDrag(this))},e.prototype.updateLayout=function(){this.internalUpdateCssStyles(),this.internalUpdateLayout()},e.prototype.render=function(){var e=this;this._renderedElement=this.internalRender();var t=this.getDragSourceElement();return t.onclick=function(t){e.click(t)},t.ondblclick=function(t){e.doubleClick(t)},this.isDraggable()&&(t.onmousedown=function(e){e.preventDefault()},t.onpointerenter=function(){e.isPointerOver=!0},t.onpointerleave=function(){e.isPointerOver=!1},t.onpointerdown=function(t){e.pointerDown(t)},t.onpointerup=function(t){e.pointerUp(t)},t.onpointermove=function(t){e.pointerMove(t)}),this._renderedElement},Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragging",{get:function(){return this._dragging},set:function(e){this._dragging=e,this.internalUpdateCssStyles()},enumerable:!0,configurable:!0}),e}();t.DraggableElement=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4);t.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var r=function(){function e(){this._isProcessed=!1,this._original=null,this._processed=null}return e.prototype.getReferencedInputs=function(e,t){if(!t)throw new Error("The referencedInputs parameter cannot be null.");for(var n=0,i=e;n<i.length;n++){var r=i[n];null!=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original)&&(t[r.id]=r)}},e.prototype.substituteInputValues=function(e,n){this._processed=this._original;for(var i,r=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;null!=(i=r.exec(this._original));){for(var o=null,a=0,s=Object.keys(e);a<s.length;a++){var l=s[a];if(l.toLowerCase()==i[1].toLowerCase()){o=e[l];break}}if(o){var c="";o.value&&(c=o.value),n===t.ContentTypes.applicationJson?c=(c=JSON.stringify(c)).slice(1,-1):n===t.ContentTypes.applicationXWwwFormUrlencoded&&(c=encodeURIComponent(c)),this._processed=this._processed.replace(i[0],c)}}this._isProcessed=!0},e.prototype.getOriginal=function(){return this._original},e.prototype.get=function(){return this._isProcessed?this._processed:this._original},e.prototype.set=function(e){this._original=e,this._isProcessed=!1},e}();t.StringWithSubstitutions=r;var o=function(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=i};t.SpacingDefinition=o;var a=function(e,t,n,r){void 0===e&&(e=i.Spacing.None),void 0===t&&(t=i.Spacing.None),void 0===n&&(n=i.Spacing.None),void 0===r&&(r=i.Spacing.None),this.top=i.Spacing.None,this.right=i.Spacing.None,this.bottom=i.Spacing.None,this.left=i.Spacing.None,this.top=e,this.right=t,this.bottom=n,this.left=r};t.PaddingDefinition=a;var s=function(){function e(e,t){this.physicalSize=e,this.unit=t}return e.parse=function(t,n){void 0===n&&(n=!1);var r=new e(0,i.SizeUnit.Weight);if("number"==typeof t)return r.physicalSize=t,r;if("string"==typeof t){var o=/^([0-9]+)(px|\*)?$/g.exec(t),a=n?3:2;if(o&&o.length>=a)return r.physicalSize=parseInt(o[1]),3==o.length&&"px"==o[2]&&(r.unit=i.SizeUnit.Pixel),r}throw new Error("Invalid size: "+t)},e}();t.SizeAndUnit=s;
/**
 * Fast UUID generator, RFC4122 version 4 compliant.
 * @author Jeff Ward (jcward.com).
 * @license MIT license
 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
 **/
var l=function(){function e(){}return e.generate=function(){var t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return e.lut[255&t]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[255&n]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[63&i|128]+e.lut[i>>8&255]+"-"+e.lut[i>>16&255]+e.lut[i>>24&255]+e.lut[255&r]+e.lut[r>>8&255]+e.lut[r>>16&255]+e.lut[r>>24&255]},e.initialize=function(){for(var t=0;t<256;t++)e.lut[t]=(t<16?"0":"")+t.toString(16)},e.lut=[],e}();t.UUID=l,l.initialize()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(){}return e.enableDataBindingSupport=!1,e.showDataStructureToolbox=!1,e.showSampleDataEditorToolbox=!1,e.showVersionPicker=!1,e}();t.GlobalSettings=r;var o=function(){function e(){}return e.v1_0=new i.Version(1,0),e.v1_1=new i.Version(1,1),e.v1_2=new i.Version(1,2),e.latest=e.v1_2,e.vNext=new i.Version(1e3,0,"vNext"),e}();t.Versions=o,t.SupportedTargetVersions=[o.v1_0,o.v1_1,o.v1_2,o.vNext],t.isVersionLessOrEqual=function(e,t){return!(e instanceof i.Version)||!(t instanceof i.Version)||t.compareTo(e)>=0}},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(14),s=n(6),l=n(23),c=n(26),u=n(8),p=function(){function e(){}return e.Unknown="Unknown",e.Containers="Containers",e.Elements="Elements",e.Inputs="Inputs",e.Actions="Actions",e}(),d=function(){function e(){this._items=[],this.defaultRegistration=new l.DesignerPeerRegistrationBase(p.Unknown,"acd-icon-unknownPeer"),this.reset()}return e.prototype.clear=function(){this._items=[]},e.prototype.findTypeRegistration=function(e){for(var t=0;t<this._items.length;t++)if(this._items[t].sourceType===e)return this._items[t];return null},e.prototype.registerPeer=function(e,t,n,i){void 0===i&&(i=null);var r=this.findTypeRegistration(e);null!=r?r.peerType=t:(r=new l.DesignerPeerRegistration(e,t,n,i),this._items.push(r))},e.prototype.unregisterPeer=function(e){for(var t=0;t<this._items.length;t++)if(this._items[t].sourceType===e)return void this._items.splice(t,1)},e}();t.DesignerPeerRegistry=d;var h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.reset=function(){this.clear(),this.registerPeer(o.AdaptiveCard,l.AdaptiveCardPeer,p.Containers,"acd-icon-adaptiveCard"),this.registerPeer(o.Container,l.ContainerPeer,p.Containers,"acd-icon-container"),this.registerPeer(o.ColumnSet,l.ColumnSetPeer,p.Containers,"acd-icon-columnSet"),this.registerPeer(o.Column,l.ColumnPeer,p.Containers,"acd-icon-column"),this.registerPeer(o.ImageSet,l.ImageSetPeer,p.Containers,"acd-icon-imageSet"),this.registerPeer(o.FactSet,l.FactSetPeer,p.Containers,"acd-icon-factSet"),this.registerPeer(o.TextBlock,l.TextBlockPeer,p.Elements,"acd-icon-textBlock"),this.registerPeer(o.RichTextBlock,l.RichTextBlockPeer,p.Elements,"acd-icon-richTextBlock"),this.registerPeer(o.Image,l.ImagePeer,p.Elements,"acd-icon-image"),this.registerPeer(o.Media,l.MediaPeer,p.Elements,"acd-icon-media"),this.registerPeer(o.ActionSet,l.ActionSetPeer,p.Elements,"acd-icon-actionSet"),this.registerPeer(o.TextInput,l.TextInputPeer,p.Inputs,"acd-icon-inputText"),this.registerPeer(o.DateInput,l.DateInputPeer,p.Inputs,"acd-icon-inputDate"),this.registerPeer(o.TimeInput,l.TimeInputPeer,p.Inputs,"acd-icon-inputTime"),this.registerPeer(o.ToggleInput,l.ToggleInputPeer,p.Inputs,"acd-icon-inputToggle"),this.registerPeer(o.NumberInput,l.NumberInputPeer,p.Inputs,"acd-icon-inputNumber"),this.registerPeer(o.ChoiceSetInput,l.ChoiceSetInputPeer,p.Inputs,"acd-icon-inputChoiceSet")},t.prototype.createPeerInstance=function(e,t,n){var i=this.findTypeRegistration(n.constructor);return i?new i.peerType(t,e,i,n):new l.CardElementPeer(t,e,this.defaultRegistration,n)},t}(d);t.CardElementPeerRegistry=h;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.reset=function(){this.clear(),this.registerPeer(o.HttpAction,l.HttpActionPeer,p.Actions,"acd-icon-actionHttp"),this.registerPeer(o.SubmitAction,l.SubmitActionPeer,p.Actions,"acd-icon-actionSubmit"),this.registerPeer(o.OpenUrlAction,l.OpenUrlActionPeer,p.Actions,"acd-icon-actionOpenUrl"),this.registerPeer(o.ShowCardAction,l.ShowCardActionPeer,p.Actions,"acd-icon-actionShowCard"),this.registerPeer(o.ToggleVisibilityAction,l.ToggleVisibilityActionPeer,p.Actions,"acd-icon-actionToggleVisibility")},t.prototype.createPeerInstance=function(e,t,n){var i=this.findTypeRegistration(n.constructor);return i?new i.peerType(t,e,i,n):new l.ActionPeer(t,e,this.defaultRegistration,n)},t}(d);t.ActionPeerRegistry=f;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=document.createElement("div");return e.classList.add("acd-peerButton","acd-icon-drag"),e.title="Drag to move this element",e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex="500",e},t}(s.DraggableElement),g=function(){function e(e){var t=this;this._updateCount=0,this._allPeers=[],this._lastParseErrors=[],this._isPreviewMode=!1,this.fixedHeightCard=!1,this.parentElement=e;var n=document.createElement("div");n.style.position="relative",n.style.width="100%",n.style.height="100%",this._cardHost=document.createElement("div"),this._cardHost.style.height="100%",n.appendChild(this._cardHost),this._designerSurface=document.createElement("div"),this._designerSurface.classList.add("acd-designersurface"),this._designerSurface.tabIndex=0,this._designerSurface.style.position="absolute",this._designerSurface.style.left="0",this._designerSurface.style.top="0",this._designerSurface.style.width="100%",this._designerSurface.style.height="100%",this._designerSurface.onkeyup=function(e){if(t._selectedPeer)switch(e.keyCode){case a.KEY_ESCAPE:t.setSelectedPeer(t._selectedPeer.parent);break;case a.KEY_DELETE:t.removeSelected()}return!e.cancelBubble},this._designerSurface.onpointermove=function(e){var n=t._designerSurface.getBoundingClientRect();t.tryDrop({x:e.x-n.left,y:e.y-n.top},t.draggedPeer)},this._designerSurface.onpointerup=function(e){t.draggedPeer&&t.endDrag()},n.appendChild(this._designerSurface),this.parentElement.innerHTML="",this.parentElement.appendChild(n)}return e.prototype.updatePeerCommandsLayout=function(){if(this._selectedPeer){var e=this._selectedPeer.getBoundingRect(),t=this._dragHandle.renderedElement.getBoundingClientRect(),n=this._removeCommandElement.getBoundingClientRect(),i=this._peerCommandsHostElement.getBoundingClientRect();this._dragHandle.renderedElement.style.left=e.left-t.width+"px",this._dragHandle.renderedElement.style.top=e.top-t.height+"px",this._removeCommandElement.style.left=e.right+"px",this._removeCommandElement.style.top=e.top-n.height+"px",this._peerCommandsHostElement.style.left=e.right-i.width+"px",this._peerCommandsHostElement.style.top=e.bottom+2+"px",this._dragHandle.renderedElement.style.visibility=this._selectedPeer.isDraggable()?"visible":"hidden",this._removeCommandElement.style.visibility=this._selectedPeer.canBeRemoved()?"visible":"hidden",this._peerCommandsHostElement.style.visibility=this._peerCommandsHostElement.childElementCount>0?"visible":"hidden"}else this._dragHandle.renderedElement.style.visibility="hidden",this._removeCommandElement.style.visibility="hidden",this._peerCommandsHostElement.style.visibility="hidden"},e.prototype.setSelectedPeer=function(e){if(this._selectedPeer!=e){if(this._selectedPeer&&(this._selectedPeer.isSelected=!1),this._selectedPeer=e,this._peerCommandsHostElement.innerHTML="",this._selectedPeer){this._selectedPeer.isSelected=!0;for(var t=0,n=this._selectedPeer.getCommands();t<n.length;t++){var i=n[t];this._peerCommandsHostElement.appendChild(i.render())}this._designerSurface.focus()}this.updatePeerCommandsLayout(),this.onSelectedPeerChanged&&this.onSelectedPeerChanged(this._selectedPeer)}},e.prototype.peerChanged=function(e,t){this._lastParseErrors=[],this.renderCard(),this.updateLayout(),t&&this.onSelectedPeerChanged&&this.onSelectedPeerChanged(this._selectedPeer)},e.prototype.peerRemoved=function(e){this._allPeers.splice(this._allPeers.indexOf(e),1),e==this._selectedPeer&&this.setSelectedPeer(null),0==this._updateCount&&(this.renderCard(),this.updateLayout())},e.prototype.renderCard=function(){if(this._cardHost.innerHTML="",this.card){this.onCardValidated&&this.onCardValidated(this._lastParseErrors,this.card.validateProperties());var e=void 0;if(this.isPreviewMode){if(u.GlobalSettings.enableDataBindingSupport){var t=this.card.toJSON();try{var n=new c.Template(t),i=new c.EvaluationContext;i.$root=this.sampleData;var r=n.expand(i);(e=new o.AdaptiveCard).hostConfig=this.card.hostConfig,e.parse(r)}catch(e){console.log("Template expansion error: "+e.message)}}e||((e=this.card).designMode=!1)}else(e=this.card).designMode=!0;var a=e.render();this.fixedHeightCard&&(a.style.height="100%"),this._cardHost.appendChild(a)}},e.prototype.addPeer=function(e){var t=this;if(this._allPeers.indexOf(e)<0){this._allPeers.push(e),e.render(),e.onSelectedChanged=function(e){e.isSelected?t.setSelectedPeer(e):t._selectedPeer==e&&t.setSelectedPeer(null)},e.onChanged=function(e,n){t.peerChanged(e,n)},e.onPeerRemoved=function(e){t.peerRemoved(e)},e.onPeerAdded=function(e,n){t.addPeer(n),t.updateLayout()},e.onStartDrag=function(e){t.startDrag(e)},e.onEndDrag=function(e){t.endDrag()},e.addElementsToDesignerSurface(this._designerSurface);for(var n=0;n<e.getChildCount();n++)this.addPeer(e.getChildAt(n))}},e.prototype.internalFindDropTarget=function(e,t,n){if(t==n)return null;var i=null,r=t instanceof l.ActionPeer;r||(r=t.getBoundingRect().isInside(e));if(r){t.canDrop(n)&&(i=t);for(var o=0;o<t.getChildCount();o++){var a=this.internalFindDropTarget(e,t.getChildAt(o),n);if(a){i=a;break}}}return i},e.prototype.findCardElementPeer=function(e){for(var t=0;t<this._allPeers.length;t++){var n=this._allPeers[t];if(n instanceof l.CardElementPeer&&n.cardElement==e)return n}return null},e.prototype.findActionPeer=function(e){for(var t=0;t<this._allPeers.length;t++){var n=this._allPeers[t];if(n instanceof l.ActionPeer&&n.action==e)return n}return null},e.prototype.inlineCardExpanded=function(t,n){var i=this.findCardElementPeer(t.card);if(n)if(i)i.addElementsToDesignerSurface(this._designerSurface,!0);else{var r=e.cardElementPeerRegistry.findTypeRegistration(o.AdaptiveCard);i=new r.peerType(i,this,r,t.card);var a=this.findActionPeer(t);a?a.insertChild(i):this._rootPeer.insertChild(i)}else i&&i.removeElementsFromDesignerSurface(!0);this.updateLayout()},Object.defineProperty(e.prototype,"draggedPeer",{get:function(){return this._draggedPeer},set:function(e){this._draggedPeer!=e&&(this._draggedPeer&&(this._draggedPeer.dragging=!1),this._draggedPeer=e,this._draggedPeer&&(this._draggedPeer.dragging=!0))},enumerable:!0,configurable:!0}),e.prototype.getDesignerSurfaceOffset=function(){var e=this._designerSurface.getBoundingClientRect();return{x:e.left,y:e.top}},e.prototype.findDropTarget=function(e,t){return this.internalFindDropTarget(e,this._rootPeer,t)},e.prototype.findPeer=function(e){for(var t=0,n=this._allPeers;t<n.length;t++){var i=n[t];if(i.getCardObject()===e)return i}},e.prototype.beginUpdate=function(){this._updateCount++},e.prototype.endUpdate=function(e){this._updateCount>0&&(this._updateCount--,0==this._updateCount&&(e&&this.renderCard(),this.updateLayout()))},e.prototype.render=function(){var t=this;this._designerSurface.innerHTML="",this._allPeers=[],this.setSelectedPeer(null),this.renderCard(),this.card&&(this._rootPeer=e.cardElementPeerRegistry.createPeerInstance(this,null,this.card),this.addPeer(this._rootPeer)),this._removeCommandElement=document.createElement("div"),this._removeCommandElement.classList.add("acd-peerButton","acd-icon-remove"),this._removeCommandElement.title="Remove",this._removeCommandElement.style.visibility="hidden",this._removeCommandElement.style.position="absolute",this._removeCommandElement.style.zIndex="500",this._removeCommandElement.onclick=function(e){t.removeSelected()},this._dragHandle=new m,this._dragHandle.onStartDrag=function(e){t._dragHandle.endDrag(),t.startDrag(t._selectedPeer)},this._dragHandle.render(),this._peerCommandsHostElement=document.createElement("div"),this._peerCommandsHostElement.style.visibility="hidden",this._peerCommandsHostElement.style.position="absolute",this._peerCommandsHostElement.style.display="flex",this._peerCommandsHostElement.style.zIndex="500",this._designerSurface.appendChild(this._dragHandle.renderedElement),this._designerSurface.appendChild(this._removeCommandElement),this._designerSurface.appendChild(this._peerCommandsHostElement),this.updateLayout()},e.prototype.setCardPayloadAsObject=function(e){this._lastParseErrors=[],this.card.parse(e,this._lastParseErrors),this.render()},e.prototype.setCardPayloadAsString=function(e){this.setCardPayloadAsObject(JSON.parse(e))},e.prototype.updateLayout=function(e){void 0===e&&(e=!0);for(var t=0;t<this._allPeers.length;t++)this._allPeers[t].updateLayout();this.updatePeerCommandsLayout(),this.onLayoutUpdated&&this.onLayoutUpdated(e)},e.prototype.removeSelected=function(){if(this.selectedPeer){this.beginUpdate();try{var e=this.selectedPeer.parent;this.selectedPeer.remove(!1,!0)&&this.setSelectedPeer(e)}finally{this.endUpdate(!0)}}},e.prototype.startDrag=function(e){this.draggedPeer||(this._designerSurface.classList.add("dragging"),this.draggedPeer=e,this.setSelectedPeer(this.draggedPeer))},e.prototype.endDrag=function(){this.draggedPeer&&(this.draggedPeer.removeElementsFromDesignerSurface(!0),this.draggedPeer.addElementsToDesignerSurface(this._designerSurface,!0),this._dropTarget.renderedElement.classList.remove("dragover"),this.draggedPeer=null,this._designerSurface.classList.remove("dragging"))},e.prototype.tryDrop=function(e,t){var n=!1;if(t){this._dropTarget&&this._dropTarget.renderedElement.classList.remove("dragover");var i=this.findDropTarget(e,t);i&&(this._dropTarget=i,this._dropTarget.renderedElement.classList.add("dragover"),n=this._dropTarget.tryDrop(t,e))}return n},e.prototype.isPointerOver=function(e,t){var n=this._designerSurface.getBoundingClientRect();return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom},e.prototype.pageToClientCoordinates=function(e,t){var n=this._designerSurface.getBoundingClientRect();return{x:e-n.left,y:t-n.top}},Object.defineProperty(e.prototype,"rootPeer",{get:function(){return this._rootPeer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedPeer",{get:function(){return this._selectedPeer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"card",{get:function(){return this._card},set:function(e){var t=this;e!=this._card&&(this._card&&(this._card.onInlineCardExpanded=null),this._card=e,this._card&&(this._card.onInlineCardExpanded=function(e,n){t.inlineCardExpanded(e,n)}),this.render())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPreviewMode",{get:function(){return this._isPreviewMode},set:function(e){this._isPreviewMode!=e&&(this._isPreviewMode=e,this._isPreviewMode?(this._designerSurface.classList.add("acd-hidden"),this._dragHandle.renderedElement.classList.add("acd-hidden"),this._removeCommandElement.classList.add("acd-hidden"),this._peerCommandsHostElement.classList.add("acd-hidden")):(this._designerSurface.classList.remove("acd-hidden"),this._dragHandle.renderedElement.classList.remove("acd-hidden"),this._removeCommandElement.classList.remove("acd-hidden"),this._peerCommandsHostElement.classList.remove("acd-hidden")),this.renderCard())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampleData",{get:function(){return this._sampleData},set:function(e){this._sampleData=e,this.isPreviewMode&&this.renderCard()},enumerable:!0,configurable:!0}),e.cardElementPeerRegistry=new h,e.actionPeerRegistry=new f,e}();t.CardDesignerSurface=g},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(5),s=n(3),l=function(){function e(){}return e.prototype.close=function(){this.onClose&&this.onClose(this)},e.prototype.keyDown=function(e){switch(e.keyCode){case o.KEY_ESCAPE:this.close()}},e.prototype.render=function(e){var t=this;return this._popupElement=document.createElement("div"),this._popupElement.tabIndex=0,this._popupElement.className="ms-ctrl ms-ctrl-popup-container",this._popupElement.onkeydown=function(e){return t.keyDown(e),!e.cancelBubble},this._popupElement.appendChild(this.renderContent()),this._popupElement},e.prototype.focus=function(){this._popupElement&&this._popupElement.firstElementChild.focus()},e}();t.PopupControl=l;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.keyDown=function(e){switch(e.keyCode){case o.KEY_ENTER:this.popup()}},t.prototype.updateLabel=function(){this._labelElement&&(this._value?(this._labelElement.innerHTML=this.getValueAsString(),this._labelElement.classList.remove("placeholder")):(this._labelElement.innerText=this._placeholderText?this._placeholderText:"",this._labelElement.classList.add("placeholder")))},Object.defineProperty(t.prototype,"popupControl",{get:function(){return this._popupControl},enumerable:!0,configurable:!0}),t.prototype.getButtonIconCssClassName=function(){return"ms-icon-chevronDown"},t.prototype.getValueAsString=function(){return this._value.toString()},t.prototype.valueChanged=function(){this.onValueChanged&&this.onValueChanged(this)},t.prototype.attach=function(t){var n=this;e.prototype.attach.call(this,t),t.tabIndex=0,t.className=this.getCssClassName(),window.addEventListener("resize",function(e){n.closePopup()}),this.rootElement.onclick=function(e){n._isOpen?n.closePopup():n.popup()};var i=this.rootElement.attributes.getNamedItem("placeholder");i&&(this._placeholderText=i.value),this._labelElement=document.createElement("span"),this._labelElement.className="ms-ctrl ms-dropdown-label",this._dropDownButtonElement=document.createElement("i"),this._dropDownButtonElement.className="ms-icon ms-ctrl-dropdown-button "+this.getButtonIconCssClassName(),this.rootElement.appendChild(this._labelElement),this.rootElement.appendChild(this._dropDownButtonElement),this.updateLabel()},t.prototype.popup=function(){var e=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className="ms-ctrl-overlay",this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(t){e.closePopup()},document.body.appendChild(this._overlayElement),this._popupControl=this.createPopupControl(),this._popupControl.onClose=function(t){e.closePopup(),e.rootElement.focus()};var t=this.rootElement.getBoundingClientRect();this._popupControlElement=this._popupControl.render(t),this._popupControlElement.classList.remove("ms-ctrl-slide","ms-ctrl-slideLeftToRight","ms-ctrl-slideRightToLeft","ms-ctrl-slideTopToBottom","ms-ctrl-slideRightToLeft"),this._overlayElement.appendChild(this._popupControlElement);var n,i=this._popupControlElement.getBoundingClientRect(),r=window.innerHeight-t.bottom,o=t.top,s=t.left+a.getScrollX();if(o<i.height&&r<i.height){var l=Math.min(i.height,window.innerHeight);this._popupControlElement.style.maxHeight=l+"px",n=l<i.height?a.getScrollY():a.getScrollY()+t.top+(t.height-l)/2;var c=window.innerWidth-t.right;if(t.left<i.width&&c<i.width){var u=Math.min(i.width,window.innerWidth);this._popupControlElement.style.maxWidth=u+"px",s=u<i.width?a.getScrollX():a.getScrollX()+t.left+(t.width-u)/2}else c>=i.width?(s=a.getScrollX()+t.right,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideLeftToRight")):(s=a.getScrollX()+t.left-i.width,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideRightToLeft"))}else r>=i.height?(n=a.getScrollY()+t.bottom,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideTopToBottom")):(n=a.getScrollY()+t.top-i.height,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideBottomToTop"));this._popupControlElement.style.left=s+"px",this._popupControlElement.style.top=n+"px",this._popupControlElement.focus(),this._isOpen=!0}},t.prototype.closePopup=function(){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1)},Object.defineProperty(t.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholderText",{get:function(){return this._placeholderText},set:function(e){this._placeholderText=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(e){this._value!=e&&(this._value=e,this.updateLabel(),this.valueChanged())},enumerable:!0,configurable:!0}),t}(s.InputControl);t.InputWithPopup=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this.top=e,this.right=t,this.bottom=n,this.left=i}return e.prototype.union=function(e){this.top=Math.min(this.top,e.top),this.left=Math.min(this.left,e.left),this.bottom=Math.max(this.bottom,e.bottom),this.right=Math.max(this.right,e.right)},e.prototype.isInside=function(e){return e.x>=this.left&&e.x<=this.right&&e.y>=this.top&&e.y<=this.bottom},Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),e}();t.Rect=r;var o=function(){function e(){}return e.isAbsoluteUrl=function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")},e.joinPaths=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.map(function(e,t){return e||(e=""),0===t?e.trim().replace(/[\/]*$/g,""):e.trim().replace(/(^[\/]*|[\/]*$)/g,"")}).filter(function(e){return e.length}).join("/")},e}();t.Utils=o,t.defaultHostConfig=new i.HostConfig({preExpandSingleShowCardAction:!0,supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},textAlign:{right:"right"},imageSizes:{small:40,medium:80,large:160},fontStyles:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},containerStyles:{default:{backgroundColor:"#f9f9f9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:i.Spacing.Default,buttonSpacing:10,showCard:{actionMode:i.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:i.Orientation.Horizontal,actionAlignment:i.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!0},imageSet:{imageSize:i.Size.Medium,maxImageHeight:100},factSet:{title:{color:i.TextColor.Default,size:i.TextSize.Default,isSubtle:!1,weight:i.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:i.TextColor.Default,size:i.TextSize.Default,isSubtle:!1,weight:i.TextWeight.Default,wrap:!0},spacing:10}}),t.defaultHostConfig.cssClassNamePrefix="default"},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.renderTo=function(e){e.classList.add("card-frame"),e.appendChild(this.cardHost)},t}(n(1).HostContainer);t.DefaultContainer=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r=n(7);function o(e){return null==e||""===e}function a(e,t,n){if(o(t))return n;for(var i in e){if(parseInt(i,10)>=0){var r=e[i];if(r&&"string"==typeof r&&r.toLowerCase()===t.toLowerCase())return parseInt(i,10)}}return n}function s(e,t,n,i){void 0===i&&(i=void 0),null==n||n===i?delete e[t]:e[t]=n}function l(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){var n=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+n+")"}return e}function c(e,t){for(t+=1;t<e.length&&"<"==e[t];)for(;t<e.length&&">"!=e[t++];);return t}t.generateUniqueId=function(){return"__ac-"+r.UUID.generate()},t.isNullOrEmpty=o,t.appendChild=function(e,t){null!=t&&null!=t&&e.appendChild(t)},t.getStringValue=function(e,t){return void 0===t&&(t=void 0),"string"==typeof e?e.toString():t},t.getNumberValue=function(e,t){return void 0===t&&(t=void 0),"number"==typeof e?e:t},t.getBoolValue=function(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t},t.getEnumValue=a,t.setProperty=s,t.setNumberProperty=function(e,t,n,i){void 0===i&&(i=void 0),null==n||n===i||isNaN(n)?delete e[t]:e[t]=n},t.setEnumProperty=function(e,t,n,i,r){void 0===r&&(r=void 0);var o=t[n],a=null==o||void 0!==e[o];i==r?a&&delete t[n]:null==i?a&&delete t[n]:t[n]=e[i]},t.setArrayProperty=function(e,t,n){var i=[];if(n)for(var r=0,o=n;r<o.length;r++){var a=o[r];i.push(a.toJSON())}0==i.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:s(e,t,i)},t.parseHostConfigEnum=function(e,t,n){return"string"==typeof t?a(e,t,n):"number"==typeof t?t:n},t.renderSeparation=function(e,t,n){if(t.spacing>0||t.lineThickness>0){var r=document.createElement("div");return r.className=e.makeCssClassName("ac-"+(n==i.Orientation.Horizontal?"horizontal":"vertical")+"-separator"),n==i.Orientation.Horizontal?t.lineThickness?(r.style.paddingTop=t.spacing/2+"px",r.style.marginBottom=t.spacing/2+"px",r.style.borderBottom=t.lineThickness+"px solid "+l(t.lineColor)):r.style.height=t.spacing+"px":t.lineThickness?(r.style.paddingLeft=t.spacing/2+"px",r.style.marginRight=t.spacing/2+"px",r.style.borderRight=t.lineThickness+"px solid "+l(t.lineColor)):r.style.width=t.spacing+"px",r.style.overflow="hidden",r}return null},t.stringToCssColor=l,t.truncate=function(e,t,n){var i=function(){return t-e.scrollHeight>=-1};if(!i()){for(var r=e.innerHTML,o=function(t){e.innerHTML=r.substring(0,t)+"..."},a=function(e){for(var t=[],n=c(e,-1);n<e.length;)" "==e[n]&&t.push(n),n=c(e,n);return t}(r),s=0,l=a.length,u=0;s<l;){var p=Math.floor((s+l)/2);o(a[p]),i()?(u=a[p],s=p+1):l=p}if(o(u),n&&t-e.scrollHeight>=n-1){for(var d=c(r,u);d<r.length&&(o(d),i());)u=d,d=c(r,d);o(u)}}},t.getFitStatus=function(e,t){var n=e.offsetTop;return n+e.clientHeight<=t?i.ContainerFitStatus.FullyInContainer:n<t?i.ContainerFitStatus.Overflowing:i.ContainerFitStatus.FullyOutOfContainer}},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(2)),i(n(21)),i(n(5)),i(n(15)),i(n(3)),i(n(10)),i(n(22)),i(n(41)),i(n(42)),i(n(43)),i(n(44)),i(n(45)),i(n(46))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._items=[],this.onItemAdded=null,this.onItemRemoved=null}return e.prototype.get=function(e){return this._items[e]},e.prototype.add=function(e){this._items.push(e),this.onItemAdded&&this.onItemAdded(e)},e.prototype.remove=function(e){var t=this._items.indexOf(e);t>=0&&(this._items=this._items.splice(t,1),this.onItemRemoved&&this.onItemRemoved(e))},e.prototype.indexOf=function(e){return this._items.indexOf(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),e}();t.Collection=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){var t=e.call(this)||this;return t._isExpanded=!0,t._isSelected=!1,t._level=0,t}return r(t,e),t.prototype.click=function(t){e.prototype.click.call(this,t),this.selected()},t.prototype.getIconClass=function(){return null},t.prototype.getAdditionalText=function(){return null},t.prototype.getAdditionalTextClass=function(){return"acd-tree-item-additionalText"},t.prototype.getIndentationLevelIncrement=function(){return 8},t.prototype.getDragSourceElement=function(){return this._treeItemElement},t.prototype.selected=function(){},t.prototype.internalRender=function(){var e=this,t=document.createElement("div");this._treeItemElement=document.createElement("div"),this._treeItemElement.classList.add("acd-tree-item"),this._treeItemElement.style.display="flex",this._treeItemElement.style.alignItems="center",this._treeItemElement.style.paddingLeft=this.getIndentationLevelIncrement()*(1+this.level)+"px",this._expandCollapseElement=document.createElement("div"),this._expandCollapseElement.classList.add("acd-tree-item-expandCollapseButton"),this._expandCollapseElement.style.flex="0 0 auto",this._expandCollapseElement.style.visibility=this.getChildCount()>0?"visible":"hidden",this._expandCollapseElement.onclick=function(t){e._isExpanded=!e._isExpanded,e.updateLayout(),t.cancelBubble=!0,t.preventDefault()},this._treeItemElement.appendChild(this._expandCollapseElement);var n=document.createElement("div");if(n.classList.add("acd-tree-item-text"),n.style.flex="1 1 auto",n.style.display="flex",n.style.alignItems="center",n.style.whiteSpace="nowrap",n.style.textOverflow="ellipsis",n.style.overflow="hidden",this.getIconClass()){var i=document.createElement("div");i.classList.add("acd-icon","acd-treeView-icon",this.getIconClass()),n.appendChild(i)}var r=document.createElement("span");r.classList.add("acd-tree-item-typeName"),r.innerText=this.getLabelText(),n.appendChild(r);var o=this.getAdditionalText();if(o&&""!=o){var a=document.createElement("span");a.classList.add(this.getAdditionalTextClass()),a.innerText=" ["+o+"]",n.appendChild(a)}this._treeItemElement.appendChild(n),t.appendChild(this._treeItemElement),this._childContainerElement=document.createElement("div");for(var s=0;s<this.getChildCount();s++){var l=this.getChildAt(s).render();this._childContainerElement.appendChild(l)}return t.appendChild(this._childContainerElement),this.updateLayout(),t},t.prototype.updateLayout=function(){this._isExpanded?(this._childContainerElement.classList.remove("acd-hidden"),this._expandCollapseElement.classList.remove(t.collapsedIconClass),this._expandCollapseElement.classList.add(t.expandedIconClass)):(this._childContainerElement.classList.add("acd-hidden"),this._expandCollapseElement.classList.add(t.collapsedIconClass),this._expandCollapseElement.classList.remove(t.expandedIconClass))},t.prototype.expand=function(){this._isExpanded=!0,this.updateLayout()},t.prototype.isDraggable=function(){return!1},Object.defineProperty(t.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._isSelected},set:function(e){this._isSelected=e,this._isSelected?this._treeItemElement.classList.add("selected"):this._treeItemElement.classList.remove("selected")},enumerable:!0,configurable:!0}),t.collapsedIconClass="acd-icon-chevronRight",t.expandedIconClass="acd-icon-chevronDown",t}(n(6).DraggableElement);t.BaseTreeItem=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(18);!function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(i=t.ToolboxOrientation||(t.ToolboxOrientation={}));var o=function(){function e(e,t){this._isExpanded=!0,this._stretch=!1,this._isRestoring=!1,this.commands=null,this.id=e,this.title=t}return e.prototype.getDimensionSettingName=function(){return"Toolbox"+this.id+(this._orientation==i.Vertical?"Height":"Width")},e.prototype.updateContent=function(){this._contentHost&&(this._contentHost.innerHTML="",this._content&&this._contentHost.appendChild(this._content))},e.prototype.toggled=function(){this.onToggled&&this.onToggled(this)},e.prototype.render=function(e,t){var n=this;this._orientation=e,this._collapsedTabContainer=t,this._renderedElement=document.createElement("div"),this._renderedElement.style.overflow="auto",this._renderedElement.style.display="flex",this._renderedElement.style.flexDirection="column",this._headerRootElement=document.createElement("div"),this._headerRootElement.innerHTML="",this._headerRootElement.className="acd-toolbox-header";var i=document.createElement("div");i.className="acd-toolbox-header-content";var r=document.createElement("span");r.className="acd-toolbox-header-title",r.innerText=this.title,i.appendChild(r);var o=document.createElement("span");if(o.className="acd-toolbox-header-commandsHost",this._customCommandsHost=document.createElement("div"),this._customCommandsHost.style.display="flex",this.commands)for(var a=function(e){var t=document.createElement("div");t.className="acd-toolbox-header-commandButton",t.title=e.title,t.onclick=function(t){e.execute(e)};var n=document.createElement("div");n.classList.add("acd-icon",e.iconClass),t.appendChild(n),s._customCommandsHost.appendChild(t)},s=this,l=0,c=this.commands;l<c.length;l++){a(c[l])}o.appendChild(this._customCommandsHost),this._expandCollapseButtonElement=document.createElement("span"),this._expandCollapseButtonElement.className="acd-toolbox-header-commandButton",this._expandCollapseButtonElement.title="Hide",this._headerIconElement=document.createElement("span"),this._headerIconElement.classList.add("acd-icon","acd-icon-header-expanded"),this._expandCollapseButtonElement.appendChild(this._headerIconElement),this._expandCollapseButtonElement.onmousedown=function(e){return e.preventDefault(),!0},this._expandCollapseButtonElement.onclick=function(e){return n.toggle(),e.preventDefault(),!0},o.appendChild(this._expandCollapseButtonElement),i.appendChild(o),this._headerRootElement.appendChild(i),this._contentHost=document.createElement("div"),this._contentHost.style.overflow="auto",this._renderedElement.append(this._headerRootElement,this._contentHost),this.updateContent()},e.prototype.collapse=function(){this._isExpanded&&(this._headerIconElement.classList.add("acd-icon-header-collapsed"),this._headerIconElement.classList.remove("acd-icon-header-expanded"),this._customCommandsHost.classList.add("acd-hidden"),this._collapsedTabContainer&&(this._renderedElement.removeChild(this._headerRootElement),this._collapsedTabContainer.appendChild(this._headerRootElement)),this._expandCollapseButtonElement.title="Show",this._isExpanded=!1,this.toggled())},e.prototype.expand=function(){this._isExpanded||(this._headerIconElement.classList.add("acd-icon-header-expanded"),this._headerIconElement.classList.remove("acd-icon-header-collapsed"),this._customCommandsHost.classList.remove("acd-hidden"),this._collapsedTabContainer&&(this._collapsedTabContainer.removeChild(this._headerRootElement),this._renderedElement.insertBefore(this._headerRootElement,this._renderedElement.firstChild)),this._expandCollapseButtonElement.title="Hide",this._isExpanded=!0,this.toggled())},e.prototype.toggle=function(){this.isExpanded?this.collapse():this.expand()},e.prototype.getHeaderBoundingRect=function(){return this._headerRootElement.getBoundingClientRect()},e.prototype.saveState=function(){this._isRestoring||(r.SettingsManager.trySaveSetting("Toolbox"+this.id+"IsExpanded",this.isExpanded.toString()),r.SettingsManager.trySaveSetting(this.getDimensionSettingName(),this.orientation==i.Vertical?this.renderedElement.style.height:this.renderedElement.style.width))},e.prototype.restoreState=function(){if(this.renderedElement&&!this._isRestoring){this._isRestoring=!0;try{var e=r.SettingsManager.tryLoadStringSetting(this.getDimensionSettingName());e.succeeded&&null!=e.value&&""!=e.value&&(this.orientation==i.Vertical?this.renderedElement.style.height=e.value:this.renderedElement.style.width=e.value);var t=r.SettingsManager.tryLoadBooleanSetting("Toolbox"+this.id+"IsExpanded",!0);t.succeeded&&(t.value?this.expand():this.collapse())}finally{this._isRestoring=!1}}},Object.defineProperty(e.prototype,"orientation",{get:function(){return this._orientation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},set:function(e){this._content=e,this.updateContent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isExpanded",{get:function(){return this._isExpanded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stretch",{get:function(){return this._stretch},set:function(e){this._stretch=e,this._stretch?this.renderedElement.style.flex="1 1 auto":this.renderedElement.style.flex="0 0 auto"},enumerable:!0,configurable:!0}),e}();t.Toolbox=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.determineIfStorageIsAvailable=function(e){try{var t=window[e],n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&0!==t.length}},e.trySaveSetting=function(t,n){e.isLocalStorageAvailable&&localStorage.setItem(t,n)},e.tryLoadStringSetting=function(t){return e.isLocalStorageAvailable?{succeeded:!0,value:localStorage.getItem(t)}:{succeeded:!1}},e.tryLoadNumberSetting=function(t){if(e.isLocalStorageAvailable){var n=localStorage.getItem(t);return{succeeded:!0,value:n?parseFloat(n):void 0}}return{succeeded:!1}},e.tryLoadBooleanSetting=function(t,n){if(e.isLocalStorageAvailable){var i=localStorage.getItem(t);return{succeeded:!0,value:i?"true"==i:n}}return{succeeded:!1}},Object.defineProperty(e,"isLocalStorageAvailable",{get:function(){return e._isLocalStorageAvailable||(e._isLocalStorageAvailable=e.determineIfStorageIsAvailable("localStorage")),e._isLocalStorageAvailable},enumerable:!0,configurable:!0}),e._isLocalStorageAvailable=void 0,e}();t.SettingsManager=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),a=n(13),s=n(7),l=function(){function e(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}return e.prototype.parse=function(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)},e}();t.ColorDefinition=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.highlightColors=new l("#22000000","#11000000"),t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),t&&this.highlightColors.parse(t.highlightColors)},t}(l);t.TextColorDefinition=c;var u=function(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)};t.AdaptiveCardConfig=u;var p=function(){function e(e){this.imageSize=o.Size.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=a.getNumberValue(e.maxImageHeight,100))}return e.prototype.toJSON=function(){return{imageSize:o.Size[this.imageSize],maxImageHeight:this.maxImageHeight}},e}();t.ImageSetConfig=p;var d=function(){function e(e){this.allowInlinePlayback=!0,e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}return e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}},e}();t.MediaConfig=d;var h=function(){function e(e){this.size=o.TextSize.Default,this.color=o.TextColor.Default,this.isSubtle=!1,this.weight=o.TextWeight.Default,this.wrap=!0,e&&(this.size=a.parseHostConfigEnum(o.TextSize,e.size,o.TextSize.Default),this.color=a.parseHostConfigEnum(o.TextColor,e.color,o.TextColor.Default),this.isSubtle=e.isSubtle||this.isSubtle,this.weight=a.parseHostConfigEnum(o.TextWeight,e.weight,this.getDefaultWeight()),this.wrap=null!=e.wrap?e.wrap:this.wrap)}return e.prototype.getDefaultWeight=function(){return o.TextWeight.Default},e.prototype.toJSON=function(){return{size:o.TextSize[this.size],color:o.TextColor[this.color],isSubtle:this.isSubtle,weight:o.TextWeight[this.weight],wrap:this.wrap}},e}();t.FactTextDefinition=h;var f=function(e){function t(t){var n=e.call(this,t)||this;return n.maxWidth=150,n.weight=o.TextWeight.Bolder,t&&(n.maxWidth=null!=t.maxWidth?t.maxWidth:n.maxWidth,n.weight=a.parseHostConfigEnum(o.TextWeight,t.weight,o.TextWeight.Bolder)),n}return r(t,e),t.prototype.getDefaultWeight=function(){return o.TextWeight.Bolder},t}(h);t.FactTitleDefinition=f;var m=function(e){this.title=new f,this.value=new h,this.spacing=10,e&&(this.title=new f(e.title),this.value=new h(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)};t.FactSetConfig=m;var g=function(){function e(e){this.actionMode=o.ShowCardActionMode.Inline,this.inlineTopMargin=16,this.style=o.ContainerStyle.Emphasis,e&&(this.actionMode=a.parseHostConfigEnum(o.ShowCardActionMode,e.actionMode,o.ShowCardActionMode.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:o.ContainerStyle.Emphasis)}return e.prototype.toJSON=function(){return{actionMode:o.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}},e}();t.ShowCardActionConfig=g;var y=function(){function e(e){if(this.maxActions=5,this.spacing=o.Spacing.Default,this.buttonSpacing=20,this.showCard=new g,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=o.Orientation.Horizontal,this.actionAlignment=o.ActionAlignment.Left,this.iconPlacement=o.ActionIconPlacement.LeftOfTitle,this.allowTitleToWrap=!1,this.iconSize=24,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=a.parseHostConfigEnum(o.Spacing,e.spacing&&e.spacing,o.Spacing.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new g(e.showCard),this.preExpandSingleShowCardAction=a.getBoolValue(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=a.parseHostConfigEnum(o.Orientation,e.actionsOrientation,o.Orientation.Horizontal),this.actionAlignment=a.parseHostConfigEnum(o.ActionAlignment,e.actionAlignment,o.ActionAlignment.Left),this.iconPlacement=a.parseHostConfigEnum(o.ActionIconPlacement,e.iconPlacement,o.ActionIconPlacement.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap;try{var t=s.SizeAndUnit.parse(e.iconSize);t.unit==o.SizeUnit.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}return e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:o.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:o.Orientation[this.actionsOrientation],actionAlignment:o.ActionAlignment[this.actionAlignment]}},e}();t.ActionsConfig=y;var v=function(){function e(e){this.default=new c,this.dark=new c,this.light=new c,this.accent=new c,this.good=new c,this.warning=new c,this.attention=new c,this.parse(e)}return e.prototype.parseSingleColor=function(e,t){e&&this[t].parse(e[t])},e.prototype.parse=function(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))},e}();t.ColorSetDefinition=v;var b=function(){function e(e){this.foregroundColors=new v({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#54A254",subtle:"#DD54A254"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}return e.prototype.parse=function(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor)},Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return!1},enumerable:!0,configurable:!0}),e}();t.ContainerStyleDefinition=b;var _=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(b),C=function(){function e(e){if(this._allStyles={},this._allStyles[o.ContainerStyle.Default]=new _,this._allStyles[o.ContainerStyle.Emphasis]=new _,this._allStyles[o.ContainerStyle.Accent]=new _,this._allStyles[o.ContainerStyle.Good]=new _,this._allStyles[o.ContainerStyle.Attention]=new _,this._allStyles[o.ContainerStyle.Warning]=new _,e){this._allStyles[o.ContainerStyle.Default].parse(e[o.ContainerStyle.Default]),this._allStyles[o.ContainerStyle.Emphasis].parse(e[o.ContainerStyle.Emphasis]),this._allStyles[o.ContainerStyle.Accent].parse(e[o.ContainerStyle.Accent]),this._allStyles[o.ContainerStyle.Good].parse(e[o.ContainerStyle.Good]),this._allStyles[o.ContainerStyle.Attention].parse(e[o.ContainerStyle.Attention]),this._allStyles[o.ContainerStyle.Warning].parse(e[o.ContainerStyle.Warning]);var t=e.customStyles;if(t&&Array.isArray(t))for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r){var a=r.name;a&&"string"==typeof a&&(this._allStyles.hasOwnProperty(a)?this._allStyles[a].parse(r.style):this._allStyles[a]=new b(r.style))}}}}return e.prototype.toJSON=function(){var e=this,t=[];Object.keys(this._allStyles).forEach(function(n){e._allStyles[n].isBuiltIn||t.push({name:n,style:e._allStyles[n]})});var n={default:this.default,emphasis:this.emphasis};return t.length>0&&(n.customStyles=t),n},e.prototype.getStyleByName=function(e,t){return void 0===t&&(t=null),this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t},Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[o.ContainerStyle.Default]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[o.ContainerStyle.Emphasis]},enumerable:!0,configurable:!0}),e}();t.ContainerStyleSet=C;var E=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=1),this._isValid=!0,this._major=e,this._minor=t,this._label=n}return e.parse=function(t,n){if(!t)return null;var i=new e;i._versionString=t;var r=/(\d+).(\d+)/gi.exec(t);return null!=r&&3==r.length?(i._major=parseInt(r[1]),i._minor=parseInt(r[2])):i._isValid=!1,!i._isValid&&n&&n.push({error:o.ValidationError.InvalidPropertyValue,message:"Invalid version string: "+i._versionString}),i},e.prototype.toString=function(){return this._isValid?this._major+"."+this._minor:this._versionString},e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0},Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:!0,configurable:!0}),e}();t.Version=E;var S=function(){function e(){this.capabilities=null}return e.prototype.setCapability=function(e,t){this.capabilities||(this.capabilities={}),this.capabilities[e]=t},e.prototype.parse=function(e,t){if(e)for(var n in e){var i=e[n];if("string"==typeof i)if("*"==i)this.setCapability(n,"*");else{var r=E.parse(i,t);r.isValid&&this.setCapability(n,r)}}},e.prototype.hasCapability=function(e,t){return!(!this.capabilities||!this.capabilities.hasOwnProperty(e))&&("*"==t||"*"==this.capabilities[e]||t.compareTo(this.capabilities[e])<=0)},e.prototype.areAllMet=function(e){if(this.capabilities)for(var t in this.capabilities)if(!e.hasCapability(t,this.capabilities[t]))return!1;return!0},e}();t.HostCapabilities=S;var x=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}return e.prototype.parse=function(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}},e.monospace=new e("'Courier New', Courier, monospace"),e}();t.FontTypeDefinition=x;var P=function(){function e(e){this.default=new x,this.monospace=new x("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}return e.prototype.getStyleDefinition=function(e){switch(e){case o.FontType.Monospace:return this.monospace;case o.FontType.Default:default:return this.default}},e}();t.FontTypeSet=P;var w=function(){function e(e){this.hostCapabilities=new S,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.fontTypes=null,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new C,this.actions=new y,this.adaptiveCard=new u,this.imageSet=new p,this.media=new d,this.factSet=new m,this.cssClassNamePrefix=null,this.alwaysAllowBleed=!1,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new x,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new P(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new C(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.actions=new y(e.actions||this.actions),this.adaptiveCard=new u(e.adaptiveCard||this.adaptiveCard),this.imageSet=new p(e.imageSet),this.factSet=new m(e.factSet))}return e.prototype.getFontTypeDefinition=function(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e==o.FontType.Monospace?x.monospace:this._legacyFontType},e.prototype.getEffectiveSpacing=function(e){switch(e){case o.Spacing.Small:return this.spacing.small;case o.Spacing.Default:return this.spacing.default;case o.Spacing.Medium:return this.spacing.medium;case o.Spacing.Large:return this.spacing.large;case o.Spacing.ExtraLarge:return this.spacing.extraLarge;case o.Spacing.Padding:return this.spacing.padding;default:return 0}},e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new s.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))},e.prototype.makeCssClassNames=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0,r=e;i<r.length;i++){var o=r[i];n.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return n},e.prototype.makeCssClassName=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.makeCssClassNames.apply(this,e).join(" ");return n||""},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:!0,configurable:!0}),e}();t.HostConfig=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.toolboxes={toolPalette:{title:"Card Elements"},cardEditor:{title:"Card Payload Editor"},sampleDataEditor:{title:"Sample Data Editor"},propertySheet:{title:"Element Properties"},cardStructure:{title:"Card Structure"},dataStructure:{title:"Data Structure"}},e.loadingEditor="Loading editor...",e}();t.Strings=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(t.DayOfWeek||(t.DayOfWeek={}))},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(2),s=n(3),l=function(){function e(e){this._isSubdued=!1,this._isSelected=!1,this.date=e}return e.prototype.selected=function(){this.onSelected&&this.onSelected(this)},e.prototype.render=function(){var e=this;return this._element=document.createElement("div"),this._element.className="ms-ctrl ms-ctrl-calendarDay",this._element.innerText=this.date.getDate().toString(),this._element.tabIndex=0,this._element.onclick=function(t){e.selected()},this._element.onkeydown=function(t){if(t.keyCode==a.KEY_ENTER)return e.selected(),!1},this._element},e.prototype.focus=function(){this._element.focus()},Object.defineProperty(e.prototype,"isSubdued",{get:function(){return this._isSubdued},set:function(e){this._isSubdued=e,this._isSubdued?this._element.classList.add("subdued"):this._element.classList.remove("subdued")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._isSelected},set:function(e){this._isSelected=e,this._isSelected?this._element.classList.add("selected"):this._element.classList.remove("selected")},enumerable:!0,configurable:!0}),e}();t.DayCell=l;var c=function(e){function t(){var t=e.call(this)||this;t._selectedDay=null,t._miniCalendarElement=document.createElement("table"),t._miniCalendarElement.className="ms-ctrl ms-ctrl-slide",t._miniCalendarElement.cellPadding="0px",t._miniCalendarElement.cellSpacing="0px";var n=document.createElement("div");n.className="ms-ctrl ms-ctrl-calendarHeader",n.style.display="flex",t._monthYearLabelElement=document.createElement("div"),t._monthYearLabelElement.style.flex="1 1 100%",n.appendChild(t._monthYearLabelElement);var i=document.createElement("div");i.style.flex="0 0 auto";var r=document.createElement("i");return r.className="ms-icon ms-ctrl-calendarNavButton ms-icon-chevronLeft",r.tabIndex=0,r.onclick=function(e){t.date=o.addMonths(t.date,-1)},r.onkeydown=function(e){if(e.keyCode==a.KEY_ENTER)return t.date=o.addMonths(t.date,-1),!1},i.appendChild(r),(r=document.createElement("i")).className="ms-icon ms-ctrl-calendarNavButton ms-icon-chevronRight",r.tabIndex=0,r.onclick=function(e){t.date=o.addMonths(t.date,1)},r.onkeydown=function(e){if(e.keyCode==a.KEY_ENTER)return t.date=o.addMonths(t.date,1),!1},i.appendChild(r),n.appendChild(i),t._rootContainerElement=document.createElement("div"),t._rootContainerElement.className="ms-ctrl ms-ctrl-calendar",t._rootContainerElement.appendChild(n),t._rootContainerElement.appendChild(t._miniCalendarElement),t.date=new Date,t}return r(t,e),t.prototype.generateDayCells=function(e){var t=this;this._days=[];var n=e.getMonth(),i=e.getFullYear(),r=new Date(i,n,1),a=new Date(i,n,o.daysInMonth(i,n)),s=r.getDay();s-o.CalendarSettings.firstDayOfWeek>0&&(r=o.addDays(r,o.CalendarSettings.firstDayOfWeek-s));var c=a.getDay(),u=o.CalendarSettings.firstDayOfWeek+6;u-c>0&&(a=o.addDays(a,u-c));var p=a.getDate(),d=a.getMonth(),h=a.getFullYear();do{var f=new l(r);f.onSelected=function(e){t.selectedDayCell=e,t.onDateChanged&&t.onDateChanged(t)},this._days.push(f);var m=r.getDate()==p&&r.getMonth()==d&&r.getFullYear()==h;r=o.addDays(r,1)}while(!m)},Object.defineProperty(t.prototype,"selectedDayCell",{get:function(){return this._selectedDay},set:function(e){this._selectedDay&&(this._selectedDay.isSelected=!1),this._selectedDay=e,this._selectedDay&&(this._selectedDay.isSelected=!0,this._date=this._selectedDay.date)},enumerable:!0,configurable:!0}),t.prototype.initializeSelection=function(){if(this._date)for(var e=0;e<this._days.length;e++)if(o.areDatesEqual(this._days[e].date,this.date)){this.selectedDayCell=this._days[e];break}},t.prototype.rebuildMiniCalendar=function(e,t){this.generateDayCells(e);var n=e.getMonth();this._miniCalendarElement.innerHTML="",this._miniCalendarElement.classList.remove("ms-ctrl-slide","ms-ctrl-slideLeftToRight","ms-ctrl-slideRightToLeft");for(var i=document.createElement("tr"),r=o.CalendarSettings.firstDayOfWeek,a=0;a<o.CalendarSettings.daysInWeek;a++){var s=document.createElement("td");s.className="ms-ctrl ms-ctrl-calendarDayHeader",s.innerText=o.CalendarSettings.getInitialDayName(r),i.appendChild(s),++r>=o.CalendarSettings.daysInWeek&&(r=0)}this._miniCalendarElement.appendChild(i);for(a=0;a<this._days.length;a++){a%7==0&&(i=document.createElement("tr"),this._miniCalendarElement.appendChild(i));var l=document.createElement("td");l.appendChild(this._days[a].render()),this._days[a].date.getMonth()!=n&&(this._days[a].isSubdued=!0),i.appendChild(l)}if(t){var c=e.getTime()-t.getTime();c>0?this._miniCalendarElement.classList.add("ms-ctrl-slide","ms-ctrl-slideRightToLeft"):c<0&&this._miniCalendarElement.classList.add("ms-ctrl-slide","ms-ctrl-slideLeftToRight")}},t.prototype.attach=function(t){e.prototype.attach.call(this,t),t.innerHTML="",t.appendChild(this._rootContainerElement)},t.prototype.focus=function(){this._selectedDay&&this._selectedDay.focus()},Object.defineProperty(t.prototype,"date",{get:function(){return this._date},set:function(e){var t=!0,n=e||new Date;this._date&&(t=!this._days||n.getFullYear()!=this._date.getFullYear()||n.getMonth()!=this._date.getMonth()),t&&this.rebuildMiniCalendar(n,this._date),this._date=n,this.initializeSelection(),this._monthYearLabelElement.innerText=o.CalendarSettings.getLongMonthName(this._date.getMonth())+" "+this._date.getFullYear()},enumerable:!0,configurable:!0}),t}(s.InputControl);t.Calendar=c},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(14),s=n(6),l=n(24),c=n(9),u=n(25),p=n(11),d=n(8),h=function(){};t.DesignerPeerInplaceEditor=h;var f=function(e){function t(t){var n=e.call(this)||this;return n.cardElement=t,n}return r(t,e),t}(h);t.CardElementPeerInplaceEditor=f;var m=function(e,t){void 0===t&&(t=null),this.category=e,this.iconClass=t};t.DesignerPeerRegistrationBase=m;var g=function(e){function t(t,n,i,r){void 0===r&&(r=null);var o=e.call(this,i,r)||this;return o.sourceType=t,o.peerType=n,o}return r(t,e),t}(m);t.DesignerPeerRegistration=g;var y=function(){function e(e){this.name=e,this._entries=[]}return e.prototype.render=function(t,n,i){for(var r=[],a=0,s=this._entries;a<s.length;a++){var l=s[a];d.isVersionLessOrEqual(l.targetVersion,n.targetVersion)&&r.push(l)}if(r.length>0){if(i){var c=new o.TextBlock;c.separator=!0,c.text="**"+(this.name===e.DefaultCategory?n.peer.getCardObject().getJsonTypeName():this.name)+"**",t.addItem(c)}for(var u=0,p=r;u<p.length;u++){l=p[u];d.isVersionLessOrEqual(l.targetVersion,n.targetVersion)&&t.addItem(l.render(n))}}},e.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._entries=this._entries.concat(e)},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,i=e;n<i.length;n++){var r=i[n],o=void 0;do{var a=this._entries.indexOf(r);a>=0&&this._entries.splice(a,1)}while(o>=0)}},e.prototype.getEntryAt=function(e){return this._entries[e]},Object.defineProperty(e.prototype,"length",{get:function(){return this._entries.length},enumerable:!0,configurable:!0}),e.DefaultCategory="__defaultCategory",e.LayoutCategory="Layout",e.StyleCategory="Style",e.SelectionAction="Selection action",e.InlineAction="Inline action",e}();t.PropertySheetCategory=y;var v=function(){function e(e){void 0===e&&(e=!0),this.displayCategoryNames=e,this._categories={},this._categories[y.DefaultCategory]=new y(y.DefaultCategory),this._categories[y.LayoutCategory]=new y(y.LayoutCategory),this._categories[y.StyleCategory]=new y(y.StyleCategory)}return e.prototype.add=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this._categories[e];i||(i=new y(e),this._categories[e]=i),i.add.apply(i,t)},e.prototype.remove=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var i=0,r=Object.keys(this._categories);i<r.length;i++){var o=r[i];(e=this._categories[o]).remove.apply(e,t)}},e.prototype.render=function(e,t){for(var n=0,i=Object.keys(this._categories);n<i.length;n++){var r=i[n];this._categories[r].render(e,t,this.displayCategoryNames)}},e}();t.PropertySheet=v;var b=function(e){function t(t,n,i){var r=e.call(this)||this;return r._children=[],r._isSelected=!1,r._inplaceEditor=null,r._parent=t,i||alert(r.constructor.name),r.registration=i,r.designerSurface=n,r.treeItem=new u.DesignerPeerTreeItem(r),r}return r(t,e),t.prototype.closeInplaceEditor=function(e){this._inplaceEditor&&(e&&(this._inplaceEditor.applyChanges(),this.changed(!0)),this._inplaceEditor=null,this._inplaceEditorOverlay.remove())},t.prototype.tryOpenInplaceEditor=function(){var e=this;if(this._inplaceEditor=this.createInplaceEditor(),this._inplaceEditor){this._inplaceEditor.onClose=function(t){e.closeInplaceEditor(t)},this._inplaceEditorOverlay=document.createElement("div"),this._inplaceEditorOverlay.tabIndex=0,this._inplaceEditorOverlay.style.zIndex="600",this._inplaceEditorOverlay.style.backgroundColor="transparent",this._inplaceEditorOverlay.style.position="absolute",this._inplaceEditorOverlay.style.left="0",this._inplaceEditorOverlay.style.top="0",this._inplaceEditorOverlay.style.width=document.documentElement.scrollWidth+"px",this._inplaceEditorOverlay.style.height=document.documentElement.scrollHeight+"px",this._inplaceEditorOverlay.onfocus=function(t){e.closeInplaceEditor(!0)};var t=this.getCardObjectBoundingRect(),n=document.createElement("div");n.className="acd-inplace-editor-host",n.style.left=Math.floor(t.left+pageXOffset)+"px",n.style.top=Math.floor(t.top+pageYOffset)+"px",n.style.width=Math.ceil(t.width)+"px",n.style.height=Math.ceil(t.height)+"px";var i=this._inplaceEditor.render();return i.classList.add("acd-inplace-editor"),i.tabIndex=0,i.onblur=function(t){e.closeInplaceEditor(!0)},n.appendChild(i),this._inplaceEditorOverlay.appendChild(n),document.body.appendChild(this._inplaceEditorOverlay),this._inplaceEditor.initialize(),!0}return!1},t.prototype.click=function(t){e.prototype.click.call(this,t),this.isSelected=!0},t.prototype.doubleClick=function(t){e.prototype.doubleClick.call(this,t),this.tryOpenInplaceEditor()},t.prototype.isContainer=function(){return!1},t.prototype.getToolTip=function(){return null},t.prototype.internalAddCommands=function(e){},t.prototype.internalRender=function(){var e=document.createElement("div");e.classList.add("acd-peer");var t=this.getToolTip();return t&&(e.title=t),this.isContainer()&&e.classList.add("container"),e.style.position="absolute",e},t.prototype.internalUpdateCssStyles=function(){this.isSelected?this.renderedElement.classList.add("selected"):this.renderedElement.classList.remove("selected"),this.dragging?this.renderedElement.classList.add("dragging"):this.renderedElement.classList.remove("dragging")},t.prototype.peerAdded=function(e){this.changed(!1),this.onPeerAdded&&this.onPeerAdded(this,e)},t.prototype.peerRemoved=function(e){this.onPeerRemoved&&this.onPeerRemoved(e)},t.prototype.internalUpdateLayout=function(){if(this.renderedElement){var e=this.getBoundingRect();this.renderedElement.style.width=e.width+"px",this.renderedElement.style.height=e.height+"px",this.renderedElement.style.left=e.left+"px",this.renderedElement.style.top=e.top+"px"}},t.prototype.createInplaceEditor=function(){return null},t.prototype.internalGetTreeItemText=function(){return null},t.prototype.changed=function(e){this.onChanged&&this.onChanged(this,e)},t.prototype.getTreeItemText=function(){return this.internalGetTreeItemText()},t.prototype.populatePropertySheet=function(e,t){void 0===t&&(t=y.DefaultCategory)},t.prototype.canDrop=function(e){return!1},t.prototype.canBeRemoved=function(){return!0},t.prototype.tryDrop=function(e,t){return!1},t.prototype.insertChild=function(e,t){void 0===t&&(t=-1),-1==t?this._children.push(e):this._children.splice(t,0,e),e.parent=this,this.peerAdded(e)},t.prototype.removeChild=function(e){var t=this._children.indexOf(e);t>=0&&(e.parent=null,this._children.splice(t,1))},t.prototype.getChildCount=function(){return this._children.length},t.prototype.getChildAt=function(e){return this._children[e]},t.prototype.getCommands=function(e){void 0===e&&(e=!1);var t=[];if(this.internalAddCommands(t),e&&this.parent)for(var n=0,i=this.parent.getCommands();n<i.length;n++){var r=i[n];r.isPromotable&&t.push(r)}return t},t.prototype.remove=function(e,t){if(t)for(;this._children.length>0;)this._children[0].remove(e,t);var n=this.internalRemove();return n&&!e&&(this.parent&&this.parent.removeChild(this),this.removeElementsFromDesignerSurface(),this.peerRemoved(this)),n},t.prototype.addElementsToDesignerSurface=function(e,t){if(void 0===t&&(t=!1),e.appendChild(this.renderedElement),t)for(var n=0;n<this.getChildCount();n++)this.getChildAt(n).addElementsToDesignerSurface(e,t)},t.prototype.removeElementsFromDesignerSurface=function(e){if(void 0===e&&(e=!1),this.renderedElement.remove(),e)for(var t=0;t<this.getChildCount();t++)this.getChildAt(t).removeElementsFromDesignerSurface(e)},t.prototype.buildPropertySheetCard=function(e){var t=new o.AdaptiveCard;t.padding=new o.PaddingDefinition(o.Spacing.Small,o.Spacing.Small,o.Spacing.Small,o.Spacing.Small);var n=new v;this.populatePropertySheet(n),n.render(t,new _(e,this));for(var i=new o.ActionSet,r=function(e){var t=new o.SubmitAction;t.title=e.name,t.onExecute=function(n){e.execute(e,t.renderedElement)},i.addAction(t)},a=0,s=this.getCommands(!0);a<s.length;a++){r(s[a])}return i.separator=!0,t.addItem(i),t},t.prototype.scrollIntoView=function(){this.renderedElement&&this.renderedElement.scrollIntoView(),this.treeItem&&this.treeItem.renderedElement&&this.treeItem.renderedElement.scrollIntoView()},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},set:function(e){this._parent=e,this.onParentChanged&&this.onParentChanged(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._isSelected},set:function(e){e!=this._isSelected&&(this._isSelected=e,this.updateLayout(),this.treeItem.updateLayout(),this.onSelectedChanged&&this.onSelectedChanged(this))},enumerable:!0,configurable:!0}),t}(s.DraggableElement);t.DesignerPeer=b;var _=function(){function e(e,t,n){void 0===n&&(n=void 0),this.targetVersion=e,this.peer=t,this._target=void 0,this._target=n}return Object.defineProperty(e.prototype,"target",{get:function(){return null!=this._target?this._target:this.peer.getCardObject()},enumerable:!0,configurable:!0}),e}();t.PropertySheetContext=_;var C=function(e){this.targetVersion=e};t.PropertySheetEntry=C;var E=function(){function e(e,t,n){this.targetVersion=e,this.target=t,this.propertySheet=n}return e.prototype.render=function(e){var t=new o.Container;return t.spacing=o.Spacing.Small,this.propertySheet.render(t,new _(e.targetVersion,e.peer,this.target)),t},e}();t.SubPropertySheetEntry=E;var S=function(e){function t(t,n){var i=e.call(this,t)||this;return i.targetVersion=t,i.onRender=n,i}return r(t,e),t.prototype.render=function(e){if(this.onRender)return this.onRender(e)},t}(C);t.CustomPropertySheetEntry=S;var x=function(e){function t(t,n,i,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.targetVersion=t,o.propertyName=n,o.label=i,o.causesPropertySheetRefresh=r,o}return r(t,e),t.prototype.getPropertyValue=function(e){return e.target[this.propertyName]},t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]=t},t.prototype.render=function(e){var t=this,n=new o.Column;n.width=new o.SizeAndUnit(100,o.SizeUnit.Pixel),n.verticalContentAlignment=o.VerticalAlignment.Center;var i=new o.Column;i.width="stretch",i.verticalContentAlignment=o.VerticalAlignment.Center;var r=new o.ColumnSet;r.spacing=o.Spacing.Small,r.addColumn(n),r.addColumn(i);var a=new o.TextBlock;a.horizontalAlignment=o.HorizontalAlignment.Right,a.wrap=!0,a.text=this.label;var s=this.createInput(e);return s.defaultValue=this.getPropertyValue(e),s.onValueChanged=function(){t.setPropertyValue(e,s.value),e.peer.changed(t.causesPropertySheetRefresh)},n.addItem(a),i.addItem(s),r},t}(C);t.SingleInputPropertyEditor=x;var P=function(e){function t(t,n,i,r,o){void 0===r&&(r=!1),void 0===o&&(o=!1);var a=e.call(this,t,n,i,o)||this;return a.targetVersion=t,a.propertyName=n,a.label=i,a.isMultiline=r,a.causesPropertySheetRefresh=o,a}return r(t,e),t.prototype.createInput=function(e){var t=new o.TextInput;return t.placeholder="(not set)",t.isMultiline=this.isMultiline,t},t}(x);t.StringPropertyEditor=P;var w=function(e){function t(t,n,i,r,o){void 0===r&&(r=void 0),void 0===o&&(o=!1);var a=e.call(this,t,n,i,o)||this;return a.targetVersion=t,a.propertyName=n,a.label=i,a.defaultValue=r,a.causesPropertySheetRefresh=o,a}return r(t,e),t.prototype.setPropertyValue=function(e,t){try{e.target[this.propertyName]=parseFloat(t)}catch(t){e.target[this.propertyName]=this.defaultValue}},t.prototype.createInput=function(e){var t=new o.NumberInput;return t.placeholder="(not set)",t},t}(x);t.NumberPropertyEditor=w;var T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getPropertyValue=function(e){return JSON.stringify(e.target[this.propertyName])},t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]=JSON.parse(t)},t}(P);t.ObjectPropertyEditor=T;var A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getPropertyValue=function(e){return e.peer.getCardObject().getCustomProperty(this.propertyName)},t.prototype.setPropertyValue=function(e,t){e.peer.getCardObject().setCustomProperty(this.propertyName,t)},t}(P);t.CustomCardObjectPropertyEditor=A;var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getPropertyValue=function(e){var t=e.target[this.propertyName];return"boolean"==typeof t?t.toString():"false"},t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]="true"==t},t.prototype.createInput=function(e){return new o.ToggleInput},t}(x);t.BooleanPropertyEditor=I;var O=function(e){function t(t,n,i,r,o){void 0===o&&(o=!1);var a=e.call(this,t,n,i,o)||this;return a.targetVersion=t,a.propertyName=n,a.label=i,a.choices=r,a.causesPropertySheetRefresh=o,a}return r(t,e),t.prototype.createInput=function(e){var t=new o.ChoiceSetInput;t.isCompact=!0,t.placeholder="(not set)";for(var n=0,i=this.choices;n<i.length;n++){var r=i[n];d.isVersionLessOrEqual(r.targetVersion,e.targetVersion)&&t.choices.push(new o.Choice(r.name,r.value))}return t},t}(x);t.ChoicePropertyEditor=O;var k=function(e){function t(t,n,i){var r=e.call(this,t,n,i,[{targetVersion:d.Versions.v1_0,name:"(not set)",value:"not_set"},{targetVersion:d.Versions.v1_0,name:"Default",value:"default"},{targetVersion:d.Versions.v1_0,name:"Emphasis",value:"emphasis"},{targetVersion:d.Versions.v1_2,name:"Accent",value:"accent"},{targetVersion:d.Versions.v1_2,name:"Good",value:"good"},{targetVersion:d.Versions.v1_2,name:"Attention",value:"attention"},{targetVersion:d.Versions.v1_2,name:"Warning",value:"warning"}])||this;return r.targetVersion=t,r.propertyName=n,r.label=i,r}return r(t,e),t.prototype.getPropertyValue=function(e){var t=e.target[this.propertyName];return t?t.toString():"not_set"},t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]="not_set"==t?null:t},t}(O);t.ContainerStylePropertyEditor=k;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getPropertyValue=function(e){return e.target[this.propertyName]instanceof o.SizeAndUnit?e.target[this.propertyName].unit==o.SizeUnit.Pixel?"pixels":"weighted":e.target[this.propertyName].toString()},t.prototype.setPropertyValue=function(e,t){switch(t){case"auto":e.target[this.propertyName]="auto";break;case"pixels":e.target[this.propertyName]=new o.SizeAndUnit(50,o.SizeUnit.Pixel);break;case"weighted":e.target[this.propertyName]=new o.SizeAndUnit(50,o.SizeUnit.Weight);break;case"stretch":default:e.target[this.propertyName]="stretch"}},t}(O);t.ColumnWidthPropertyEditor=D;var V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.setPropertyValue=function(e,t){var n;switch(t){case"auto":case"stretch":n=t;break;default:n="auto"}e.target[this.propertyName]=n},t}(O);t.HeightPropertyEditor=V;var N=function(e){function t(t,n,i,r,o,a){void 0===o&&(o=void 0),void 0===a&&(a=!1);var s=e.call(this,t,n,i,o,a)||this;return s.targetVersion=t,s.propertyName=n,s.label=i,s.sizeUnit=r,s.defaultValue=o,s.causesPropertySheetRefresh=a,s}return r(t,e),t.prototype.getPropertyValue=function(e){return e.target[this.propertyName].physicalSize.toString()},t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]=new o.SizeAndUnit(parseFloat(t),this.sizeUnit)},t}(w);t.SizeAndUnitPropertyEditor=N;var L=function(e){function t(t,n,i,r,o){void 0===r&&(r=[]),void 0===o&&(o=!1);var a=e.call(this,t,n,i,o)||this;return a.targetVersion=t,a.propertyName=n,a.label=i,a.forbiddenActionTypes=r,a.causesPropertySheetRefresh=o,a}return r(t,e),t.prototype.getPropertyValue=function(e){var t=e.target[this.propertyName];return t?t.getJsonTypeName():"none"},t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]=parseInt(t,10),e.target[this.propertyName]="none"==t?null:o.AdaptiveCard.actionTypeRegistry.createInstance(t)},t.prototype.createInput=function(e){var t=new o.ChoiceSetInput;t.isCompact=!0,t.placeholder="(not set)",t.choices.push(new o.Choice("(not set)","none"));for(var n=0;n<o.AdaptiveCard.actionTypeRegistry.getItemCount();n++){var i=o.AdaptiveCard.actionTypeRegistry.getItemAt(n).typeName;if(!this.forbiddenActionTypes||this.forbiddenActionTypes.indexOf(i)<0){var r=new o.Choice(i,i);t.choices.push(r)}}return t},t}(x);t.ActionPropertyEditor=L;var M=function(e){function t(t,n,i){void 0===i&&(i=[]);var r=e.call(this,t)||this;return r.targetVersion=t,r.propertyName=n,r.entries=i,r}return r(t,e),t.prototype.render=function(e){for(var t=new o.Container,n=0,i=this.entries;n<i.length;n++){var r=i[n];d.isVersionLessOrEqual(r.targetVersion,e.targetVersion)&&t.addItem(r.render(new _(e.targetVersion,e.peer,e.target[this.propertyName])))}return t},t}(C);t.CompoundPropertyEditor=M;var F=function(e){function t(t,n,i,r,o){void 0===o&&(o=!1);var a=e.call(this,t,n,i,o)||this;return a.targetVersion=t,a.propertyName=n,a.label=i,a.enumType=r,a.causesPropertySheetRefresh=o,a}return r(t,e),t.prototype.setPropertyValue=function(e,t){e.target[this.propertyName]=parseInt(t,10)},t.prototype.createInput=function(e){var t=new o.ChoiceSetInput;for(var n in t.isCompact=!0,t.placeholder="(not set)",this.enumType){var i=parseInt(n,10);isNaN(i)||t.choices.push(new o.Choice(this.enumType[n],n))}return t},t}(x);t.EnumPropertyEditor=F;var B=function(e){function t(t,n,i,r,o,a,s,l,c){void 0===a&&(a="Name"),void 0===s&&(s="Value"),void 0===l&&(l="Add"),void 0===c&&(c="This collection is empty");var u=e.call(this,t)||this;return u.targetVersion=t,u.collectionPropertyName=n,u.namePropertyName=i,u.valuePropertyName=r,u.createCollectionItem=o,u.namePropertyLabel=a,u.valuePropertyLabel=s,u.addButtonTitle=l,u.messageIfEmpty=c,u}return r(t,e),t.prototype.collectionChanged=function(e,t,n){e.target[this.collectionPropertyName]=[];for(var i=0,r=t;i<r.length;i++){var o=r[i],a=this.createCollectionItem(o.name,o.value);e.target[this.collectionPropertyName].push(a)}e.peer.changed(n)},t.prototype.render=function(e){var t=this,n=new o.Container,i=e.target[this.collectionPropertyName];if(!Array.isArray(i))throw new Error("The "+this.collectionPropertyName+" property on "+e.peer.getCardObject().getJsonTypeName()+" either doesn't exist or isn't an array.");for(var r=[],a=0,s=i;a<s.length;a++){var l=s[a];r.push({name:l[this.namePropertyName],value:l[this.valuePropertyName]})}if(0==r.length){var c=new o.TextBlock;c.spacing=o.Spacing.Small,c.text=this.messageIfEmpty,n.addItem(c)}else for(var u=function(i){var a=new o.TextInput;a.placeholder=p.namePropertyLabel,a.defaultValue=r[i].name,a.onValueChanged=function(n){r[i].name=n.value,t.collectionChanged(e,r,!1)};var s=new o.Column("stretch");s.addItem(a),(a=new o.TextInput).placeholder=p.valuePropertyLabel,a.defaultValue=r[i].value,a.onValueChanged=function(n){r[i].value=n.value,t.collectionChanged(e,r,!1)};var l=new o.Column("stretch");l.spacing=o.Spacing.Small,l.addItem(a);var c=new o.SubmitAction;c.title="X",c.onExecute=function(n){r.splice(i,1),t.collectionChanged(e,r,!0)};var u=new o.ActionSet;u.addAction(c);var d=new o.Column("auto");d.spacing=o.Spacing.Small,d.addItem(u);var h=new o.ColumnSet;h.spacing=o.Spacing.Small,h.addColumn(s),h.addColumn(l),h.addColumn(d),n.addItem(h)},p=this,d=0;d<r.length;d++)u(d);var h=new o.SubmitAction;h.title=this.addButtonTitle,h.onExecute=function(n){r.push({name:"",value:""}),t.collectionChanged(e,r,!0)};var f=new o.ActionSet;return f.spacing=o.Spacing.Small,f.addAction(h),n.addItem(f),n},t}(C),j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.idProperty=new P(d.Versions.v1_0,"id","Id"),t}(b);t.CardObjectPeer=j;var R=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i)||this;return o._action=r,o}return r(t,e),t.prototype.doubleClick=function(t){e.prototype.doubleClick.call(this,t),this.action.renderedElement.click()},t.prototype.internalRemove=function(){return this.action.remove()},t.prototype.internalGetTreeItemText=function(){return this.action.title&&""!=this.action.title?this.action.title:e.prototype.internalGetTreeItemText.call(this)},t.prototype.getCardObject=function(){return this.action},t.prototype.isDraggable=function(){return!1},t.prototype.getBoundingRect=function(){var e=this.designerSurface.getDesignerSurfaceOffset(),t=this.action.renderedElement.getBoundingClientRect();return new p.Rect(t.top-e.y,t.right-e.x,t.bottom-e.y,t.left-e.x)},t.prototype.getCardObjectBoundingRect=function(){var e=this.action.renderedElement.getBoundingClientRect();return new p.Rect(e.top,e.right,e.bottom,e.left)},t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.idProperty,t.titleProperty,t.styleProperty,t.iconUrlProperty)},Object.defineProperty(t.prototype,"action",{get:function(){return this._action},enumerable:!0,configurable:!0}),t.titleProperty=new P(d.Versions.v1_0,"title","Title"),t.styleProperty=new O(d.Versions.v1_2,"style","Style",[{targetVersion:d.Versions.v1_2,name:"Default",value:o.ActionStyle.Default},{targetVersion:d.Versions.v1_2,name:"Positive",value:o.ActionStyle.Positive},{targetVersion:d.Versions.v1_2,name:"Destructive",value:o.ActionStyle.Destructive}]),t.iconUrlProperty=new P(d.Versions.v1_1,"iconUrl","Icon URL"),t}(j);t.ActionPeer=R;var z=function(e){function t(t,n,i,r){return e.call(this,t,n,i,r)||this}return r(t,e),Object.defineProperty(t.prototype,"action",{get:function(){return this._action},enumerable:!0,configurable:!0}),t}(R);t.TypedActionPeer=z;var H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),o.AdaptiveCard.useBuiltInInputValidation&&n.add(y.DefaultCategory,t.ignoreInputValidationProperty),n.add(i,t.methodProperty,t.urlProperty),"POST"==this.action.method&&n.add(i,t.bodyProperty),n.add("HTTP headers",t.headersProperty)},t.ignoreInputValidationProperty=new I(d.Versions.vNext,"ignoreInputValidation","Ignore input validation"),t.methodProperty=new O(d.Versions.v1_0,"method","Method",[{targetVersion:d.Versions.v1_0,name:"GET",value:"GET"},{targetVersion:d.Versions.v1_0,name:"POST",value:"POST"}],!0),t.urlProperty=new P(d.Versions.v1_0,"url","Url"),t.bodyProperty=new P(d.Versions.v1_0,"body","Body",!0),t.headersProperty=new B(d.Versions.v1_0,"headers","name","value",function(e,t){return new o.HttpHeader(e,t)},"Name","Value","Add a new header","This action has no header."),t}(z);t.HttpActionPeer=H;var U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.ignoreInputValidationProperty,t.dataProperty)},t.ignoreInputValidationProperty=new I(d.Versions.vNext,"ignoreInputValidation","Ignore input validation"),t.dataProperty=new T(d.Versions.v1_0,"data","Data"),t}(z);t.SubmitActionPeer=U;var J=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.urlProperty)},t.urlProperty=new P(d.Versions.v1_0,"url","Url"),t}(z);t.OpenUrlActionPeer=J;var W=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getToolTip=function(){return"Double click to open/close"},t}(z);t.ShowCardActionPeer=W;var $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(z);t.ToggleVisibilityActionPeer=$;var q=function(e){function t(t,n,i,r){var a=e.call(this,t,n,i)||this;if(a._cardElement=r,r instanceof o.CardElementContainer)for(var s=0;s<r.getItemCount();s++)a.insertChild(c.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(a.designerSurface,a,r.getItemAt(s)));for(s=0;s<a.cardElement.getActionCount();s++)a.insertChild(c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(a.designerSurface,a,r.getActionAt(s)));return a}return r(t,e),t.prototype.insertElementAfter=function(e){if(this.cardElement.parent instanceof o.Container){this.cardElement.parent.insertItemAfter(e,this.cardElement);var t=c.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(this.designerSurface,this,e);this.peerAdded(t)}},t.prototype.internalRemove=function(){return this.cardElement.remove()},t.prototype.internalUpdateCssStyles=function(){e.prototype.internalUpdateCssStyles.call(this),this.cardElement.isVisible?this.renderedElement.classList.remove("invisible"):this.renderedElement.classList.add("invisible")},t.prototype.getTreeItemText=function(){var t=e.prototype.getTreeItemText.call(this);if(this.cardElement.isVisible)return t;var n="Hidden";return t&&(n+=" - "+t),n},t.prototype.getCardObject=function(){return this.cardElement},t.prototype.initializeCardElement=function(){},t.prototype.canDrop=function(e){return this.cardElement instanceof o.Container&&e instanceof t},t.prototype.tryDrop=function(e,n){if(this.cardElement instanceof o.Container&&e instanceof t){for(var i=null,r=void 0,a=0;a<this.getChildCount();a++){if((s=this.getChildAt(a).getBoundingRect()).isInside(n)){i=this.getChildAt(a),r=n.y-s.top>=s.height/2;break}}if(i!=e){if(e.cardElement.parent){if(!e.remove(!0,!1))return!1;e.parent.removeChild(e)}if(i)r?this.cardElement.insertItemAfter(e.cardElement,i.cardElement):this.cardElement.insertItemBefore(e.cardElement,i.cardElement);else{var s=this.getBoundingRect();r=n.y-s.top>=s.height/2,this.cardElement.getItemCount()>0&&r?this.cardElement.insertItemAfter(e.cardElement,this.cardElement.getItemAt(this.cardElement.getItemCount()-1)):this.cardElement.insertItemAfter(e.cardElement,null)}return this.insertChild(e,e.cardElement.index),this.changed(!1),!0}}return!1},t.prototype.getBoundingRect=function(){var e=this.designerSurface.getDesignerSurfaceOffset(),t=this.cardElement.renderedElement.getBoundingClientRect();if(this.cardElement.hasVisibleSeparator){var n=this.cardElement.separatorElement.getBoundingClientRect();return new p.Rect(Math.min(n.top,t.top)-e.y,Math.max(n.right,t.right)-e.x,Math.max(n.bottom,t.bottom)-e.y,Math.min(n.left,t.left)-e.x)}return new p.Rect(t.top-e.y,t.right-e.x,t.bottom-e.y,t.left-e.x)},t.prototype.getCardObjectBoundingRect=function(){var e=this.cardElement.renderedElement.getBoundingClientRect();return new p.Rect(e.top,e.right,e.bottom,e.left)},t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),d.GlobalSettings.enableDataBindingSupport&&n.add(i,t.dataContextProperty,t.whenProperty),n.add(i,t.idProperty,t.isVisibleProperty),n.add(y.LayoutCategory,t.spacingProperty,t.separatorProperty,t.horizontalAlignmentProperty,t.heightProperty)},Object.defineProperty(t.prototype,"cardElement",{get:function(){return this._cardElement},enumerable:!0,configurable:!0}),t.dataContextProperty=new A("*","$data","Data context"),t.whenProperty=new A("*","$when","Only show when"),t.idProperty=new P(d.Versions.v1_0,"id","Id"),t.isVisibleProperty=new I(d.Versions.v1_2,"isVisible","Initially visible"),t.spacingProperty=new F(d.Versions.v1_0,"spacing","Spacing",o.Spacing),t.separatorProperty=new I(d.Versions.v1_0,"separator","Separator"),t.horizontalAlignmentProperty=new F(d.Versions.v1_0,"horizontalAlignment","Horizontal alignment",o.HorizontalAlignment),t.heightProperty=new V(d.Versions.v1_1,"height","Height",[{targetVersion:d.Versions.v1_1,name:"Automatic",value:"auto"},{targetVersion:d.Versions.v1_1,name:"Stretch",value:"stretch"}]),t}(j);t.CardElementPeer=q;var Y=function(e){function t(t,n,i,r){return e.call(this,t,n,i,r)||this}return r(t,e),Object.defineProperty(t.prototype,"cardElement",{get:function(){return this._cardElement},enumerable:!0,configurable:!0}),t}(q);t.TypedCardElementPeer=Y;var G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.addAction=function(e){this.cardElement.addAction(e),this.insertChild(c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,this,e))},t.prototype.internalRemove=function(){return!0},t.prototype.internalAddCommands=function(t){var n=this;e.prototype.internalAddCommands.call(this,t),t.push(new l.PeerCommand({name:"Add an action",iconClass:"acd-icon-bolt",execute:function(e,t){for(var i=new a.PopupMenu,r=0;r<o.AdaptiveCard.actionTypeRegistry.getItemCount();r++){var s=new a.DropDownItem(r.toString(),o.AdaptiveCard.actionTypeRegistry.getItemAt(r).typeName);s.onClick=function(e){var t=o.AdaptiveCard.actionTypeRegistry.getItemAt(Number.parseInt(e.key)),r=t.createInstance();r.title=t.typeName,n.addAction(r),i.closePopup()},i.items.add(s)}i.popup(t)}}))},t.prototype.isDraggable=function(){return!1},t.prototype.canBeRemoved=function(){return!1},t.prototype.populatePropertySheet=function(n,i){var r=this;if(void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.remove(j.idProperty,q.isVisibleProperty,q.horizontalAlignmentProperty,q.separatorProperty,q.heightProperty,q.spacingProperty),n.add(i,t.langProperty,t.fallbackTextProperty,t.speakProperty),n.add(y.LayoutCategory,Z.minHeightProperty,Z.verticalContentAlignmentProperty),n.add("Background image",Z.backgroundImageProperty),n.add(y.SelectionAction,Z.selectActionProperty),this.cardElement.selectAction){var o=c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,null,this.cardElement.selectAction);o.onChanged=function(e,t){r.changed(t)};var a=new v(!1);o.populatePropertySheet(a,y.SelectionAction),a.remove(R.iconUrlProperty,R.styleProperty),n.add(y.SelectionAction,new E(d.Versions.v1_2,this.cardElement.selectAction,a))}},t.langProperty=new P(d.Versions.v1_1,"lang","Language"),t.fallbackTextProperty=new P(d.Versions.v1_0,"fallbackText","Fallback text",!0),t.speakProperty=new P(d.Versions.v1_0,"speak","Speak"),t}(Y);t.AdaptiveCardPeer=G;var K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isContainer=function(){return!0},t.prototype.internalGetTreeItemText=function(){if(this.cardElement.width instanceof o.SizeAndUnit)switch(this.cardElement.width.unit){case o.SizeUnit.Weight:return"Weight: "+this.cardElement.width.physicalSize;default:return this.cardElement.width.physicalSize+" pixels"}else switch(this.cardElement.width){case"stretch":return"Stretch";case"auto":return"Automatic";default:return""}},t.prototype.isDraggable=function(){return!1},t.prototype.populatePropertySheet=function(n,i){var r=this;if(void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.widthProperty),this.cardElement.width instanceof o.SizeAndUnit&&(this.cardElement.width.unit==o.SizeUnit.Pixel?n.add(y.DefaultCategory,t.pixelWidthProperty):n.add(y.DefaultCategory,t.weightProperty)),n.add(y.LayoutCategory,Z.minHeightProperty,Z.verticalContentAlignmentProperty),n.add(y.StyleCategory,Z.styleProperty,Z.bleedProperty),n.add("Background image",Z.backgroundImageProperty),n.add(y.SelectionAction,Z.selectActionProperty),this.cardElement.selectAction){var a=c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,null,this.cardElement.selectAction);a.onChanged=function(e,t){r.changed(t)};var s=new v(!1);a.populatePropertySheet(s,y.SelectionAction),s.remove(R.iconUrlProperty,R.styleProperty),n.add(y.SelectionAction,new E(d.Versions.v1_2,this.cardElement.selectAction,s))}},t.pixelWidthProperty=new N(d.Versions.v1_1,"width","Width in pixels",o.SizeUnit.Pixel),t.weightProperty=new N(d.Versions.v1_0,"width","Weight",o.SizeUnit.Weight),t.widthProperty=new D(d.Versions.v1_0,"width","Width",[{targetVersion:d.Versions.v1_0,name:"Automatic",value:"auto"},{targetVersion:d.Versions.v1_0,name:"Stretch",value:"stretch"},{targetVersion:d.Versions.v1_0,name:"Weighted",value:"weighted"},{targetVersion:d.Versions.v1_1,name:"Pixels",value:"pixels"}],!0),t}(Y);t.ColumnPeer=K;var X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isContainer=function(){return!0},t.prototype.internalAddCommands=function(t){var n=this;e.prototype.internalAddCommands.call(this,t),t.push(new l.PeerCommand({name:"Add a column",iconClass:"acd-icon-addColumn",isPromotable:!0,execute:function(e,t){var i=new o.Column;i.width="stretch",n.cardElement.addColumn(i),n.insertChild(c.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(n.designerSurface,n,i))}}))},t.prototype.internalGetTreeItemText=function(){var e=this.cardElement.getCount();switch(e){case 0:return"No column";case 1:return"1 column";default:return e+" columns"}},t.prototype.populatePropertySheet=function(t,n){var i=this;if(void 0===n&&(n=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,t,n),t.add(n,Z.minHeightProperty,Z.styleProperty,Z.bleedProperty),t.add(y.SelectionAction,Z.selectActionProperty),this.cardElement.selectAction){var r=c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,null,this.cardElement.selectAction);r.onChanged=function(e,t){i.changed(t)};var o=new v(!1);r.populatePropertySheet(o,y.SelectionAction),o.remove(R.iconUrlProperty,R.styleProperty),t.add(y.SelectionAction,new E(d.Versions.v1_2,this.cardElement.selectAction,o))}},t.prototype.canDrop=function(e){return!0},t}(Y);t.ColumnSetPeer=X;var Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.isContainer=function(){return!0},t.prototype.populatePropertySheet=function(n,i){var r=this;if(void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(y.LayoutCategory,t.minHeightProperty,t.verticalContentAlignmentProperty),n.add(y.StyleCategory,t.styleProperty,t.bleedProperty),n.add("Background image",t.backgroundImageProperty),n.add(y.SelectionAction,t.selectActionProperty),this.cardElement.selectAction){var o=c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,null,this.cardElement.selectAction);o.onChanged=function(e,t){r.changed(t)};var a=new v(!1);o.populatePropertySheet(a,y.SelectionAction),a.remove(R.iconUrlProperty,R.styleProperty),n.add(y.SelectionAction,new E(d.Versions.v1_2,this.cardElement.selectAction,a))}},t.selectActionProperty=new L(d.Versions.v1_0,"selectAction","Action type",[o.ShowCardAction.JsonTypeName],!0),t.minHeightProperty=new w(d.Versions.v1_2,"minPixelHeight","Minimum height in pixels"),t.verticalContentAlignmentProperty=new F(d.Versions.v1_1,"verticalContentAlignment","Vertical content alignment",o.VerticalAlignment),t.styleProperty=new k(d.Versions.v1_0,"style","Style"),t.bleedProperty=new I(d.Versions.v1_2,"bleed","Bleed"),t.backgroundImageProperty=new M(d.Versions.v1_0,"backgroundImage",[new P(d.Versions.v1_0,"url","URL"),new F(d.Versions.v1_2,"fillMode","Fill mode",o.FillMode),new F(d.Versions.v1_2,"horizontalAlignment","Horizontal alignment",o.HorizontalAlignment),new F(d.Versions.v1_2,"verticalAlignment","Vertical alignment",o.VerticalAlignment)]),t}(Y);t.ContainerPeer=Z;var Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.addAction=function(e){this.cardElement.addAction(e),this.insertChild(c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,this,e))},t.prototype.internalAddCommands=function(t){var n=this;e.prototype.internalAddCommands.call(this,t),t.push(new l.PeerCommand({name:"Add an action",iconClass:"acd-icon-bolt",execute:function(e,t){for(var i=new a.PopupMenu,r=0;r<o.AdaptiveCard.actionTypeRegistry.getItemCount();r++){var s=new a.DropDownItem(r.toString(),o.AdaptiveCard.actionTypeRegistry.getItemAt(r).typeName);s.onClick=function(e){var t=o.AdaptiveCard.actionTypeRegistry.getItemAt(Number.parseInt(e.key)),r=t.createInstance();r.title=t.typeName,n.addAction(r),i.closePopup()},i.items.add(s)}i.popup(t)}}))},t}(Y);t.ActionSetPeer=Q;var ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalAddCommands=function(t){var n=this;e.prototype.internalAddCommands.call(this,t),t.push(new l.PeerCommand({name:"Add an image",iconClass:"acd-icon-image",isPromotable:!0,execute:function(e,t){var i=new o.Image;n.cardElement.addImage(i),n.insertChild(c.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(n.designerSurface,n,i))}}))},t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.ImageSizeProperty)},t.ImageSizeProperty=new F(d.Versions.v1_0,"imageSize","Image size",o.Size),t}(Y);t.ImageSetPeer=ee;var te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),Object.defineProperty(t.prototype,"isParentImageSet",{get:function(){return this.parent&&this.parent instanceof ee},enumerable:!0,configurable:!0}),t.prototype.isDraggable=function(){return!this.isParentImageSet},t.prototype.getBoundingRect=function(){if(this.isParentImageSet){var t=this.designerSurface.getDesignerSurfaceOffset(),n=this.cardElement.renderedElement.getBoundingClientRect();return new p.Rect(n.top-t.y,n.right-t.x,n.bottom-t.y,n.left-t.x)}return e.prototype.getBoundingRect.call(this)},t.prototype.populatePropertySheet=function(n,i){var r=this;if(void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.urlProperty,t.altTextProperty),!this.isParentImageSet&&(n.add(y.LayoutCategory,t.sizeProperty,t.pixelWidthProperty,t.pixelHeightProperty),n.add(y.StyleCategory,t.styleProperty,t.backgroundColorProperty),n.add(y.SelectionAction,Z.selectActionProperty),this.cardElement.selectAction)){var o=c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,null,this.cardElement.selectAction);o.onChanged=function(e,t){r.changed(t)};var a=new v(!1);o.populatePropertySheet(a,y.SelectionAction),a.remove(R.iconUrlProperty,R.styleProperty),n.add(y.SelectionAction,new E(d.Versions.v1_2,this.cardElement.selectAction,a))}},t.urlProperty=new P(d.Versions.v1_0,"url","Url"),t.altTextProperty=new P(d.Versions.v1_0,"altText","Alternate text"),t.sizeProperty=new F(d.Versions.v1_0,"size","Size",o.Size),t.pixelWidthProperty=new w(d.Versions.v1_1,"pixelWidth","Width in pixels"),t.pixelHeightProperty=new w(d.Versions.v1_1,"pixelHeight","Height in pixels"),t.styleProperty=new F(d.Versions.v1_0,"style","Style",o.ImageStyle),t.backgroundColorProperty=new P(d.Versions.v1_1,"backgroundColor","Background color"),t}(Y);t.ImagePeer=te;var ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalGetTreeItemText=function(){return"audio"==this.cardElement.selectedMediaType?"audio":"video"==this.cardElement.selectedMediaType?"video":e.prototype.internalGetTreeItemText.call(this)},t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.altTextProperty,t.posterUrlProperty),n.add("Sources",t.sourcesProperty)},t.altTextProperty=new P(d.Versions.v1_1,"altText","Alternate text"),t.posterUrlProperty=new P(d.Versions.v1_1,"posterUrl","Poster URL"),t.sourcesProperty=new B(d.Versions.v1_1,"sources","url","mimeType",function(e,t){return new o.MediaSource(e,t)},"URL","MIME type","Add a new source","No source has been defined."),t}(Y);t.MediaPeer=ne;var ie=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalGetTreeItemText=function(){return 0==this.cardElement.facts.length?"No fact":this.cardElement.facts.map(function(e,t,n){return e.name}).join(", ")},t.prototype.initializeCardElement=function(){e.prototype.initializeCardElement.call(this),this.cardElement.facts.push(new o.Fact("Fact 1","Value 1"),new o.Fact("Fact 2","Value 2"))},t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add("Facts",t.factsProperty),n.remove(q.horizontalAlignmentProperty)},t.factsProperty=new B(d.Versions.v1_0,"facts","name","value",function(e,t){return new o.Fact(e,t)},"Name","Value","Add a new fact","This FactSet is empty."),t}(Y);t.FactSetPeer=ie;var re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add("Validation",t.validationProperty),n.remove(q.horizontalAlignmentProperty,q.heightProperty)},t.defaultValueProperty=new P(d.Versions.v1_0,"defaultValue","Default value"),t.validationProperty=new M(d.Versions.vNext,"validation",[new F(d.Versions.vNext,"necessity","Necessity",o.InputValidationNecessity),new P(d.Versions.vNext,"errorMessage","Error message")]),t}(Y);t.InputPeer=re;var oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){var r=this;if(void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.placeholderProperty,t.isMultilineProperty),this.cardElement.isMultiline||n.add(y.DefaultCategory,t.styleProperty),n.add(y.InlineAction,t.inlineActionProperty),this.cardElement.inlineAction){var o=c.CardDesignerSurface.actionPeerRegistry.createPeerInstance(this.designerSurface,null,this.cardElement.inlineAction);o.onChanged=function(e,t){r.changed(t)};var a=new v(!1);o.populatePropertySheet(a,y.InlineAction),a.remove(R.styleProperty),n.add(y.InlineAction,new E(d.Versions.v1_2,this.cardElement.inlineAction,a))}n.add(i,t.maxLengthProperty,t.defaultValueProperty)},t.prototype.initializeCardElement=function(){e.prototype.initializeCardElement.call(this),this.cardElement.placeholder="Placeholder text"},t.placeholderProperty=new P(d.Versions.v1_0,"placeholder","Placeholder"),t.isMultilineProperty=new I(d.Versions.v1_0,"isMultiline","Multi-line",!0),t.styleProperty=new F(d.Versions.v1_0,"style","Style",o.InputTextStyle),t.maxLengthProperty=new w(d.Versions.v1_0,"maxLength","Maximum length"),t.inlineActionProperty=new L(d.Versions.v1_2,"inlineAction","Action type",[o.ShowCardAction.JsonTypeName],!0),t}(re);t.TextInputPeer=oe;var ae=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.placeholderProperty,t.defaultValueProperty,t.minProperty,t.maxProperty)},t.prototype.initializeCardElement=function(){e.prototype.initializeCardElement.call(this),this.cardElement.placeholder="Placeholder text"},t.placeholderProperty=new P(d.Versions.v1_0,"placeholder","Placeholder"),t.minProperty=new w(d.Versions.v1_0,"min","Minimum value"),t.maxProperty=new w(d.Versions.v1_0,"max","Maximum value"),t}(re);t.NumberInputPeer=ae;var se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.defaultValueProperty,t.minProperty,t.maxProperty)},t.minProperty=new P(d.Versions.v1_0,"min","Minimum value"),t.maxProperty=new P(d.Versions.v1_0,"max","Maximum value"),t}(re);t.DateInputPeer=se;var le=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.defaultValueProperty,t.minProperty,t.maxProperty)},t.minProperty=new P(d.Versions.v1_0,"min","Minimum value"),t.maxProperty=new P(d.Versions.v1_0,"max","Maximum value"),t}(re);t.TimeInputPeer=le;var ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.titleProperty,t.valueOnProperty,t.valueOffProperty,t.defaultValueProperty),n.add(y.LayoutCategory,t.wrapProperty)},t.prototype.initializeCardElement=function(){this.cardElement.title="New Input.Toggle"},t.titleProperty=new P(d.Versions.v1_0,"title","Title"),t.valueOnProperty=new P(d.Versions.v1_0,"valueOn","Value when on"),t.valueOffProperty=new P(d.Versions.v1_0,"valueOff","Value when off"),t.wrapProperty=new I(d.Versions.v1_2,"wrap","Wrap"),t}(re);t.ToggleInputPeer=ce;var ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.placeholderProperty,t.isMultiselectProperty,t.isCompactProperty,t.defaultValueProperty),n.add(y.LayoutCategory,ce.wrapProperty),n.add("Choices",t.choicesProperty)},t.prototype.initializeCardElement=function(){this.cardElement.placeholder="Placeholder text",this.cardElement.choices.push(new o.Choice("Choice 1","Choice 1"),new o.Choice("Choice 2","Choice 2"))},t.placeholderProperty=new P(d.Versions.v1_0,"placeholder","Placeholder"),t.isMultiselectProperty=new I(d.Versions.v1_0,"isMultiSelect","Allow multi selection"),t.isCompactProperty=new I(d.Versions.v1_0,"isCompact","Compact style"),t.wrapProperty=new I(d.Versions.v1_2,"wrap","Wrap"),t.choicesProperty=new B(d.Versions.v1_0,"choices","title","value",function(e,t){return new o.Choice(e,t)},"Title","Value","Add a new choice","This ChoiceSet is empty"),t}(re);t.ChoiceSetInputPeer=ue;var pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.close=function(e){this.onClose&&this.onClose(e)},t.prototype.initialize=function(){this._renderedElement.select()},t.prototype.applyChanges=function(){this.cardElement.text=this._renderedElement.value},t.prototype.render=function(){var e=this;return this._renderedElement=document.createElement("textarea"),this._renderedElement.className="acd-textBlock-inplace-editor",this._renderedElement.value=this.cardElement.text,this._renderedElement.onkeydown=function(t){switch(t.keyCode){case a.KEY_ESCAPE:e.close(!1),t.preventDefault(),t.cancelBubble=!0;break;case a.KEY_ENTER:e.close(!0),t.preventDefault(),t.cancelBubble=!0}return!t.cancelBubble},this.cardElement.applyStylesTo(this._renderedElement),this._renderedElement},t}(f),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.createInplaceEditor=function(){return new pe(this.cardElement)},t.prototype.internalGetTreeItemText=function(){return this.cardElement.text},t.prototype.populatePropertySheet=function(n,i){void 0===i&&(i=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,n,i),n.add(i,t.textProperty),n.add(y.LayoutCategory,t.wrapProperty,t.maxLinesProperty),n.add(y.StyleCategory,t.fontTypeProperty,t.sizeProperty,t.weightProperty,t.colorProperty,t.subtleProperty)},t.prototype.getToolTip=function(){return"Double click to edit"},t.prototype.initializeCardElement=function(){this.cardElement.text&&""!=this.cardElement.text||(this.cardElement.text="New TextBlock")},t.textProperty=new P(d.Versions.v1_0,"text","Text",!0),t.wrapProperty=new I(d.Versions.v1_0,"wrap","Wrap"),t.maxLinesProperty=new w(d.Versions.v1_0,"maxLines","Maximum lines",0),t.fontTypeProperty=new F(d.Versions.v1_2,"fontType","Font type",o.FontType),t.sizeProperty=new F(d.Versions.v1_0,"size","Size",o.TextSize),t.weightProperty=new F(d.Versions.v1_0,"weight","Weight",o.TextWeight),t.colorProperty=new F(d.Versions.v1_0,"color","Color",o.TextColor),t.subtleProperty=new I(d.Versions.v1_0,"subtle","Subtle"),t}(Y);t.TextBlockPeer=de;var he=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalGetTreeItemText=function(){return this.cardElement.asString()},t.prototype.populatePropertySheet=function(t,n){void 0===n&&(n=y.DefaultCategory),e.prototype.populatePropertySheet.call(this,t,n),t.add(n,new S("*",function(e){var t=new o.TextBlock;return t.text="Use the **Card Payload Editor** to edit the text of this RichTextBlock element.",t.wrap=!0,t.spacing=o.Spacing.Large,t.separator=!0,t.horizontalAlignment=o.HorizontalAlignment.Center,t}))},t.prototype.initializeCardElement=function(){var e=new o.TextRun;e.text="New RichTextBlock",this.cardElement.addInline(e)},t}(Y);t.RichTextBlockPeer=he},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.isPromotable=!1,Object.assign(this,e)}return e.prototype.internalRender=function(){var e=this,t=document.createElement("button");return t.type="button",t.title=this.name,t.classList.add("acd-peerButton"),t.classList.add(this.iconClass),t.style.display="flex",t.style.flex="0 0 auto",t.style.alignItems="center",t.onclick=function(n){e.execute&&e.execute(e,t)},t.onpointerdown=function(e){e.cancelBubble=!0},t},e.prototype.render=function(){return this._renderedElement=this.internalRender(),this._renderedElement},Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),e}();t.PeerCommand=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this)||this;return n.owner=t,n.owner.onParentChanged=function(e){n.computeLevel()},n.computeLevel(),n}return r(t,e),t.prototype.computeLevel=function(){this._level=0;for(var e=this.owner;e;)this._level++,e=e.parent;for(var t=0;t<this.getChildCount();t++)this.getChildAt(t).computeLevel()},t.prototype.getIconClass=function(){return this.owner.registration.iconClass},t.prototype.getLabelText=function(){return this.owner.getCardObject().getJsonTypeName()},t.prototype.getAdditionalText=function(){return this.owner.getTreeItemText()},t.prototype.selected=function(){this.owner.isSelected=!0},t.prototype.getChildCount=function(){return this.owner.getChildCount()},t.prototype.getChildAt=function(e){return this.owner.getChildAt(e).treeItem},t.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this.isSelected=this.owner.isSelected},t}(n(16).BaseTreeItem);t.DesignerPeerTreeItem=o},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(27)),i(n(47)),i(n(28))},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=["/","*","-","+","==","!=","<","<=",">",">="],a=["identifier","string","number","boolean"],s=function(){function e(){}return e.init=function(){e.rules.push({tokenType:void 0,regEx:/^\s/},{tokenType:"{",regEx:/^{/},{tokenType:"?#",regEx:/^\?#/},{tokenType:"}",regEx:/^}/},{tokenType:"[",regEx:/^\[/},{tokenType:"]",regEx:/^\]/},{tokenType:"(",regEx:/^\(/},{tokenType:")",regEx:/^\)/},{tokenType:"boolean",regEx:/^true|^false/},{tokenType:"identifier",regEx:/^[$a-z_]+/i},{tokenType:".",regEx:/^\./},{tokenType:",",regEx:/^,/},{tokenType:"+",regEx:/^\+/},{tokenType:"-",regEx:/^-/},{tokenType:"*",regEx:/^\*/},{tokenType:"/",regEx:/^\//},{tokenType:"==",regEx:/^==/},{tokenType:"!=",regEx:/^!=/},{tokenType:"<=",regEx:/^<=/},{tokenType:"<",regEx:/^</},{tokenType:">=",regEx:/^>=/},{tokenType:">",regEx:/^>/},{tokenType:"string",regEx:/^"([^"]*)"/},{tokenType:"string",regEx:/^'([^']*)'/},{tokenType:"number",regEx:/^\d*\.?\d+/})},e.parse=function(t){for(var n=[],i=0;i<t.length;){for(var r=t.substring(i),o=!1,a=0,s=e.rules;a<s.length;a++){var l=s[a],c=l.regEx.exec(r);if(c){if(c.length>2)throw new Error("A tokenizer rule matched more than one group.");void 0!==l.tokenType&&n.push({type:l.tokenType,value:c[1===c.length?0:1],originalPosition:i}),i+=c[0].length,o=!0;break}}if(!o)throw new Error("Unexpected character "+r[0]+" at position "+i)}return n},e.rules=[],e}();function l(e){if("number"==typeof e||"string"==typeof e||"boolean"==typeof e)return e;throw new Error("Invalid value type: "+typeof e)}s.init();var c=function(){function e(){this._functions=[]}return e.prototype.indexOf=function(e){return this._functions.findIndex(function(t){return t.name===e})},e.prototype.register=function(e,t){var n=this.indexOf(e);n>=0?this._functions[n].callback=t:this._functions.push({name:e,callback:t})},e.prototype.unregister=function(e){var t=this.indexOf(e);t>=0&&this._functions.splice(t,1)},e.prototype.find=function(e){var t=this.indexOf(e);return t>=0?this._functions[t]:void 0},e}(),u=function(){function e(){this._functions=new c,this._stateStack=[]}return e.init=function(){e._builtInFunctions.register("substr",function(e,t,n){return"string"==typeof e&&"number"==typeof t&&"number"==typeof n?e.substr(t,n):""}),e._builtInFunctions.register("JSON.parse",function(e){return JSON.parse(e)}),e._builtInFunctions.register("toString",function(e){return e.toString?e.toString():e}),e._builtInFunctions.register("parseInt",function(e,t){return"string"!=typeof e||void 0!==t&&"number"!=typeof t?e:parseInt(e,t)}),e._builtInFunctions.register("parseFloat",function(e){return"string"==typeof e?parseFloat(e):e}),e._builtInFunctions.register("if",function(e,t,n){return e?t:n}),e._builtInFunctions.register("toUpper",function(e){return"string"==typeof e?e.toUpperCase():e}),e._builtInFunctions.register("toLower",function(e){return"string"==typeof e?e.toLowerCase():e}),e._builtInFunctions.register("Date.format",function(e,t){var n;if("string"==typeof e)n=Date.parse(e);else{if("number"!=typeof e)return e;n=e}var i=new Date(n),r="compact";return"string"==typeof t&&(r=t.toLowerCase(),["long","short","compact"].indexOf(r)<0&&(r="compact")),"compact"===r?i.toLocaleDateString():i.toLocaleDateString(void 0,{day:"numeric",weekday:r,month:r,year:"numeric"})}),e._builtInFunctions.register("Time.format",function(e){var t;if("string"==typeof e)t=Date.parse(e);else{if("number"!=typeof e)return e;t=e}return new Date(t).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"})}),e._builtInFunctions.register("round",function(e){return"number"==typeof e?Math.round(e):e}),e._builtInFunctions.register("ceil",function(e){return"number"==typeof e?Math.ceil(e):e}),e._builtInFunctions.register("floor",function(e){return"number"==typeof e?Math.floor(e):e})},e.prototype.registerFunction=function(e,t){this._functions.register(e,t)},e.prototype.unregisterFunction=function(e){this._functions.unregister(e)},e.prototype.getFunction=function(t){var n=this._functions.find(t);return n||(n=e._builtInFunctions.find(t)),n?n.callback:void 0},e.prototype.isReservedField=function(t){return e._reservedFields.indexOf(t)>=0},e.prototype.saveState=function(){this._stateStack.push({$data:this.$data,$index:this.$index})},e.prototype.restoreLastState=function(){if(0===this._stateStack.length)throw new Error("There is no evaluation context state to restore.");var e=this._stateStack.pop();this.$data=e.$data,this.$index=e.$index},Object.defineProperty(e.prototype,"currentDataContext",{get:function(){return void 0!==this.$data?this.$data:this.$root},enumerable:!0,configurable:!0}),e._reservedFields=["$data","$root","$index"],e._builtInFunctions=new c,e}();t.EvaluationContext=u,u.init();var p=function(){},d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodes=[],t.allowNull=!0,t}return r(t,e),t.prototype.evaluate=function(e){for(var t=this.nodes.slice(),n=0,i=[["/","*"],["-","+"],["==","!=","<","<=",">",">="]];n<i.length;n++)for(var r=i[n],o=0;o<t.length;){var a=t[o];if(a instanceof y&&r.indexOf(a.operator)>=0){var s=l(t[o-1].evaluate(e)),c=l(t[o+1].evaluate(e));if(typeof s!=typeof c)throw new Error("Incompatible operands "+s+" and "+c+" for operator "+a.operator);var u=void 0;if("number"==typeof s&&"number"==typeof c)switch(a.operator){case"/":u=s/c;break;case"*":u=s*c;break;case"-":u=s-c;break;case"+":u=s+c}if("string"==typeof s&&"string"==typeof c)switch(a.operator){case"+":u=s+c}switch(a.operator){case"==":u=s===c;break;case"!=":u=s!==c;break;case"<":u=s<c;break;case"<=":u=s<=c;break;case">":u=s>c;break;case">=":u=s>=c}t.splice(o-1,3,new g(u)),o--}o++}return t[0].evaluate(e)},t}(p),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.evaluate=function(e){return this.identifier},t}(p),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.evaluate=function(e){return this.index.evaluate(e)},t}(p),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.functionName=null,t.parameters=[],t}return r(t,e),t.prototype.evaluate=function(e){var t=e.getFunction(this.functionName);if(void 0!==t){for(var n=[],i=0,r=this.parameters;i<r.length;i++){var o=r[i];n.push(o.evaluate(e))}return t.apply(void 0,n)}throw new Error("Undefined function: "+this.functionName)},t}(p),g=function(e){function t(t){var n=e.call(this)||this;return n.value=t,n}return r(t,e),t.prototype.evaluate=function(e){return this.value},t}(p),y=function(e){function t(t){var n=e.call(this)||this;return n.operator=t,n}return r(t,e),t.prototype.evaluate=function(e){throw new Error("An operator cannot be evaluated on its own.")},t}(p),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.parts=[],t}return r(t,e),t.prototype.evaluate=function(e){for(var t=void 0,n=0;n<this.parts.length;){var i=this.parts[n];try{if(i instanceof h&&0===n)switch(i.identifier){case"$root":t=e.$root;break;case"$data":t=e.currentDataContext;break;case"$index":t=e.$index;break;default:t=e.currentDataContext[i.identifier]}else{var r=i.evaluate(e);t=0===n?r:"boolean"!=typeof r?t[r]:t[r.toString()]}}catch(e){return}n++}return t},t}(p),b=function(){function e(e){this._index=0,this._tokens=e}return e.prototype.unexpectedToken=function(){throw new Error("Unexpected token "+this.current.value+" at position "+this.current.originalPosition+".")},e.prototype.unexpectedEoe=function(){throw new Error("Unexpected end of expression.")},e.prototype.moveNext=function(){this._index++},e.prototype.parseToken=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.eoe&&this.unexpectedEoe();var n=this.current;return e.indexOf(this.current.type)<0&&this.unexpectedToken(),this.moveNext(),n},e.prototype.parseOptionalToken=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!this.eoe)return!(e.indexOf(this.current.type)<0)&&(this.moveNext(),!0);this.unexpectedEoe()},e.prototype.parseFunctionCall=function(e){var t=new m;t.functionName=e,this.parseToken("(");var n=this.parseExpression(),i=!1;if(n){t.parameters.push(n);do{if(i=this.parseOptionalToken(",")){var r=this.parseExpression();t.parameters.push(r)}}while(i)}return this.parseToken(")"),t},e.prototype.parseIdentifier=function(){var e=new h;return e.identifier=this.current.value,this.moveNext(),e},e.prototype.parseIndexer=function(){var e=new f;return this.parseToken("["),e.index=this.parseExpression(),this.parseToken("]"),e},e.prototype.parsePath=function(){for(var e=new v,t=["identifier","("];!this.eoe;){if(t.indexOf(this.current.type)<0)return e;switch(this.current.type){case"(":if(0===e.parts.length)this.moveNext(),e.parts.push(this.parseExpression()),this.parseToken(")");else{for(var n="",i=0,r=e.parts;i<r.length;i++){var o=r[i];o instanceof h||this.unexpectedToken(),""!==n&&(n+="."),n+=o.identifier}e.parts=[],e.parts.push(this.parseFunctionCall(n))}t=[".","["];break;case"[":e.parts.push(this.parseIndexer()),t=[".","(","["];break;case"identifier":e.parts.push(this.parseIdentifier()),t=[".","(","["];break;case".":this.moveNext(),t=["identifier"];break;default:t=[]}}},e.prototype.parseExpression=function(){for(var e=new d,t=a.concat("(","+","-");!this.eoe;){if(t.indexOf(this.current.type)<0)return 0===e.nodes.length&&this.unexpectedToken(),e;switch(this.current.type){case"(":case"identifier":e.nodes.push(this.parsePath()),t=o;break;case"string":case"number":case"boolean":"string"===this.current.type?e.nodes.push(new g(this.current.value)):"number"===this.current.type?e.nodes.push(new g(parseFloat(this.current.value))):e.nodes.push(new g("true"===this.current.value)),this.moveNext(),t=o;break;case"-":0===e.nodes.length?(e.nodes.push(new g(-1)),e.nodes.push(new y("*")),t=["identifier","number","("]):(e.nodes.push(new y(this.current.type)),t=a.concat("(")),this.moveNext();break;case"+":0===e.nodes.length?t=a.concat("("):(e.nodes.push(new y(this.current.type)),t=a.concat("(")),this.moveNext();break;case"*":case"/":case"==":case"!=":case"<":case"<=":case">":case">=":e.nodes.push(new y(this.current.type)),this.moveNext(),t=a.concat("(");break;default:t=[]}}},Object.defineProperty(e.prototype,"eoe",{get:function(){return this._index>=this._tokens.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"current",{get:function(){return this._tokens[this._index]},enumerable:!0,configurable:!0}),e.parseBinding=function(t){var n=new e(s.parse(t));n.parseToken("{");var i=!n.parseOptionalToken("?#"),r=n.parseExpression();return n.parseToken("}"),new _(t,r,i)},e}();t.ExpressionParser=b;var _=function(){function e(e,t,n){void 0===n&&(n=!0),this.expressionString=e,this.expression=t,this.allowNull=n}return e.prototype.evaluate=function(e){return this.expression.evaluate(e)},e}();t.Binding=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.undefinedExpressionValueSubstitutionString=void 0,e}();t.GlobalSettings=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.otherTestPayload='{\n\t"$schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n\t"type": "AdaptiveCard",\n\t"version": "1.0",\n\t"body": [\n\t\t{\n\t\t\t"type": "ActionSet",\n\t\t\t"actions": [\n\t\t\t\t{\n\t\t\t\t\t"type": "Action.ShowCard",\n\t\t\t\t\t"title": "Set due date",\n\t\t\t\t\t"card": {\n\t\t\t\t\t\t"type": "AdaptiveCard",\n\t\t\t\t\t\t"body": [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t"type": "Input.Date",\n\t\t\t\t\t\t\t\t"id": "dueDate",\n\t\t\t\t\t\t\t\t"title": "Select due date"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t"type": "Input.Text",\n\t\t\t\t\t\t\t\t"id": "comment",\n\t\t\t\t\t\t\t\t"isMultiline": true,\n\t\t\t\t\t\t\t\t"placeholder": "Add a comment"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\t"actions": [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t"type": "Action.OpenUrl",\n\t\t\t\t\t\t\t\t"title": "OK",\n\t\t\t\t\t\t\t\t"url": "https://adaptivecards.io"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t"type": "Action.OpenUrl",\n\t\t\t\t\t"title": "View",\n\t\t\t\t\t"url": "https://adaptivecards.io"\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t]\n}',t.defaultPayload='{\n    "type": "AdaptiveCard",\n    "body": [\n        {\n            "type": "TextBlock",\n            "size": "Medium",\n            "weight": "Bolder",\n            "text": "Publish Adaptive Card schema"\n        },\n        {\n            "type": "ColumnSet",\n            "columns": [\n                {\n                    "type": "Column",\n                    "items": [\n                        {\n                            "type": "Image",\n                            "style": "Person",\n                            "url": "https://pbs.twimg.com/profile_images/3647943215/d7f12830b3c17a5a9e4afcc370e3a37e_400x400.jpeg",\n                            "size": "Small"\n                        }\n                    ],\n                    "width": "auto"\n                },\n                {\n                    "type": "Column",\n                    "items": [\n                        {\n                            "type": "TextBlock",\n                            "weight": "Bolder",\n                            "text": "Matt Hidinger",\n                            "wrap": true\n                        },\n                        {\n                            "type": "TextBlock",\n                            "spacing": "None",\n                            "text": "Created {{DATE(2017-02-14T06:08:39Z,SHORT)}}",\n                            "isSubtle": true,\n                            "wrap": true\n                        }\n                    ],\n                    "width": "stretch"\n                }\n            ]\n        },\n        {\n            "type": "TextBlock",\n            "text": "Now that we have defined the main rules and features of the format, we need to produce a schema and publish it to GitHub. The schema will be the starting point of our reference documentation.",\n            "wrap": true\n        },\n        {\n            "type": "FactSet",\n            "facts": [\n                {\n                    "title": "Board:",\n                    "value": "Adaptive Card"\n                },\n                {\n                    "title": "List:",\n                    "value": "Backlog"\n                },\n                {\n                    "title": "Assigned to:",\n                    "value": "Matt Hidinger"\n                },\n                {\n                    "title": "Due date:",\n                    "value": "Not set"\n                }\n            ]\n        }\n    ],\n    "actions": [\n        {\n            "type": "Action.ShowCard",\n            "title": "Set due date",\n            "card": {\n                "type": "AdaptiveCard",\n                "body": [\n                    {\n                        "type": "Input.Date",\n                        "id": "dueDate"\n                    },\n                    {\n                        "type": "Input.Text",\n                        "id": "comment",\n                        "placeholder": "Add a comment",\n                        "isMultiline": true\n                    }\n                ],\n                "actions": [\n                    {\n                        "type": "Action.OpenUrl",\n                        "title": "OK",\n                        "url": "http://adaptivecards.io"\n                    }\n                ],\n                "$schema": "http://adaptivecards.io/schemas/adaptive-card.json"\n            }\n        },\n        {\n            "type": "Action.OpenUrl",\n            "title": "View",\n            "url": "http://adaptivecards.io"\n        }\n    ],\n    "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n    "version": "1.0"\n}',t.defaultTemplatePayload='{\n    "type": "AdaptiveCard",\n    "body": [\n        {\n            "type": "Container",\n            "items": [\n                {\n                    "type": "TextBlock",\n                    "text": "This example uses [Adaptive Card Templating](https://docs.microsoft.com/en-us/adaptive-cards/templating/) *(Preview)*",\n                    "size": "Medium",\n                    "wrap": true\n                },\n                {\n                    "type": "TextBlock",\n                    "text": "Click the **Preview mode** toolbar button to see the card bound to the **Sample Data** in the lower-right. Sample Data helps design your card by simulating the real data.",\n                    "wrap": true\n                },\n                {\n                    "type": "TextBlock",\n                    "text": "When you\'re ready to populate it with real data, use the Adaptive Card [templating SDKs](https://docs.microsoft.com/en-us/adaptive-cards/templating/sdk).",\n                    "wrap": true\n                }\n            ],\n            "style": "good",\n            "bleed": true\n        },\n        {\n            "type": "TextBlock",\n            "size": "Medium",\n            "weight": "Bolder",\n            "text": "{title}"\n        },\n        {\n            "type": "ColumnSet",\n            "columns": [\n                {\n                    "type": "Column",\n                    "items": [\n                        {\n                            "type": "Image",\n                            "style": "Person",\n                            "url": "{creator.profileImage}",\n                            "size": "Small"\n                        }\n                    ],\n                    "width": "auto"\n                },\n                {\n                    "type": "Column",\n                    "items": [\n                        {\n                            "type": "TextBlock",\n                            "weight": "Bolder",\n                            "text": "{creator.name}",\n                            "wrap": true\n                        },\n                        {\n                            "type": "TextBlock",\n                            "spacing": "None",\n                            "text": "Created {{DATE({createdUtc},SHORT)}}",\n                            "isSubtle": true,\n                            "wrap": true\n                        }\n                    ],\n                    "width": "stretch"\n                }\n            ]\n        },\n        {\n            "type": "TextBlock",\n            "text": "{description}",\n            "wrap": true\n        },\n        {\n            "type": "FactSet",\n            "facts": [\n                {\n                    "$data": "{properties}",\n                    "title": "{key}:",\n                    "value": "{value}"\n                }\n            ]\n        }\n    ],\n    "actions": [\n        {\n            "type": "Action.ShowCard",\n            "title": "Set due date",\n            "card": {\n                "type": "AdaptiveCard",\n                "body": [\n                    {\n                        "type": "Input.Date",\n                        "id": "dueDate"\n                    },\n                    {\n                        "type": "Input.Text",\n                        "id": "comment",\n                        "placeholder": "Add a comment",\n                        "isMultiline": true\n                    }\n                ],\n                "actions": [\n                    {\n                        "type": "Action.Submit",\n                        "title": "OK"\n                    }\n                ],\n                "$schema": "http://adaptivecards.io/schemas/adaptive-card.json"\n            }\n        },\n        {\n            "type": "Action.OpenUrl",\n            "title": "View",\n            "url": "{viewUrl}"\n        }\n    ],\n    "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n    "version": "1.0"\n}',t.defaultDataPayload='{\n    "title": "Publish Adaptive Card Schema",\n    "description": "Now that we have defined the main rules and features of the format, we need to produce a schema and publish it to GitHub. The schema will be the starting point of our reference documentation.",\n    "creator": {\n        "name": "Matt Hidinger",\n        "profileImage": "https://pbs.twimg.com/profile_images/3647943215/d7f12830b3c17a5a9e4afcc370e3a37e_400x400.jpeg"\n    },\n    "createdUtc": "2017-02-14T06:08:39Z",\n    "viewUrl": "https://adaptivecards.io",\n    "properties": [\n        { "key": "Board", "value": "Adaptive Cards" },\n        { "key": "List", "value": "Backlog" },\n        { "key": "Assigned to", "value": "Matt Hidinger" },\n        { "key": "Due date", "value": "Not set" }\n    ]\n}'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=n(31),o=function(){function e(e,t,n){this.displayName=e,this.cardPayloadUrl=t,this._cardPayloadDownloaded=!1,this._sampleDataDownloaded=!1,this.onDownloaded=null,this.sampleDataUrl=n}return e.prototype.downloadCompleted=function(){this._cardPayloadDownloaded&&this._sampleDataDownloaded&&this.onDownloaded&&this.onDownloaded(this)},e.prototype.download=function(){var e=this,t=new r.Downloader(this.cardPayloadUrl);if(t.onSuccess=function(){e._cardPayload=t.data,e._cardPayloadDownloaded=!0,e.downloadCompleted()},t.onError=function(){e._cardPayloadDownloaded=!0,e.downloadCompleted()},t.download(),i.isNullOrEmpty(this.sampleDataUrl))this._sampleDataDownloaded=!0,this.downloadCompleted();else{var n=new r.Downloader(this.sampleDataUrl);n.onSuccess=function(){e._sampleData=n.data,e._sampleDataDownloaded=!0,e.downloadCompleted()},n.onError=function(){e._sampleDataDownloaded=!0,e.downloadCompleted()},n.download()}},Object.defineProperty(e.prototype,"cardPayload",{get:function(){return this._cardPayload},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampleData",{get:function(){return this._sampleData},enumerable:!0,configurable:!0}),e}();t.CatalogueEntry=o,t.parseCatalogue=function(e){var t=null,n=[];if(null!=(t=Array.isArray(e)?e:Array.isArray(e.entries)?e.entried:null))for(var r=0,a=t;r<a.length;r++){var s=a[r];if("object"==typeof s){var l=i.getStringValue(s.displayName),c=i.getStringValue(s.cardPayloadUrl);i.isNullOrEmpty(l)||i.isNullOrEmpty(c)||n.push(new o(l,c,i.getStringValue(s.dataSampleUrl)))}}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.url=e,this.onError=null,this.onSuccess=null}return e.prototype.error=function(){this.onError&&this.onError(this)},e.prototype.success=function(){this.onSuccess&&this.onSuccess(this)},e.prototype.download=function(){var e=this,t=new XMLHttpRequest;t.onerror=function(){e.error()},t.onload=function(){e._data=t.responseText,e.success()};try{t.open("GET",this.url,!0),t.send()}catch(e){this.error()}},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();t.Downloader=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(14);!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(o=t.ToolbarElementAlignment||(t.ToolbarElementAlignment={}));var s=function(){function e(e){if(this._renderedElement=void 0,this.isVisible=!0,this.separator=!1,this.label=null,this.alignment=o.Left,!e||""===e)throw new Error("Toolbar elements must have an Id.");this.id=e}return e.prototype.internalUpdateLayout=function(){},e.prototype.updateLayout=function(){this._renderedElement&&this.internalUpdateLayout()},e.prototype.render=function(){return this._renderedElement=this.internalRender(),this.updateLayout(),this._renderedElement},Object.defineProperty(e.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),e}();t.ToolbarElement=s;var l=function(e){function t(t,n,i,r){void 0===r&&(r=null);var o=e.call(this,t)||this;return o._displayCaption=!0,o._iconClass=void 0,o._toolTip=void 0,o._isEnabled=!0,o._allowToggle=!1,o._isToggled=!1,o.caption=n,o.iconClass=i,o.onClick=r,o}return r(t,e),t.prototype.clicked=function(){this.onClick&&this.onClick(this)},t.prototype.internalUpdateLayout=function(){this.renderedElement.className="acd-toolbar-button",this.renderedElement.disabled=!this.isEnabled,this.isToggled?this.renderedElement.classList.add("acd-toolbar-button-toggled"):this.renderedElement.classList.remove("acd-toolbar-button-toggled"),this.iconClass&&this.renderedElement.classList.add(this.iconClass),this.displayCaption?this.renderedElement.innerText=this.caption:(this.renderedElement.classList.add("acd-toolbar-button-iconOnly"),this.renderedElement.innerText=""),this.renderedElement.title=this.toolTip?this.toolTip:""},t.prototype.internalRender=function(){var e=this,t=document.createElement("button");return t.onclick=function(t){e.allowToggle&&(e.isToggled=!e.isToggled),e.clicked()},t},Object.defineProperty(t.prototype,"allowToggle",{get:function(){return this._allowToggle},set:function(e){this._allowToggle=e,this._allowToggle||(this.isToggled=!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isToggled",{get:function(){return this._isToggled},set:function(e){this._isToggled=e,this.updateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caption",{get:function(){return this._caption},set:function(e){this._caption=e,this.updateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayCaption",{get:function(){return this._displayCaption},set:function(e){this._displayCaption=e,this.updateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconClass",{get:function(){return this._iconClass},set:function(e){this._iconClass=e,this.updateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toolTip",{get:function(){return this._toolTip},set:function(e){this._toolTip=e,this.updateLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},set:function(e){this._isEnabled=e,this.updateLayout()},enumerable:!0,configurable:!0}),t}(s);t.ToolbarButton=l;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.choices=[],t.width=null,t}return r(t,e),t.prototype.internalRender=function(){var e=this;this._dropDown=new a.DropDown;for(var t=0,n=this.choices;t<n.length;t++){var i=n[t],r=new a.DropDownItem(i.value,i.name);this._dropDown.items.add(r)}this._dropDown.selectedIndex=0,this._dropDown.onValueChanged=function(t){e.onChanged&&e.onChanged(e)};var o=document.createElement("div");this.width&&this.width>0&&(o.style.width=this.width+"px"),this._dropDown.attach(o);var s=document.createElement("div");if(s.className="acd-toolbar-choicePicker",s.style.display="flex",s.style.alignItems="center",this.label){var l=document.createElement("span");l.className="acd-toolbar-label",l.innerText=this.label,s.appendChild(l)}return s.appendChild(o),s},Object.defineProperty(t.prototype,"value",{get:function(){return this._dropDown.value.key},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._dropDown.selectedIndex},set:function(e){this._dropDown.selectedIndex=e},enumerable:!0,configurable:!0}),t}(s);t.ToolbarChoicePicker=c;var u=function(){function e(){this._elements=[]}return e.prototype.createSeparatorElement=function(){var e=document.createElement("div");return e.className="acd-toolbar-separator",e},e.prototype.renderElementsInto=function(e,t,n){for(var i=0;i<t.length;i++)t[i].separator&&n==o.Left&&i>0&&e.appendChild(this.createSeparatorElement()),e.appendChild(t[i].render()),t[i].separator&&n==o.Right&&i<t.length-1&&e.appendChild(this.createSeparatorElement())},e.prototype.attachTo=function(e){this._attachedTo=e,this._attachedTo.className="acd-toolbar",this._attachedTo.style.display="flex",this._attachedTo.style.justifyContent="space-between",this._attachedTo.innerHTML="";for(var t=[],n=[],i=0,r=this._elements;i<r.length;i++){var a=r[i];a.isVisible&&(a.alignment==o.Left?t.push(a):n.push(a))}var s=document.createElement("div");s.style.display="flex",s.style.alignItems="center";var l=document.createElement("div");l.style.display="flex",l.style.alignItems="center",this.renderElementsInto(s,t,o.Left),this.renderElementsInto(l,n,o.Right),this._attachedTo.appendChild(s),this._attachedTo.appendChild(l)},e.prototype.addElement=function(e){this._elements.push(e)},e.prototype.getElementById=function(e){for(var t=0,n=this._elements;t<n.length;t++){var i=n[t];if(i.id==e)return i}return null},e.prototype.insertElementAfter=function(e,t){for(var n=0;n<this._elements.length;n++)if(this._elements[n].id==t)return void this._elements.splice(n+1,0,e);this._elements.push(e)},e.prototype.insertElementBefore=function(e,t){for(var n=this._elements.length-1;n>=0;n--)if(this._elements[n].id==t)return void this._elements.splice(n,0,e);this._elements.splice(0,0,e)},e}();t.Toolbar=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(9),a=n(0),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=document.createElement("div");e.className="acd-palette-item",e.style.display="flex";var t=document.createElement("div");t.classList.add("acd-icon","acd-toolPalette-icon",this.getIconClass()),t.style.flex="0 0 auto";var n=document.createElement("div");return n.className="acd-palette-item-label",n.style.flex="1 1 100%",n.innerText=this.getText(),e.appendChild(t),e.appendChild(n),e},t.prototype.renderDragVisual=function(){return this.internalRender()},t}(n(6).DraggableElement);t.BasePaletteItem=s;var l=function(e){function t(t,n){var i=e.call(this)||this;return i.typeRegistration=t,i.peerRegistration=n,i}return r(t,e),t.prototype.getText=function(){return this.typeRegistration.typeName},t.prototype.getIconClass=function(){return this.peerRegistration.iconClass},t.prototype.createPeer=function(e){var t=o.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(e,null,this.typeRegistration.createInstance());return t.initializeCardElement(),t},t}(s);t.ElementPaletteItem=l;var c=function(e){function t(t){var n=e.call(this)||this;return n.field=t,n}return r(t,e),t.prototype.getText=function(){return this.field.name},t.prototype.getIconClass=function(){return null},t.prototype.createPeer=function(e){var t;if(this.field.isCollection)(t=new a.Container).setCustomProperty("$data","{"+this.field.getPath()+"}");else{var n=new a.TextBlock;n.text="{"+this.field.getPath()+"}",t=n}var i=o.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(e,null,t);return i.initializeCardElement(),i},t}(s);t.DataPaletteItem=c;var u=function(e){function t(t){var n=e.call(this)||this;return n.category=t,n}return r(t,e),t.prototype.getIconClass=function(){return"acd-icon-customPaletteItem"},t}(s);t.CustomPaletteItem=u;var p=function(e){function t(t,n){var i=e.call(this,t)||this;return i.name=n,i}return r(t,e),t.prototype.getText=function(){return this.name},t.prototype.createPeer=function(e){if(this.snippet){var t=this.snippet.type;if(t){var n=a.AdaptiveCard.elementTypeRegistry.createInstance(t);if(n){n.parse(this.snippet);var i=o.CardDesignerSurface.cardElementPeerRegistry.createPeerInstance(e,null,n);return i.initializeCardElement(),i}}}},t}(u);t.SnippetPaletteItem=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(35),o=n(17),a=n(18);!function(e){e[e.Top=0]="Top",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom",e[e.Left=3]="Left"}(i=t.SidePanelAlignment||(t.SidePanelAlignment={}));var s=function(){function e(e){var t=this;this.toolbox=e,e.onToggled=function(e){e.isExpanded?(t.showSplitter(),t.toolbox.renderedElement.classList.remove("acd-hidden")):(t.hideSplitter(),t.toolbox.renderedElement.classList.add("acd-hidden")),t.onToggled&&t.onToggled(t)}}return e.prototype.resizeEnded=function(){this.onResizeEnded&&this.onResizeEnded(this)},e.prototype.resized=function(){this.onResized&&this.onResized(this)},e.prototype.showSplitter=function(){this.splitter&&this.splitter.attachedTo.classList.remove("acd-hidden")},e.prototype.hideSplitter=function(){this.splitter&&this.splitter.attachedTo.classList.add("acd-hidden")},Object.defineProperty(e.prototype,"splitter",{get:function(){return this._splitter},set:function(e){var t=this;this._splitter=e,this._splitter.onResizeEnded=function(e){t.resizeEnded()},this._splitter.onResized=function(e){t.resized()}},enumerable:!0,configurable:!0}),e}(),l=function(){function e(e,t,n){this._toolboxes=[],this._isRestoring=!1,this.isResizable=!0,this.id=e,this._alignment=t,this._collapsedTabContainer=n}return e.prototype.updateLayout=function(){for(var e=0,t=0,n=this._toolboxes;t<n.length;t++){var i=n[t];i.toolbox.isExpanded&&(1==++e?(i.hideSplitter(),i.toolbox.stretch=!0):(i.showSplitter(),i.toolbox.stretch=!1))}e>0?this._attachedTo.classList.remove("acd-hidden"):this._attachedTo.classList.add("acd-hidden")},e.prototype.computeToolboxSize=function(e){var t=this._attachedTo.getBoundingClientRect(),n=e.renderedElement.getBoundingClientRect();this.isVertical?e.renderedElement.style.height=100/t.height*n.height+"%":e.renderedElement.style.width=100/t.width*n.width+"%"},e.prototype.resized=function(){this.onResized&&this.onResized(this),this.saveState()},e.prototype.toolboxResized=function(e){this.onToolboxResized&&this.onToolboxResized(this,e),this.saveState()},e.prototype.toolboxExpandedOrCollapsed=function(e){this.onToolboxExpandedOrCollapsed&&this.onToolboxExpandedOrCollapsed(this,e),this.saveState()},e.prototype.getDimensionSettingName=function(){return this.id+(this.isVertical?"Height":"Width")},Object.defineProperty(e.prototype,"isVertical",{get:function(){return this._alignment==i.Right||this._alignment==i.Left},enumerable:!0,configurable:!0}),e.prototype.addToolbox=function(e){var t=this,n=new s(e);n.onToggled=function(e){t.updateLayout(),t.toolboxExpandedOrCollapsed(n.toolbox)},n.onResizeEnded=function(e){t.computeToolboxSize(e.toolbox),t.toolboxResized(e.toolbox)},n.onResized=function(e){t.toolboxResized(e.toolbox)},this._toolboxes.push(n)},e.prototype.attachTo=function(e){var t=this;this._attachedTo=e,this._contentHost=document.createElement("div"),this._contentHost.style.display="flex",this._contentHost.style.overflow="hidden",this._contentHost.style.flex="1 1 auto",this.isVertical?this._contentHost.style.flexDirection="column":this._contentHost.style.flexDirection="row";for(var n=0;n<this._toolboxes.length;n++){var a=this._toolboxes[n];if(a.toolbox.render(this.isVertical?o.ToolboxOrientation.Vertical:o.ToolboxOrientation.Horizontal,this._collapsedTabContainer),n>0){var s=document.createElement("div");this.isVertical?(s.className="acd-horizontal-splitter",a.toolbox.renderedElement.style.height=100/this._toolboxes.length+"%"):(s.className="acd-vertical-splitter",a.toolbox.renderedElement.style.width=100/this._toolboxes.length+"%"),this._contentHost.appendChild(s),a.splitter=new r.Splitter(s,a.toolbox.renderedElement,!this.isVertical)}this._contentHost.appendChild(a.toolbox.renderedElement)}var l=null;this.isResizable&&((l=document.createElement("div")).className=this.isVertical?"acd-vertical-splitter":"acd-horizontal-splitter",new r.Splitter(l,this._attachedTo,this.isVertical,this._alignment==i.Left||this._alignment==i.Top).onResized=function(e){t.resized()});this._attachedTo.innerHTML="",this._attachedTo.style.display="flex",this.isVertical?(this.size&&(this._attachedTo.style.width=this.size+"px"),this._attachedTo.style.flexDirection="row",this._attachedTo.style.overflowX="hidden"):(this.size&&(this._attachedTo.style.height=this.size+"px"),this._attachedTo.style.flexDirection="column",this._attachedTo.style.overflowY="hidden"),this._alignment==i.Right||this._alignment==i.Bottom?(l&&this._attachedTo.appendChild(l),this._attachedTo.appendChild(this._contentHost)):(this._attachedTo.append(this._contentHost),l&&this._attachedTo.appendChild(l)),this.restoreState(),this.updateLayout()},e.prototype.saveState=function(){if(!this._isRestoring){a.SettingsManager.trySaveSetting(this.getDimensionSettingName(),this.isVertical?this._attachedTo.style.width:this._attachedTo.style.height);for(var e=0,t=this._toolboxes;e<t.length;e++){t[e].toolbox.saveState()}}},e.prototype.restoreState=function(){if(this._attachedTo&&!this._isRestoring){this._isRestoring=!0;try{var e=a.SettingsManager.tryLoadStringSetting(this.getDimensionSettingName());e.succeeded&&null!=e.value&&""!=e.value&&(this.isVertical?this._attachedTo.style.width=e.value:this._attachedTo.style.height=e.value);for(var t=0,n=this._toolboxes;t<n.length;t++){n[t].toolbox.restoreState()}this.updateLayout(),this.resized()}finally{this._isRestoring=!1}}},Object.defineProperty(e.prototype,"contentHost",{get:function(){return this._contentHost},enumerable:!0,configurable:!0}),e}();t.SidePanel=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,i,r){var o=this;void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=140),this._isVertical=!1,this._isAttachedAfter=!1,this.minimum=50,this.attachedTo=e,this._sizedELement=t,this._isVertical=n,this._isAttachedAfter=i,this.minimum=r,this.attachedTo.onmousedown=function(e){e.preventDefault()},this.attachedTo.onpointerdown=function(e){o.pointerDown(e)},this.attachedTo.onpointermove=function(e){o.pointerMove(e)},this.attachedTo.onpointerup=function(e){o.pointerUp(e)}}return e.prototype.resizeEnded=function(){this.onResizeEnded&&this.onResizeEnded(this)},e.prototype.pointerDown=function(e){e.preventDefault(),this.attachedTo.setPointerCapture(e.pointerId),this._lastClickedOffset={x:e.x,y:e.y},this._isPointerDown=!0},e.prototype.pointerMove=function(e){if(this._isPointerDown){e.preventDefault();var t=!1,n=void 0;this._isVertical?(n=this._isAttachedAfter?this._sizedELement.getBoundingClientRect().width-(this._lastClickedOffset.x-e.x):this._sizedELement.getBoundingClientRect().width-(e.x-this._lastClickedOffset.x))>=this.minimum&&(this._sizedELement.style.width=n+"px",t=!0):(n=this._isAttachedAfter?this._sizedELement.getBoundingClientRect().height-(this._lastClickedOffset.y-e.y):this._sizedELement.getBoundingClientRect().height-(e.y-this._lastClickedOffset.y))>=this.minimum&&(this._sizedELement.style.height=n+"px",t=!0),t&&(this.onResized&&this.onResized(this),this._lastClickedOffset={x:e.x,y:e.y})}},e.prototype.pointerUp=function(e){e.preventDefault(),this.attachedTo.releasePointerCapture(e.pointerId),this.resizeEnded(),this._isPointerDown=!1},e}();t.Splitter=i},function(e,t,n){"use strict";var i,r,o=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Number=2]="Number"}(r=t.ValueKind||(t.ValueKind={}));var a=function(){function e(e){this.owner=e}return e.create=function(e,t){if("string"==typeof t)return new s(e,r.String);if("boolean"==typeof t)return new s(e,r.Boolean);if("number"==typeof t)return new s(e,r.Number);if("object"==typeof t)return Array.isArray(t)?l.create(e,t):c.create(e,t);throw new Error("Unsupported data type: "+typeof t)},e.prototype.getChildFields=function(){return null},e.prototype.qualifyFieldName=function(e,t){return e},Object.defineProperty(e.prototype,"isCollection",{get:function(){return!1},enumerable:!0,configurable:!0}),e}();t.DataType=a;var s=function(e){function t(t,n){var i=e.call(this,t)||this;return i.owner=t,i.valueKind=n,i}return o(t,e),Object.defineProperty(t.prototype,"typeName",{get:function(){return r[this.valueKind]},enumerable:!0,configurable:!0}),t}(a);t.ValueData=s;var l=function(e){function t(t){var n=e.call(this,t)||this;return n.owner=t,n.dataType=void 0,n}return o(t,e),t.create=function(e,n){if(!Array.isArray(n))throw new Error("Input is not an array.");var i=new t(e);return n.length>0&&(i.dataType=a.create(e,n[0])),i},t.prototype.getChildFields=function(){return this.dataType.getChildFields()},t.prototype.qualifyFieldName=function(t,n){return n?e.prototype.qualifyFieldName.call(this,t,n):t+"[0]"},Object.defineProperty(t.prototype,"isCollection",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"typeName",{get:function(){return"Array"},enumerable:!0,configurable:!0}),t}(a);t.ArrayData=l;var c=function(e){function t(t){var n=e.call(this,t)||this;return n.owner=t,n.fields=[],n}return o(t,e),t.create=function(e,n){for(var i=new t(e),r=0,o=Object.keys(n);r<o.length;r++){var s=o[r],l=new u(e);l.dataType=a.create(l,n[s]),l.name=s,i.fields.push(l)}return i},t.prototype.getChildFields=function(){return this.fields},Object.defineProperty(t.prototype,"typeName",{get:function(){return"Object"},enumerable:!0,configurable:!0}),t}(a);t.ObjectData=c;var u=function(){function e(e){this.parent=e}return e.create=function(t){var n=new e(null);return n.name="$root",n.dataType=a.create(n,t),n},e.prototype.getPath=function(e){void 0===e&&(e=!0);for(var t=this.qualifiedName(e),n=this.parent;n;)t=n.qualifiedName(!1)+"."+t,n=n.parent;return t},e.prototype.qualifiedName=function(e){return this.dataType.qualifyFieldName(this.name,e)},Object.defineProperty(e.prototype,"children",{get:function(){return this.dataType.getChildFields()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCollection",{get:function(){return this.dataType.isCollection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeName",{get:function(){return this.dataType.typeName},enumerable:!0,configurable:!0}),e}();t.FieldDefinition=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o,a=n(4),s=n(7),l=n(13),c=n(19),u=n(38);function p(e,t){e&&e.setCollection(t)}function d(e,t){if(t)for(var n=0;n<t.length;n++)if(e.getJsonTypeName()===t[n])return!1;return!0}function h(e,t,n,i,r,a,s){var c=null;if(t&&"object"==typeof t){var u=!1,p=l.getStringValue(t.type);if(n&&n.indexOf(p)>=0)le(a(p,o.ForbiddenType),s);else if((c=r(p))?(c.setParent(e),c.parse(t,s),u=c.shouldFallback()&&i):(u=i,le(a(p,o.UnknownType),s)),u){var d=t.fallback;d||e.setShouldFallback(!0),"string"==typeof d&&"drop"===d.toLowerCase()?c=null:"object"==typeof d&&(c=h(e,d,n,!0,r,a,s))}}return c}function f(e,t,n,i,r){return h(e,t,n,i,function(e){return he.actionTypeRegistry.createInstance(e)},function(e,t){return t==o.UnknownType?{error:a.ValidationError.UnknownActionType,message:"Unknown action type: "+e+". Fallback will be used if present."}:{error:a.ValidationError.ActionTypeNotAllowed,message:"Action type "+e+" is not allowed in this context."}},r)}function m(e,t,n,i){return h(e,t,[],n,function(e){return he.elementTypeRegistry.createInstance(e)},function(e,t){return t==o.UnknownType?{error:a.ValidationError.UnknownElementType,message:"Unknown element type: "+e+". Fallback will be used if present."}:{error:a.ValidationError.ElementTypeNotAllowed,message:"Element type "+e+" is not allowed in this context."}},i)}!function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(o||(o={})),t.createActionInstance=f,t.createElementInstance=m;var g=function(){function e(){this._rawProperties={}}return e.prototype.parse=function(e,t){this._rawProperties=he.enableFullJsonRoundTrip?e:{}},e.prototype.toJSON=function(){return he.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{}},e.prototype.setCustomProperty=function(e,t){"string"==typeof t&&l.isNullOrEmpty(t)||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t},e.prototype.getCustomProperty=function(e){return this._rawProperties[e]},e}();t.SerializableObject=g;var y=function(e){this.cardObject=e,this.errors=[]};t.ValidationFailure=y;var v=function(){function e(){this.allIds={},this.failures=[]}return e.prototype.getFailureIndex=function(e){for(var t=0;t<this.failures.length;t++)if(this.failures[t].cardObject===e)return t;return-1},e.prototype.addFailure=function(e,t){var n,i=this.getFailureIndex(e);i<0?(n=new y(e),this.failures.push(n)):n=this.failures[i],n.errors.push(t)},e}();t.ValidationResults=v;var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalValidateProperties=function(e){l.isNullOrEmpty(this.id)||(e.allIds.hasOwnProperty(this.id)?(1==e.allIds[this.id]&&e.addFailure(this,{error:a.ValidationError.DuplicateId,message:"Duplicate Id: "+this.id}),e.allIds[this.id]+=1):e.allIds[this.id]=1)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.id=l.getStringValue(t.id)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"type",this.getJsonTypeName()),l.setProperty(t,"id",this.id),t},t.prototype.validateProperties=function(){var e=new v;return this.internalValidateProperties(e),e},t}(g);t.CardObject=b;var _=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldFallback=!1,t._lang=void 0,t._hostConfig=null,t._parent=null,t._renderedElement=null,t._separatorElement=null,t._isVisible=!0,t._truncatedDueToOverflow=!1,t._defaultRenderedElementDisplayMode=null,t._padding=null,t.requires=new c.HostCapabilities,t.horizontalAlignment=null,t.spacing=a.Spacing.Default,t.separator=!1,t.customCssSelector=null,t.height="auto",t.minPixelHeight=null,t}return r(t,e),t.prototype.internalRenderSeparator=function(){var e=l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:null,lineColor:this.separator?this.hostConfig.separator.lineColor:null},this.separatorOrientation);if(he.alwaysBleedSeparators&&e&&this.separatorOrientation==a.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px",e.style.marginRight="-"+n.right+"px"}}return e},t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(this._renderedElement.style.display=e),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":this._separatorElement.style.display=e)},t.prototype.hideElementDueToOverflow=function(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,se(this,!1))},t.prototype.showElementHiddenDueToOverflow=function(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.visibility=null,this.isVisible=!0,se(this,!1))},t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow,t?t&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}},t.prototype.resetOverflow=function(){var e=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,e=!0),this.isHiddenDueToOverflow&&this.showElementHiddenDueToOverflow(),e},t.prototype.createPlaceholderElement=function(){var e=document.createElement("div");return e.style.border="1px dashed #DDDDDD",e.style.padding="4px",e.style.minHeight="32px",e.style.fontSize="10px",e.innerText="Empty "+this.getJsonTypeName(),e},t.prototype.adjustRenderedElementSize=function(e){"auto"===this.height?e.style.flex="0 0 auto":e.style.flex="1 1 auto",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")},t.prototype.overrideInternalRender=function(){return this.internalRender()},t.prototype.applyPadding=function(){if(this.separatorElement)if(he.alwaysBleedSeparators&&this.separatorOrientation==a.Orientation.Horizontal&&!this.isBleeding()){var e=new s.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"},t.prototype.truncateOverflow=function(e){return!1},t.prototype.undoOverflowTruncation=function(){},t.prototype.getDefaultPadding=function(){return new s.PaddingDefinition},t.prototype.getHasBackground=function(){return!1},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e},Object.defineProperty(t.prototype,"supportsMinHeight",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomPadding",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return a.Orientation.Horizontal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return a.ContainerStyle.Default},enumerable:!0,configurable:!0}),t.prototype.asString=function(){return""},t.prototype.isBleeding=function(){return!1},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"isVisible",this.isVisible,!0),null!==this.horizontalAlignment&&l.setEnumProperty(a.HorizontalAlignment,t,"horizontalAlignment",this.horizontalAlignment),l.setEnumProperty(a.Spacing,t,"spacing",this.spacing,a.Spacing.Default),l.setProperty(t,"separator",this.separator,!1),l.setProperty(t,"height",this.height,"auto"),this.supportsMinHeight&&l.setProperty(t,"minHeight","number"!=typeof this.minPixelHeight||isNaN(this.minPixelHeight)?void 0:this.minPixelHeight+"px"),t},t.prototype.setParent=function(e){this._parent=e},t.prototype.getEffectiveStyle=function(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle},t.prototype.getForbiddenElementTypes=function(){return null},t.prototype.getForbiddenActionTypes=function(){return null},t.prototype.getImmediateSurroundingPadding=function(e,t,n,i,r){if(void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===i&&(i=!0),void 0===r&&(r=!0),this.parent){var o=t&&this.parent.isTopElement(this),s=n&&this.parent.isRightMostElement(this),l=i&&this.parent.isBottomElement(this),c=r&&this.parent.isLeftMostElement(this),u=this.parent.getEffectivePadding();u&&(o&&u.top!=a.Spacing.None&&(e.top=u.top,o=!1),s&&u.right!=a.Spacing.None&&(e.right=u.right,s=!1),l&&u.bottom!=a.Spacing.None&&(e.bottom=u.bottom,l=!1),c&&u.left!=a.Spacing.None&&(e.left=u.left,c=!1)),(o||s||l||c)&&this.parent.getImmediateSurroundingPadding(e,o,s,l,c)}},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),function(e,t,n){var i=e.getRootElement(),r=i&&i.onParseElement?i.onParseElement:he.onParseElement;null!=r&&r(e,t,n)}(this,t,n),this.requires.parse(t.requires,n),this.isVisible=l.getBoolValue(t.isVisible,this.isVisible),this.horizontalAlignment=l.getEnumValue(a.HorizontalAlignment,t.horizontalAlignment,this.horizontalAlignment),this.spacing=l.getEnumValue(a.Spacing,t.spacing,a.Spacing.Default),this.separator=l.getBoolValue(t.separator,this.separator);var i=t.separation;void 0!==i&&("none"===i?(this.spacing=a.Spacing.None,this.separator=!1):"strong"===i?(this.spacing=a.Spacing.Large,this.separator=!0):"default"===i&&(this.spacing=a.Spacing.Default,this.separator=!1),le({error:a.ValidationError.Deprecated,message:'The "separation" property is deprecated and will be removed. Use the "spacing" and "separator" properties instead.'},n));var r=t.height;if("auto"!==r&&"stretch"!==r||(this.height=r),this.supportsMinHeight){var o=t.minHeight;if(o&&"string"==typeof o){var c=!1;try{var u=s.SizeAndUnit.parse(o,!0);u.unit==a.SizeUnit.Pixel&&(this.minPixelHeight=u.physicalSize,c=!0)}catch(e){}c||le({error:a.ValidationError.InvalidPropertyValue,message:'Invalid "minHeight" value: '+o},n)}}else this.minPixelHeight=null},t.prototype.getActionCount=function(){return 0},t.prototype.getActionAt=function(e){throw new Error("Index out of range.")},t.prototype.remove=function(){return!!(this.parent&&this.parent instanceof I)&&this.parent.removeItem(this)},t.prototype.render=function(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement},t.prototype.updateLayout=function(e){void 0===e&&(e=!0),this.updateRenderedElementVisibility(),this.applyPadding()},t.prototype.indexOf=function(e){return-1},t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof he&&e.designMode},t.prototype.isRendered=function(){return this._renderedElement&&this._renderedElement.offsetHeight>0},t.prototype.isFirstElement=function(e){return!0},t.prototype.isLastElement=function(e){return!0},t.prototype.isAtTheVeryLeft=function(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()},t.prototype.isAtTheVeryRight=function(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()},t.prototype.isAtTheVeryTop=function(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()},t.prototype.isAtTheVeryBottom=function(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()},t.prototype.isBleedingAtTop=function(){return!1},t.prototype.isBleedingAtBottom=function(){return!1},t.prototype.isLeftMostElement=function(e){return!0},t.prototype.isRightMostElement=function(e){return!0},t.prototype.isTopElement=function(e){return this.isFirstElement(e)},t.prototype.isBottomElement=function(e){return this.isLastElement(e)},t.prototype.isHiddenDueToOverflow=function(){return this._renderedElement&&"hidden"==this._renderedElement.style.visibility},t.prototype.getRootElement=function(){for(var e=this;e.parent;)e=e.parent;return e},t.prototype.getParentContainer=function(){for(var e=this.parent;e;){if(e instanceof te)return e;e=e.parent}return null},t.prototype.getAllInputs=function(){return[]},t.prototype.getResourceInformation=function(){return[]},t.prototype.getElementById=function(e){return this.id===e?this:null},t.prototype.getActionById=function(e){return null},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)},t.prototype.setShouldFallback=function(e){this._shouldFallback=e},t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e&&this.allowCustomPadding?e:this.getDefaultPadding()},Object.defineProperty(t.prototype,"lang",{get:function(){return this._lang?this._lang:this.parent?this.parent.lang:void 0},set:function(e){if(e&&""!=e){if(!/^[a-z]{2,3}$/gi.exec(e))throw new Error("Invalid language identifier: "+e)}this._lang=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:me},set:function(e){this._hostConfig=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.parent?this.parent.indexOf(this):0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},set:function(e){he.useAdvancedCardBottomTruncation&&!e&&this.undoOverflowTruncation(),this._isVisible!=e&&(this._isVisible=e,this.updateRenderedElementVisibility(),this._renderedElement&&se(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:!0,configurable:!0}),t}(b);t.CardElement=_;var C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectAction=null,t.size=a.TextSize.Default,t.weight=a.TextWeight.Default,t.color=a.TextColor.Default,t.isSubtle=!1,t.fontType=null,t}return r(t,e),t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())},t.prototype.getFontSize=function(e){switch(this.size){case a.TextSize.Small:return e.fontSizes.small;case a.TextSize.Medium:return e.fontSizes.medium;case a.TextSize.Large:return e.fontSizes.large;case a.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}},t.prototype.getColorDefinition=function(e,t){switch(t){case a.TextColor.Accent:return e.accent;case a.TextColor.Dark:return e.dark;case a.TextColor.Light:return e.light;case a.TextColor.Good:return e.good;case a.TextColor.Warning:return e.warning;case a.TextColor.Attention:return e.attention;default:return e.default}},t.prototype.setText=function(e){this._text=e},t.prototype.asString=function(){return this.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setEnumProperty(a.TextSize,t,"size",this.size,a.TextSize.Default),l.setEnumProperty(a.TextWeight,t,"weight",this.weight,a.TextWeight.Default),l.setEnumProperty(a.TextColor,t,"color",this.color,a.TextColor.Default),l.setProperty(t,"text",this.text),l.setProperty(t,"isSubtle",this.isSubtle,!1),l.setEnumProperty(a.FontType,t,"fontType",this.fontType,a.FontType.Default),t},t.prototype.applyStylesTo=function(e){var t,n=this.hostConfig.getFontTypeDefinition(this.fontType);switch(n.fontFamily&&(e.style.fontFamily=n.fontFamily),this.size){case a.TextSize.Small:t=n.fontSizes.small;break;case a.TextSize.Medium:t=n.fontSizes.medium;break;case a.TextSize.Large:t=n.fontSizes.large;break;case a.TextSize.ExtraLarge:t=n.fontSizes.extraLarge;break;default:t=n.fontSizes.default}e.style.fontSize=t+"px";var i,r=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);switch(e.style.color=l.stringToCssColor(this.isSubtle?r.subtle:r.default),this.weight){case a.TextWeight.Lighter:i=n.fontWeights.lighter;break;case a.TextWeight.Bolder:i=n.fontWeights.bolder;break;default:i=n.fontWeights.default}e.style.fontWeight=i.toString()},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.text=l.getStringValue(t.text);var i=l.getStringValue(t.size);i&&"normal"===i.toLowerCase()?(this.size=a.TextSize.Default,le({error:a.ValidationError.Deprecated,message:'The TextBlock.size value "normal" is deprecated and will be removed. Use "default" instead.'},n)):this.size=l.getEnumValue(a.TextSize,i,this.size);var r=l.getStringValue(t.weight);r&&"normal"===r.toLowerCase()?(this.weight=a.TextWeight.Default,le({error:a.ValidationError.Deprecated,message:'The TextBlock.weight value "normal" is deprecated and will be removed. Use "default" instead.'},n)):this.weight=l.getEnumValue(a.TextWeight,r,this.weight),this.color=l.getEnumValue(a.TextColor,t.color,this.color),this.isSubtle=l.getBoolValue(t.isSubtle,this.isSubtle),this.fontType=l.getEnumValue(a.FontType,t.fontType,this.fontType)},Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return this.color?this.color:a.TextColor.Default},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){this.setText(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),t}(_);t.BaseTextBlock=C;var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._processedText=null,t._treatAsPlainText=!0,t.wrap=!1,t.useMarkdown=!0,t}return r(t,e),t.prototype.restoreOriginalContent=function(){var e=this.maxLines?this._computedLineHeight*this.maxLines+"px":null;this.renderedElement.style.maxHeight=e,this.renderedElement.innerHTML=this._originalInnerHtml},t.prototype.truncateIfSupported=function(e){var t=this.renderedElement.children,n=!t.length;if(n||1==t.length&&"p"==t[0].tagName.toLowerCase()){var i=n?this.renderedElement:t[0];return l.truncate(i,e,this._computedLineHeight),!0}return!1},t.prototype.setText=function(t){e.prototype.setText.call(this,t),this._processedText=null},t.prototype.getRenderedDomElementType=function(){return"div"},t.prototype.internalRender=function(){var e=this;if(this._processedText=null,l.isNullOrEmpty(this.text))return null;var t=this.hostConfig,n=document.createElement(this.getRenderedDomElementType());if(n.classList.add(t.makeCssClassName("ac-textBlock")),n.style.overflow="hidden",this.applyStylesTo(n),this.selectAction&&(n.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute()},t.supportsInteractivity&&(n.tabIndex=0,n.setAttribute("role","button"),n.setAttribute("aria-label",this.selectAction.title),n.classList.add(t.makeCssClassName("ac-selectable")))),!this._processedText){this._treatAsPlainText=!0;var i=u.formatText(this.lang,this.text);if(this.useMarkdown){he.allowMarkForTextHighlighting&&(i=i.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/=="));var r=he.applyMarkdown(i);if(r.didProcess&&r.outputHtml){if(this._processedText=r.outputHtml,this._treatAsPlainText=!1,he.allowMarkForTextHighlighting){var o="",a=this.getEffectiveStyleDefinition();a.highlightBackgroundColor&&(o+="background-color: "+a.highlightBackgroundColor+";"),a.highlightForegroundColor&&(o+="color: "+a.highlightForegroundColor+";"),l.isNullOrEmpty(o)||(o='style="'+o+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+o+">").replace(/\/==/g,"</mark>")}}else this._processedText=i,this._treatAsPlainText=!0}else this._processedText=i,this._treatAsPlainText=!0}if(this._treatAsPlainText?n.innerText=this._processedText:n.innerHTML=this._processedText,n.firstElementChild instanceof HTMLElement){var s=n.firstElementChild;s.style.marginTop="0px",s.style.width="100%",this.wrap||(s.style.overflow="hidden",s.style.textOverflow="ellipsis")}n.lastElementChild instanceof HTMLElement&&(n.lastElementChild.style.marginBottom="0px");for(var c=n.getElementsByTagName("a"),p=0;p<c.length;p++){var d=c[p];d.classList.add(t.makeCssClassName("ac-anchor")),d.target="_blank",d.onclick=function(t){oe(e,t.target)&&(t.preventDefault(),t.cancelBubble=!0)}}return this.wrap?(n.style.wordWrap="break-word",this.maxLines>0&&(n.style.maxHeight=this._computedLineHeight*this.maxLines+"px",n.style.overflow="hidden")):(n.style.whiteSpace="nowrap",n.style.textOverflow="ellipsis"),(he.useAdvancedTextBlockTruncation||he.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=n.innerHTML),n},t.prototype.truncateOverflow=function(e){return e>=this._computedLineHeight&&this.truncateIfSupported(e)},t.prototype.undoOverflowTruncation=function(){if(this.restoreOriginalContent(),he.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"wrap",this.wrap,!1),l.setNumberProperty(t,"maxLines",this.maxLines),t},t.prototype.applyStylesTo=function(t){e.prototype.applyStylesTo.call(this,t);var n=this.getParentContainer(),i=!!n&&n.isRtl();switch(this.horizontalAlignment){case a.HorizontalAlignment.Center:t.style.textAlign="center";break;case a.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left"}var r=this.hostConfig.lineHeights;if(r)switch(this.size){case a.TextSize.Small:this._computedLineHeight=r.small;break;case a.TextSize.Medium:this._computedLineHeight=r.medium;break;case a.TextSize.Large:this._computedLineHeight=r.large;break;case a.TextSize.ExtraLarge:this._computedLineHeight=r.extraLarge;break;default:this._computedLineHeight=r.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType));t.style.lineHeight=this._computedLineHeight+"px"},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.wrap=l.getBoolValue(t.wrap,this.wrap),this.maxLines=l.getNumberValue(t.maxLines)},t.prototype.getJsonTypeName=function(){return"TextBlock"},t.prototype.updateLayout=function(t){void 0===t&&(t=!1),e.prototype.updateLayout.call(this,t),he.useAdvancedTextBlockTruncation&&this.maxLines&&this.isRendered()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))},t}(C);t.TextBlock=E;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getRenderedDomElementType=function(){return"label"},t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);return t&&!l.isNullOrEmpty(this.forElementId)&&(t.htmlFor=this.forElementId),t},t}(E),x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.italic=!1,t.strikethrough=!1,t.highlight=!1,t}return r(t,e),t.prototype.internalRender=function(){var e=this;if(l.isNullOrEmpty(this.text))return null;var t=this.hostConfig,n=u.formatText(this.lang,this.text),i=document.createElement("span");if(i.classList.add(t.makeCssClassName("ac-textRun")),this.applyStylesTo(i),this.selectAction&&t.supportsInteractivity){var r=document.createElement("a");r.classList.add(t.makeCssClassName("ac-anchor")),r.href=this.selectAction.getHref(),r.target="_blank",r.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute()},r.innerText=n,i.appendChild(r)}else i.innerText=n;return i},t.prototype.applyStylesTo=function(t){if(e.prototype.applyStylesTo.call(this,t),this.italic&&(t.style.fontStyle="italic"),this.strikethrough&&(t.style.textDecoration="line-through"),this.highlight){var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);t.style.backgroundColor=l.stringToCssColor(this.isSubtle?n.highlightColors.subtle:n.highlightColors.default)}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"italic",this.italic,!1),l.setProperty(t,"strikethrough",this.strikethrough,!1),l.setProperty(t,"highlight",this.highlight,!1),this.selectAction&&l.setProperty(t,"selectAction",this.selectAction.toJSON()),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.italic=l.getBoolValue(t.italic,this.italic),this.strikethrough=l.getBoolValue(t.strikethrough,this.strikethrough),this.highlight=l.getBoolValue(t.highlight,this.highlight),this.selectAction=f(this,t.selectAction,[K.JsonTypeName],!this.isDesignMode(),n)},t.prototype.getJsonTypeName=function(){return"TextRun"},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInline",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(C);t.TextRun=x;var P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inlines=[],t}return r(t,e),t.prototype.internalAddInline=function(e,t){if(void 0===t&&(t=!1),!e.isInline)throw new Error("RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline.");if(!(null==e.parent||t)&&e.parent!=this)throw new Error("RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock.");e.setParent(this),this._inlines.push(e)},t.prototype.internalRender=function(){if(this._inlines.length>0){var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var t=this.getParentContainer(),n=!!t&&t.isRtl();switch(this.horizontalAlignment){case a.HorizontalAlignment.Center:e.style.textAlign="center";break;case a.HorizontalAlignment.Right:e.style.textAlign=n?"left":"right";break;default:e.style.textAlign=n?"right":"left"}for(var i=0,r=0,o=this._inlines;r<o.length;r++){var s=o[r].render();s&&(e.appendChild(s),i++)}if(i>0)return e}return null},t.prototype.asString=function(){for(var e="",t=0,n=this._inlines;t<n.length;t++){e+=n[t].asString()}return e},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this._inlines=[],Array.isArray(t.inlines))for(var i=0,r=t.inlines;i<r.length;i++){var o=r[i],a=void 0;if("string"==typeof o){var s=new x;s.text=o,a=s}else a=m(this,o,!1,n);a&&this.internalAddInline(a,!0)}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);if(this._inlines.length>0){for(var n=[],i=0,r=this._inlines;i<r.length;i++){var o=r[i];n.push(o.toJSON())}l.setProperty(t,"inlines",n)}return t},t.prototype.getJsonTypeName=function(){return"RichTextBlock"},t.prototype.getInlineCount=function(){return this._inlines.length},t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error("RichTextBlock.getInlineAt: Index out of range ("+e+")")},t.prototype.addInline=function(e){this.internalAddInline(e)},t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(null),this._inlines.splice(t,1),!0)},t}(_);t.RichTextBlock=P;var w=function(e){function t(t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var i=e.call(this)||this;return i.name=t,i.value=n,i}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.name=l.getStringValue(t.title),this.value=l.getStringValue(t.value)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"title",this.name),l.setProperty(t,"value",this.value),t},t}(g);t.Fact=w;var T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.facts=[],t}return r(t,e),Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.internalRender=function(){var e=null,t=this.hostConfig;if(this.facts.length>0){(e=document.createElement("table")).style.borderWidth="0px",e.style.borderSpacing="0px",e.style.borderStyle="none",e.style.borderCollapse="collapse",e.style.display="block",e.style.overflow="hidden",e.classList.add(t.makeCssClassName("ac-factset"));for(var n=0;n<this.facts.length;n++){var i=document.createElement("tr");n>0&&(i.style.marginTop=t.factSet.spacing+"px");var r=document.createElement("td");r.style.padding="0",r.classList.add(t.makeCssClassName("ac-fact-title")),t.factSet.title.maxWidth&&(r.style.maxWidth=t.factSet.title.maxWidth+"px"),r.style.verticalAlign="top";var o=new E;o.setParent(this),o.text=l.isNullOrEmpty(this.facts[n].name)&&this.isDesignMode()?"Title":this.facts[n].name,o.size=t.factSet.title.size,o.color=t.factSet.title.color,o.isSubtle=t.factSet.title.isSubtle,o.weight=t.factSet.title.weight,o.wrap=t.factSet.title.wrap,o.spacing=a.Spacing.None,l.appendChild(r,o.render()),l.appendChild(i,r),(r=document.createElement("td")).style.width="10px",l.appendChild(i,r),(r=document.createElement("td")).style.padding="0",r.style.verticalAlign="top",r.classList.add(t.makeCssClassName("ac-fact-value")),(o=new E).setParent(this),o.text=this.facts[n].value,o.size=t.factSet.value.size,o.color=t.factSet.value.color,o.isSubtle=t.factSet.value.isSubtle,o.weight=t.factSet.value.weight,o.wrap=t.factSet.value.wrap,o.spacing=a.Spacing.None,l.appendChild(r,o.render()),l.appendChild(i,r),l.appendChild(e,i)}}return e},t.prototype.getJsonTypeName=function(){return"FactSet"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setArrayProperty(t,"facts",this.facts),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.facts=[];var i=t.facts;if(Array.isArray(i))for(var r=0,o=i;r<o.length;r++){var a=o[r],s=new w;s.parse(a),this.facts.push(s)}},t}(_);t.FactSet=T;var A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.style=a.ImageStyle.Default,t.size=a.Size.Auto,t.pixelWidth=null,t.pixelHeight=null,t.altText="",t}return r(t,e),t.prototype.parseDimension=function(e,t,n){if(t){if("string"==typeof t)try{var i=s.SizeAndUnit.parse(t);if(i.unit==a.SizeUnit.Pixel)return i.physicalSize}catch(e){}le({error:a.ValidationError.InvalidPropertyValue,message:"Invalid image "+e+": "+t},n)}return 0},t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width=this.pixelWidth+"px"),this.pixelHeight&&(e.style.height=this.pixelHeight+"px");else switch(this.size){case a.Size.Stretch:e.style.width="100%";break;case a.Size.Auto:e.style.maxWidth="100%";break;case a.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case a.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case a.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px"}},Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.internalRender=function(){var e=this,t=null;if(!l.isNullOrEmpty(this.url)){switch((t=document.createElement("div")).style.display="flex",t.style.alignItems="flex-start",t.onkeypress=function(t){!e.selectAction||13!=t.keyCode&&32!=t.keyCode||(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},t.onclick=function(t){e.selectAction&&(t.preventDefault(),t.cancelBubble=!0,e.selectAction.execute())},this.horizontalAlignment){case a.HorizontalAlignment.Center:t.style.justifyContent="center";break;case a.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}var n=this.hostConfig,i=document.createElement("img");i.onload=function(t){re(e)},i.onerror=function(t){var n=e.getRootElement();if(e.renderedElement.innerHTML="",n&&n.designMode){var i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.backgroundColor="#EEEEEE",i.style.color="black",i.innerText=":-(",i.style.padding="10px",e.applySize(i),e.renderedElement.appendChild(i)}re(e)},i.style.maxHeight="100%",i.style.minWidth="0",i.classList.add(n.makeCssClassName("ac-image")),null!=this.selectAction&&n.supportsInteractivity&&(i.tabIndex=0,i.setAttribute("role","button"),i.setAttribute("aria-label",this.selectAction.title),i.classList.add(n.makeCssClassName("ac-selectable"))),this.applySize(i),this.style===a.ImageStyle.Person&&(i.style.borderRadius="50%",i.style.backgroundPosition="50% 50%",i.style.backgroundRepeat="no-repeat"),l.isNullOrEmpty(this.backgroundColor)||(i.style.backgroundColor=l.stringToCssColor(this.backgroundColor)),i.src=this.url,i.alt=this.altText,t.appendChild(i)}return t},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return this._selectAction&&l.setProperty(t,"selectAction",this._selectAction.toJSON()),l.setEnumProperty(a.ImageStyle,t,"style",this.style,a.ImageStyle.Default),l.setProperty(t,"backgroundColor",this.backgroundColor),l.setProperty(t,"url",this.url),l.setEnumProperty(a.Size,t,"size",this.size,a.Size.Auto),this.pixelWidth&&l.setProperty(t,"width",this.pixelWidth+"px"),this.pixelHeight&&l.setProperty(t,"height",this.pixelHeight+"px"),l.setProperty(t,"altText",this.altText),t},t.prototype.getJsonTypeName=function(){return"Image"},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.selectAction&&(n=this.selectAction.getActionById(t)),n},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.url=l.getStringValue(t.url),this.backgroundColor=l.getStringValue(t.backgroundColor);var i=l.getStringValue(t.style);i&&"normal"===i.toLowerCase()?(this.style=a.ImageStyle.Default,le({error:a.ValidationError.Deprecated,message:'The Image.style value "normal" is deprecated and will be removed. Use "default" instead.'},n)):this.style=l.getEnumValue(a.ImageStyle,i,this.style),this.size=l.getEnumValue(a.Size,t.size,this.size),this.altText=l.getStringValue(t.altText),t.pixelWidth&&"number"==typeof t.pixelWidth&&(this.pixelWidth=t.pixelWidth,le({error:a.ValidationError.Deprecated,message:"The pixelWidth property is deprecated and will be removed. Use the width property instead."},n)),t.pixelHeight&&"number"==typeof t.pixelHeight&&(this.pixelHeight=t.pixelHeight,le({error:a.ValidationError.Deprecated,message:"The pixelHeight property is deprecated and will be removed. Use the height property instead."},n));var r=this.parseDimension("width",t.width,n);r>0&&(this.pixelWidth=r),(r=this.parseDimension("height",t.height,n))>0&&(this.pixelHeight=r),this.selectAction=f(this,t.selectAction,[K.JsonTypeName],!this.isDesignMode(),n)},t.prototype.getResourceInformation=function(){return l.isNullOrEmpty(this.url)?[]:[{url:this.url,mimeType:"image"}]},Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e,this._selectAction&&this._selectAction.setParent(this)},enumerable:!0,configurable:!0}),t}(_);t.Image=A;var I=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._selectAction=null,t.allowVerticalOverflow=!1,t}return r(t,e),t.prototype.isElementAllowed=function(e,t){if(!this.hostConfig.supportsInteractivity&&e.isInteractive)return!1;if(t)for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e.getJsonTypeName()===r)return!1}return!0},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new s.SpacingDefinition;this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}},t.prototype.getSelectAction=function(){return this._selectAction},t.prototype.setSelectAction=function(e){this._selectAction=e,this._selectAction&&this._selectAction.setParent(this)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.isSelectable&&(this._selectAction=f(this,t.selectAction,[K.JsonTypeName],!this.isDesignMode(),n))},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return this._selectAction&&this.isSelectable&&l.setProperty(t,"selectAction",this._selectAction.toJSON()),t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var i=this.getItemAt(n);!this.hostConfig.supportsInteractivity&&i.isInteractive&&t.addFailure(this,{error:a.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."}),this.isElementAllowed(i,this.getForbiddenElementTypes())||t.addFailure(this,{error:a.ValidationError.InteractivityNotAllowed,message:"Elements of type "+i.getJsonTypeName()+" are not allowed in this container."}),i.internalValidateProperties(t)}this._selectAction&&this._selectAction.internalValidateProperties(t)},t.prototype.render=function(){var t=this,n=e.prototype.render.call(this),i=this.hostConfig;return this.allowVerticalOverflow&&(n.style.overflowX="hidden",n.style.overflowY="auto"),n&&this.isSelectable&&this._selectAction&&i.supportsInteractivity&&(n.classList.add(i.makeCssClassName("ac-selectable")),n.tabIndex=0,n.setAttribute("role","button"),n.setAttribute("aria-label",this._selectAction.title),n.onclick=function(e){null!=t._selectAction&&(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())},n.onkeypress=function(e){null==t._selectAction||13!=e.keyCode&&32!=e.keyCode||(e.preventDefault(),e.cancelBubble=!0,t._selectAction.execute())}),n},t.prototype.updateLayout=function(t){if(void 0===t&&(t=!0),e.prototype.updateLayout.call(this,t),t)for(var n=0;n<this.getItemCount();n++)this.getItemAt(n).updateLayout()},t.prototype.getAllInputs=function(){for(var e=[],t=0;t<this.getItemCount();t++)e=e.concat(this.getItemAt(t).getAllInputs());return e},t.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.getItemCount();t++)e=e.concat(this.getItemAt(t).getResourceInformation());return e},t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n)for(var i=0;i<this.getItemCount()&&!(n=this.getItemAt(i).getElementById(t));i++);return n},t}(_);t.CardElementContainer=I;var O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._images=[],t.imageSize=a.Size.Medium,t}return r(t,e),t.prototype.internalRender=function(){var e=null;if(this._images.length>0){(e=document.createElement("div")).style.display="flex",e.style.flexWrap="wrap";for(var t=0;t<this._images.length;t++){this._images[t].size=this.imageSize;var n=this._images[t].render();n.style.display="inline-flex",n.style.margin="0px",n.style.marginRight="10px",n.style.maxHeight=this.hostConfig.imageSet.maxImageHeight+"px",l.appendChild(e,n)}}return e},t.prototype.getItemCount=function(){return this._images.length},t.prototype.getItemAt=function(e){return this._images[e]},t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:null},t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:null},t.prototype.removeItem=function(e){if(e instanceof A){var t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(null),this.updateLayout(),!0}return!1},t.prototype.getJsonTypeName=function(){return"ImageSet"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);if(l.setEnumProperty(a.Size,t,"imageSize",this.imageSize,a.Size.Medium),this._images.length>0){for(var n=[],i=0,r=this._images;i<r.length;i++){var o=r[i];n.push(o.toJSON())}l.setProperty(t,"images",n)}return t},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.imageSize=l.getEnumValue(a.Size,t.imageSize,a.Size.Medium),null!=t.images){var i=t.images;this._images=[];for(var r=0;r<i.length;r++){var o=new A;o.parse(i[r],n),this.addImage(o)}}},t.prototype.addImage=function(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)},t.prototype.indexOf=function(e){return e instanceof A?this._images.indexOf(e):-1},t}(I);t.ImageSet=O;var k=function(e){function t(t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var i=e.call(this)||this;return i.url=t,i.mimeType=n,i}return r(t,e),t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.mimeType=l.getStringValue(t.mimeType),this.url=l.getStringValue(t.url)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"mimeType",this.mimeType),l.setProperty(t,"url",this.url),t},t}(g);t.MediaSource=k;var D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sources=[],t}return r(t,e),t.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster},t.prototype.processSources=function(){this._selectedSources=[],this._selectedMediaType=void 0;for(var e=0,n=this.sources;e<n.length;e++){var i=n[e],r=i.mimeType?i.mimeType.split("/"):[];if(2==r.length){if(!this._selectedMediaType){var o=t.supportedMediaTypes.indexOf(r[0]);o>=0&&(this._selectedMediaType=t.supportedMediaTypes[o])}r[0]==this._selectedMediaType&&this._selectedSources.push(i)}}},t.prototype.renderPoster=function(){var e=this,n=document.createElement("div");n.className=this.hostConfig.makeCssClassName("ac-media-poster"),n.setAttribute("role","contentinfo"),n.setAttribute("aria-label",this.altText?this.altText:"Media content"),n.style.position="relative",n.style.display="flex";var i=this.getPosterUrl();if(i){var r=document.createElement("img");r.style.width="100%",r.style.height="100%",r.onerror=function(e){r.parentNode.removeChild(r),n.classList.add("empty"),n.style.minHeight="150px"},r.src=i,n.appendChild(r)}else n.classList.add("empty"),n.style.minHeight="150px";if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var o=document.createElement("div");o.setAttribute("role","button"),o.setAttribute("aria-label","Play media"),o.className=this.hostConfig.makeCssClassName("ac-media-playButton"),o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.onclick=function(n){if(e.hostConfig.media.allowInlinePlayback){n.preventDefault(),n.cancelBubble=!0;var i=e.renderMediaPlayer();e.renderedElement.innerHTML="",e.renderedElement.appendChild(i),i.play()}else t.onPlay&&(n.preventDefault(),n.cancelBubble=!0,t.onPlay(e))};var a=document.createElement("div");a.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),a.style.width="12px",a.style.height="15px",a.style.borderTopWidth="7.5px",a.style.borderBottomWidth="7.5px",a.style.borderLeftWidth="12px",a.style.borderRightWidth="0",a.style.borderStyle="solid",a.style.borderTopColor="transparent",a.style.borderRightColor="transparent",a.style.borderBottomColor="transparent",a.style.transform="translate(1.2px,0px)",o.appendChild(a);var s=document.createElement("div");s.style.position="absolute",s.style.left="0",s.style.top="0",s.style.width="100%",s.style.height="100%",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.appendChild(o),n.appendChild(s)}return n},t.prototype.renderMediaPlayer=function(){var e;if("video"==this._selectedMediaType){var t=document.createElement("video"),n=this.getPosterUrl();n&&(t.poster=n),e=t}else e=document.createElement("audio");e.controls=!0,e.preload="none",e.style.width="100%";for(var i=0,r=this.sources;i<r.length;i++){var o=r[i],a=document.createElement("source");a.src=o.url,a.type=o.mimeType,e.appendChild(a)}return e},t.prototype.internalRender=function(){var e=document.createElement("div");return e.className=this.hostConfig.makeCssClassName("ac-media"),this.processSources(),e.appendChild(this.renderPoster()),e},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.poster=l.getStringValue(t.poster),this.altText=l.getStringValue(t.altText),this.sources=[],Array.isArray(t.sources))for(var i=0,r=t.sources;i<r.length;i++){var o=r[i],a=new k;a.parse(o,n),this.sources.push(a)}},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"poster",this.poster),l.setProperty(t,"altText",this.altText),l.setArrayProperty(t,"sources",this.sources),t},t.prototype.getJsonTypeName=function(){return"Media"},t.prototype.getResourceInformation=function(){var e=[],t=this.getPosterUrl();l.isNullOrEmpty(t)||e.push({url:t,mimeType:"image"});for(var n=0,i=this.sources;n<i.length;n++){var r=i[n];l.isNullOrEmpty(r.url)||e.push({url:r.url,mimeType:r.mimeType})}return e},Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:!0,configurable:!0}),t.supportedMediaTypes=["audio","video"],t.onPlay=null,t}(_);t.Media=D;var V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.necessity=a.InputValidationNecessity.Optional,t.errorMessage=void 0,t}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.necessity=l.getEnumValue(a.InputValidationNecessity,t.necessity,this.necessity),this.errorMessage=l.getStringValue(t.errorMessage)},t.prototype.toJSON=function(){if(this.necessity==a.InputValidationNecessity.Optional&&l.isNullOrEmpty(this.errorMessage))return null;var t=e.prototype.toJSON.call(this);return l.setEnumProperty(a.InputValidationNecessity,t,"necessity",this.necessity,a.InputValidationNecessity.Optional),l.setProperty(t,"errorMessage",this.errorMessage),t},t}(g);t.InputValidationOptions=V;var N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.validation=new V,t}return r(t,e),Object.defineProperty(t.prototype,"isNullable",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:!0,configurable:!0}),t.prototype.overrideInternalRender=function(){var e=this.hostConfig;return this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this._outerContainerElement.style.flexDirection="column",this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex",this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement.style.minWidth="0px",he.useBuiltInInputValidation&&this.isNullable&&this.validation.necessity==a.InputValidationNecessity.RequiredWithVisualCue&&this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required")),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this._outerContainerElement},t.prototype.valueChanged=function(){var e,t,n;this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),t=(e=this).getRootElement(),(n=t&&t.onInputValueChanged?t.onInputValueChanged:he.onInputValueChanged)&&n(e)},t.prototype.resetValidationFailureCue=function(){he.useBuiltInInputValidation&&this.renderedElement&&(this._renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this._errorMessageElement&&(this._outerContainerElement.removeChild(this._errorMessageElement),this._errorMessageElement=null))},t.prototype.showValidationErrorMessage=function(){this.renderedElement&&he.useBuiltInInputValidation&&he.displayInputValidationErrors&&!l.isNullOrEmpty(this.validation.errorMessage)&&(this._errorMessageElement=document.createElement("span"),this._errorMessageElement.className=this.hostConfig.makeCssClassName("ac-input-validation-error-message"),this._errorMessageElement.textContent=this.validation.errorMessage,this._outerContainerElement.appendChild(this._errorMessageElement))},t.prototype.parseInputValue=function(e){return e},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"title",this.title),l.setProperty(t,"value",this.renderedElement&&!l.isNullOrEmpty(this.value)?this.value:this.defaultValue),he.useBuiltInInputValidation&&l.setProperty(t,"validation",this.validation.toJSON()),t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),l.isNullOrEmpty(this.id)&&t.addFailure(this,{error:a.ValidationError.PropertyCantBeNull,message:"All inputs must have a unique Id"})},t.prototype.validateValue=function(){if(he.useBuiltInInputValidation){this.resetValidationFailureCue();var e=this.validation.necessity==a.InputValidationNecessity.Optional||!l.isNullOrEmpty(this.value);return!e&&this.renderedElement&&(this._renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),e}return!0},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.id=l.getStringValue(t.id),this.defaultValue=l.getStringValue(t.value),he.useBuiltInInputValidation){var i=t.validation;i&&this.validation.parse(i)}},t.prototype.getAllInputs=function(){return[this]},Object.defineProperty(t.prototype,"defaultValue",{get:function(){return this._defaultValue},set:function(e){this._defaultValue=this.parseInputValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(_);t.Input=N;var L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isMultiline=!1,t.style=a.InputTextStyle.Text,t}return r(t,e),t.prototype.internalRender=function(){var e=this;if(this.isMultiline){var t=document.createElement("textarea");return t.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),t.style.flex="1 1 auto",t.tabIndex=0,l.isNullOrEmpty(this.placeholder)||(t.placeholder=this.placeholder,t.setAttribute("aria-label",this.placeholder)),l.isNullOrEmpty(this.defaultValue)||(t.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(t.maxLength=this.maxLength),t.oninput=function(){e.valueChanged()},t.onkeypress=function(t){10==t.keyCode&&e.inlineAction&&e.inlineAction.execute()},t}var n=document.createElement("input");return n.type=a.InputTextStyle[this.style].toLowerCase(),n.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),n.style.flex="1 1 auto",n.tabIndex=0,l.isNullOrEmpty(this.placeholder)||(n.placeholder=this.placeholder,n.setAttribute("aria-label",this.placeholder)),l.isNullOrEmpty(this.defaultValue)||(n.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(n.maxLength=this.maxLength),n.oninput=function(){e.valueChanged()},n.onkeypress=function(t){13==t.keyCode&&e.inlineAction&&e.inlineAction.execute()},n},t.prototype.overrideInternalRender=function(){var t=this,n=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var i=document.createElement("button");if(i.className=this.hostConfig.makeCssClassName("ac-inlineActionButton"),i.onclick=function(e){e.preventDefault(),e.cancelBubble=!0,t.inlineAction.execute()},l.isNullOrEmpty(this.inlineAction.iconUrl))i.classList.add("textOnly"),i.textContent=l.isNullOrEmpty(this.inlineAction.title)?"Title":this.inlineAction.title;else{i.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%",r.style.display="none",r.onload=function(){r.style.removeProperty("display")},r.onerror=function(){i.removeChild(r),i.classList.remove("iconOnly"),i.classList.add("textOnly"),i.textContent=l.isNullOrEmpty(t.inlineAction.title)?"Title":t.inlineAction.title},r.src=this.inlineAction.iconUrl,i.appendChild(r),l.isNullOrEmpty(this.inlineAction.title)||(i.title=this.inlineAction.title)}i.style.marginLeft="8px",this.inputControlContainerElement.appendChild(i)}return n},t.prototype.getJsonTypeName=function(){return"Input.Text"},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return!n&&this.inlineAction&&(n=this.inlineAction.getActionById(t)),n},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"placeholder",this.placeholder),l.setNumberProperty(t,"maxLength",this.maxLength),l.setProperty(t,"isMultiline",this.isMultiline,!1),l.setEnumProperty(a.InputTextStyle,t,"style",this.style,a.InputTextStyle.Text),this._inlineAction&&l.setProperty(t,"inlineAction",this._inlineAction.toJSON()),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.maxLength=l.getNumberValue(t.maxLength),this.isMultiline=l.getBoolValue(t.isMultiline,this.isMultiline),this.placeholder=l.getStringValue(t.placeholder),this.style=l.getEnumValue(a.InputTextStyle,t.style,this.style),this.inlineAction=f(this,t.inlineAction,[K.JsonTypeName],!this.isDesignMode(),n)},Object.defineProperty(t.prototype,"inlineAction",{get:function(){return this._inlineAction},set:function(e){this._inlineAction=e,this._inlineAction&&this._inlineAction.setParent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):null},enumerable:!0,configurable:!0}),t}(N);t.TextInput=L;var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.valueOn="true",t.valueOff="false",t.wrap=!1,t}return r(t,e),t.prototype.internalRender=function(){var e=this,t=document.createElement("div");if(t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),t.style.width="100%",t.style.display="flex",t.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=l.generateUniqueId(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this._checkboxInputElement.setAttribute("aria-label",this.title),this._checkboxInputElement.tabIndex=0,this.defaultValue==this.valueOn&&(this._checkboxInputElement.checked=!0),this._checkboxInputElement.onchange=function(){e.valueChanged()},l.appendChild(t,this._checkboxInputElement),!l.isNullOrEmpty(this.title)||this.isDesignMode()){var n=new S;n.setParent(this),n.forElementId=this._checkboxInputElement.id,n.hostConfig=this.hostConfig,n.text=l.isNullOrEmpty(this.title)?this.getJsonTypeName():this.title,n.useMarkdown=he.useMarkdownInRadioButtonAndCheckbox,n.wrap=this.wrap;var i=n.render();i.style.display="inline-block",i.style.flex="1 1 auto",i.style.marginLeft="6px",i.style.verticalAlign="middle";var r=document.createElement("div");r.style.width="6px",l.appendChild(t,r),l.appendChild(t,i)}return t},Object.defineProperty(t.prototype,"isNullable",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Input.Toggle"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"valueOn",this.valueOn,"true"),l.setProperty(t,"valueOff",this.valueOff,"false"),l.setProperty(t,"wrap",this.wrap),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.title=l.getStringValue(t.title),this.valueOn=l.getStringValue(t.valueOn,this.valueOn),this.valueOff=l.getStringValue(t.valueOff,this.valueOff),this.wrap=l.getBoolValue(t.wrap,this.wrap)},Object.defineProperty(t.prototype,"value",{get:function(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:null},enumerable:!0,configurable:!0}),t}(N);t.ToggleInput=M;var F=function(e){function t(t,n){void 0===t&&(t=void 0),void 0===n&&(n=void 0);var i=e.call(this)||this;return i.title=t,i.value=n,i}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.title=l.getStringValue(t.title,""),this.value=l.getStringValue(t.value,"")},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"title",this.title),l.setProperty(t,"value",this.value),t},t}(g);t.Choice=F;var B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.choices=[],t.isCompact=!1,t.isMultiSelect=!1,t.wrap=!1,t}return r(t,e),t.getUniqueCategoryName=function(){var e="__ac-category"+t.uniqueCategoryCounter;return t.uniqueCategoryCounter++,e},t.prototype.internalRender=function(){var e=this;if(this.isMultiSelect){var n=this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):null;(c=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-multiSelect"),c.style.width="100%",this._toggleInputs=[];for(var i=0;i<this.choices.length;i++){var r=document.createElement("input");r.id=l.generateUniqueId(),r.type="checkbox",r.style.margin="0",r.style.display="inline-block",r.style.verticalAlign="middle",r.value=this.choices[i].value,r.style.flex="0 0 auto",r.setAttribute("aria-label",this.choices[i].title),n&&n.indexOf(this.choices[i].value)>=0&&(r.checked=!0),r.onchange=function(){e.valueChanged()},this._toggleInputs.push(r),(d=new S).setParent(this),d.forElementId=r.id,d.hostConfig=this.hostConfig,d.text=l.isNullOrEmpty(this.choices[i].title)?"Choice "+i:this.choices[i].title,d.useMarkdown=he.useMarkdownInRadioButtonAndCheckbox,d.wrap=this.wrap,(h=d.render()).style.display="inline-block",h.style.flex="1 1 auto",h.style.marginLeft="6px",h.style.verticalAlign="middle",(f=document.createElement("div")).style.width="6px",(m=document.createElement("div")).style.display="flex",m.style.alignItems="center",l.appendChild(m,r),l.appendChild(m,f),l.appendChild(m,h),l.appendChild(c,m)}return c}if(this.isCompact){this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%";var o=document.createElement("option");o.selected=!0,o.disabled=!0,o.hidden=!0,o.value="",this.placeholder&&(o.text=this.placeholder),l.appendChild(this._selectElement,o);for(var a=0;a<this.choices.length;a++){var s=document.createElement("option");s.value=this.choices[a].value,s.text=this.choices[a].title,s.setAttribute("aria-label",this.choices[a].title),this.choices[a].value==this.defaultValue&&(s.selected=!0),l.appendChild(this._selectElement,s)}return this._selectElement.onchange=function(){e.valueChanged()},this._selectElement}var c,u=t.getUniqueCategoryName();(c=document.createElement("div")).className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-expanded"),c.style.width="100%",this._toggleInputs=[];for(var p=0;p<this.choices.length;p++){var d,h,f,m,g=document.createElement("input");g.id=l.generateUniqueId(),g.type="radio",g.style.margin="0",g.style.display="inline-block",g.style.verticalAlign="middle",g.name=l.isNullOrEmpty(this.id)?u:this.id,g.value=this.choices[p].value,g.style.flex="0 0 auto",g.setAttribute("aria-label",this.choices[p].title),this.choices[p].value==this.defaultValue&&(g.checked=!0),g.onchange=function(){e.valueChanged()},this._toggleInputs.push(g),(d=new S).setParent(this),d.forElementId=g.id,d.hostConfig=this.hostConfig,d.text=l.isNullOrEmpty(this.choices[p].title)?"Choice "+p:this.choices[p].title,d.useMarkdown=he.useMarkdownInRadioButtonAndCheckbox,d.wrap=this.wrap,(h=d.render()).style.display="inline-block",h.style.flex="1 1 auto",h.style.marginLeft="6px",h.style.verticalAlign="middle",(f=document.createElement("div")).style.width="6px",(m=document.createElement("div")).style.display="flex",m.style.alignItems="center",l.appendChild(m,g),l.appendChild(m,f),l.appendChild(m,h),l.appendChild(c,m)}return c},t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"placeholder",this.placeholder),l.setArrayProperty(t,"choices",this.choices),l.setProperty(t,"style",this.isCompact?null:"expanded"),l.setProperty(t,"isMultiSelect",this.isMultiSelect,!1),l.setProperty(t,"wrap",this.wrap,!1),t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),0==this.choices.length&&t.addFailure(this,{error:a.ValidationError.CollectionCantBeEmpty,message:"An Input.ChoiceSet must have at least one choice defined."});for(var n=0,i=this.choices;n<i.length;n++){var r=i[n];r.title&&r.value||t.addFailure(this,{error:a.ValidationError.PropertyCantBeNull,message:"All choices in an Input.ChoiceSet must have their title and value properties set."})}},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.isCompact=!("expanded"===t.style),this.isMultiSelect=l.getBoolValue(t.isMultiSelect,this.isMultiSelect),this.placeholder=l.getStringValue(t.placeholder),this.choices=[],Array.isArray(t.choices))for(var i=0,r=t.choices;i<r.length;i++){var o=r[i],a=new F;a.parse(o),this.choices.push(a)}this.wrap=l.getBoolValue(t.wrap,this.wrap)},Object.defineProperty(t.prototype,"value",{get:function(){if(this.isMultiSelect){if(!this._toggleInputs||0==this._toggleInputs.length)return null;var e="";for(t=0;t<this._toggleInputs.length;t++)this._toggleInputs[t].checked&&(""!=e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=this._toggleInputs[t].value);return""==e?null:e}if(this.isCompact)return this._selectElement&&this._selectElement.selectedIndex>0?this._selectElement.value:null;if(!this._toggleInputs||0==this._toggleInputs.length)return null;for(var t=0;t<this._toggleInputs.length;t++)if(this._toggleInputs[t].checked)return this._toggleInputs[t].value;return null},enumerable:!0,configurable:!0}),t.uniqueCategoryCounter=0,t}(N);t.ChoiceSetInput=B;var j=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=this;return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=0,l.isNullOrEmpty(this.defaultValue)||(this._numberInputElement.value=this.defaultValue),l.isNullOrEmpty(this.placeholder)||(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=function(){e.valueChanged()},this._numberInputElement},t.prototype.getJsonTypeName=function(){return"Input.Number"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"placeholder",this.placeholder),l.setNumberProperty(t,"min",this.min),l.setNumberProperty(t,"max",this.max),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.placeholder=l.getStringValue(t.placeholder),this.min=l.getNumberValue(t.min),this.max=l.getNumberValue(t.max)},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.value:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueAsNumber",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0},enumerable:!0,configurable:!0}),t}(N);t.NumberInput=j;var R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=this;return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this._dateInputElement.setAttribute("min",this.min),this._dateInputElement.setAttribute("max",this.max),this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=function(){e.valueChanged()},l.isNullOrEmpty(this.defaultValue)||(this._dateInputElement.value=this.defaultValue),this._dateInputElement},t.prototype.getJsonTypeName=function(){return"Input.Date"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"min",this.min),l.setProperty(t,"max",this.max),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.min=l.getStringValue(t.min),this.max=l.getStringValue(t.max)},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=this.parseInputValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=this.parseInputValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:null},enumerable:!0,configurable:!0}),t}(N);t.DateInput=R;var z,H=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalRender=function(){var e=this;return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this._timeInputElement.setAttribute("min",this.min),this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=function(){e.valueChanged()},l.isNullOrEmpty(this.defaultValue)||(this._timeInputElement.value=this.defaultValue),this._timeInputElement},t.prototype.parseInputValue=function(e){return/^[0-9]{2}:[0-9]{2}$/.test(e)?e:null},t.prototype.getJsonTypeName=function(){return"Input.Time"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"min",this.min),l.setProperty(t,"max",this.max),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.min=l.getStringValue(t.min),this.max=l.getStringValue(t.max)},Object.defineProperty(t.prototype,"min",{get:function(){return this._min},set:function(e){this._min=this.parseInputValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},set:function(e){this._max=this.parseInputValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:null},enumerable:!0,configurable:!0}),t}(N);t.TimeInput=H,function(e){e[e.Normal=0]="Normal",e[e.Expanded=1]="Expanded",e[e.Subdued=2]="Subdued"}(z||(z={}));var U=function(){function e(e,t){this._state=z.Normal,this.onClick=null,this.action=e,this._parentContainerStyle=t}return e.prototype.updateCssStyle=function(){var e,t,n=this.action.parent.hostConfig;switch(this.action.renderedElement.className=n.makeCssClassName("ac-pushButton"),l.isNullOrEmpty(this._parentContainerStyle)||this.action.renderedElement.classList.add("style-"+this._parentContainerStyle),this.action instanceof K&&this.action.renderedElement.classList.add(n.makeCssClassName("expandable")),this.action.renderedElement.classList.remove(n.makeCssClassName("expanded")),this.action.renderedElement.classList.remove(n.makeCssClassName("subdued")),this._state){case z.Expanded:this.action.renderedElement.classList.add(n.makeCssClassName("expanded"));break;case z.Subdued:this.action.renderedElement.classList.add(n.makeCssClassName("subdued"))}l.isNullOrEmpty(this.action.style)||(this.action.style===a.ActionStyle.Positive?(e=this.action.renderedElement.classList).add.apply(e,n.makeCssClassNames("primary","style-positive")):(t=this.action.renderedElement.classList).add.apply(t,n.makeCssClassNames("style-"+this.action.style.toLowerCase())))},e.prototype.render=function(){var e=this;this.action.render(),this.action.renderedElement.onclick=function(t){t.preventDefault(),t.cancelBubble=!0,e.click()},this.updateCssStyle()},e.prototype.click=function(){null!=this.onClick&&this.onClick(this)},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e,this.updateCssStyle()},enumerable:!0,configurable:!0}),e}(),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._shouldFallback=!1,t._parent=null,t._actionCollection=null,t._renderedElement=null,t.requires=new c.HostCapabilities,t.style=a.ActionStyle.Default,t}return r(t,e),t.prototype.setCollection=function(e){this._actionCollection=e},t.prototype.addCssClasses=function(e){},t.prototype.internalGetReferencedInputs=function(e){return{}},t.prototype.internalPrepareForExecution=function(e){},t.prototype.internalValidateInputs=function(e){var t=[];if(he.useBuiltInInputValidation&&!this.ignoreInputValidation)for(var n=0,i=Object.keys(e);n<i.length;n++){var r=e[i[n]];r.validateValue()||t.push(r)}return t},t.prototype.getHref=function(){return""},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"type",this.getJsonTypeName()),l.setProperty(t,"title",this.title),l.setProperty(t,"iconUrl",this.iconUrl),l.setProperty(t,"style",this.style,a.ActionStyle.Default),t},t.prototype.render=function(e){void 0===e&&(e="ac-pushButton");var t=this.parent.hostConfig,n=document.createElement("button");this.addCssClasses(n),n.setAttribute("aria-label",this.title),n.type="button",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center";var i=!l.isNullOrEmpty(this.title),r=document.createElement("div");if(r.style.overflow="hidden",r.style.textOverflow="ellipsis",t.actions.iconPlacement==a.ActionIconPlacement.AboveTitle||t.actions.allowTitleToWrap||(r.style.whiteSpace="nowrap"),i&&(r.innerText=this.title),l.isNullOrEmpty(this.iconUrl))n.classList.add("noIcon"),n.appendChild(r);else{var o=document.createElement("img");o.src=this.iconUrl,o.style.width=t.actions.iconSize+"px",o.style.height=t.actions.iconSize+"px",o.style.flex="0 0 auto",t.actions.iconPlacement==a.ActionIconPlacement.AboveTitle?(n.classList.add("iconAbove"),n.style.flexDirection="column",i&&(o.style.marginBottom="4px")):(n.classList.add("iconLeft"),i&&(o.style.marginRight="4px")),n.appendChild(o),n.appendChild(r)}this._renderedElement=n},t.prototype.setParent=function(e){this._parent=e},t.prototype.execute=function(){var e,t,n;this.onExecute&&this.onExecute(this),t=(e=this).parent.getRootElement(),(n=t&&t.onExecuteAction?t.onExecuteAction:he.onExecuteAction)&&e.prepareForExecution()&&n(e)},t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs();return!(this.internalValidateInputs(e).length>0)&&(this.internalPrepareForExecution(e),!0)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),function(e,t,n){var i=e.parent?e.parent.getRootElement():null,r=i&&i.onParseAction?i.onParseAction:he.onParseAction;null!=r&&r(e,t,n)}(this,t,n),this.requires.parse(t.requires,n),t.title||""===t.title||le({error:a.ValidationError.PropertyCantBeNull,message:"Actions should always have a title."},n),this.title=l.getStringValue(t.title),this.iconUrl=l.getStringValue(t.iconUrl),this.style=l.getStringValue(t.style,this.style)},t.prototype.remove=function(){return!!this._actionCollection&&this._actionCollection.removeAction(this)},t.prototype.getAllInputs=function(){return[]},t.prototype.getResourceInformation=function(){return l.isNullOrEmpty(this.iconUrl)?[]:[{url:this.iconUrl,mimeType:"image"}]},t.prototype.getActionById=function(e){if(this.id==e)return this},t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs(this.parent.getRootElement().getAllInputs())},t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())},t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.parent.hostConfig.hostCapabilities)},Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style==a.ActionStyle.Positive},set:function(e){e?this.style=a.ActionStyle.Positive:this.style==a.ActionStyle.Positive&&(this.style=a.ActionStyle.Default)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:!0,configurable:!0}),t}(b);t.Action=J;var W=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isPrepared=!1,t._ignoreInputValidation=!1,t}return r(t,e),t.prototype.internalGetReferencedInputs=function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n];t[r.id]=r}return t},t.prototype.internalPrepareForExecution=function(e){this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={};for(var t=0,n=Object.keys(e);t<n.length;t++){var i=e[n[t]];null!=i.value&&(this._processedData[i.id]=i.value)}this._isPrepared=!0},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"ignoreInputValidation",this.ignoreInputValidation,!1),l.setProperty(t,"data",this._originalData),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this._ignoreInputValidation=l.getBoolValue(t.ignoreInputValidation,this._ignoreInputValidation),this.data=t.data},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e,this._isPrepared=!1},enumerable:!0,configurable:!0}),t.JsonTypeName="Action.Submit",t}(J);t.SubmitAction=W;var $=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"url",this.url),t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),l.isNullOrEmpty(this.url)&&t.addFailure(this,{error:a.ValidationError.PropertyCantBeNull,message:"An Action.OpenUrl must have its url property set."})},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.url=l.getStringValue(t.url)},t.prototype.getHref=function(){return this.url},t.JsonTypeName="Action.OpenUrl",t}(J);t.OpenUrlAction=$;var q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.targetElements={},t}return r(t,e),t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.execute=function(){for(var e=0,t=Object.keys(this.targetElements);e<t.length;e++){var n=t[e],i=this.parent.getRootElement().getElementById(n);i&&("boolean"==typeof this.targetElements[n]?i.isVisible=this.targetElements[n]:i.isVisible=!i.isVisible)}},t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.targetElements={};var n=t.targetElements;if(n&&Array.isArray(n))for(var i=0,r=n;i<r.length;i++){var o=r[i];if("string"==typeof o)this.targetElements[o]=void 0;else if("object"==typeof o){var a=o.elementId;a&&"string"==typeof a&&(this.targetElements[a]=l.getBoolValue(o.isVisible,void 0))}}},t.prototype.toJSON=function(){for(var t=e.prototype.toJSON.call(this),n=[],i=0,r=Object.keys(this.targetElements);i<r.length;i++){var o=r[i];"boolean"==typeof this.targetElements[o]?n.push({elementId:o,isVisible:this.targetElements[o]}):n.push(o)}return t.targetElements=n,t},t.prototype.addTargetElement=function(e,t){void 0===t&&(t=void 0),this.targetElements[e]=t},t.prototype.removeTargetElement=function(e){delete this.targetElements[e]},t.JsonTypeName="Action.ToggleVisibility",t}(J);t.ToggleVisibilityAction=q;var Y=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n="");var i=e.call(this)||this;return i._value=new s.StringWithSubstitutions,i.name=t,i.value=n,i}return r(t,e),t.prototype.parse=function(t){e.prototype.parse.call(this,t),this.name=l.getStringValue(t.name),this.value=l.getStringValue(t.value)},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"name",this.name),l.setProperty(t,"value",this._value.getOriginal()),t},t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)},t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,s.ContentTypes.applicationXWwwFormUrlencoded)},Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:!0,configurable:!0}),t}(g);t.HttpHeader=Y;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._url=new s.StringWithSubstitutions,t._body=new s.StringWithSubstitutions,t._headers=[],t._ignoreInputValidation=!1,t}return r(t,e),t.prototype.internalGetReferencedInputs=function(e){var t={};this._url.getReferencedInputs(e,t);for(var n=0,i=this._headers;n<i.length;n++){i[n].getReferencedInputs(e,t)}return this._body.getReferencedInputs(e,t),t},t.prototype.internalPrepareForExecution=function(e){this._url.substituteInputValues(e,s.ContentTypes.applicationXWwwFormUrlencoded);for(var t=s.ContentTypes.applicationJson,n=0,i=this._headers;n<i.length;n++){var r=i[n];r.prepareForExecution(e),r.name&&"content-type"==r.name.toLowerCase()&&(t=r.value)}this._body.substituteInputValues(e,t)},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"method",this.method),l.setProperty(t,"url",this._url.getOriginal()),l.setProperty(t,"body",this._body.getOriginal()),l.setProperty(t,"ignoreInputValidation",this.ignoreInputValidation,!1),l.setArrayProperty(t,"headers",this.headers),t},t.prototype.internalValidateProperties=function(t){if(e.prototype.internalValidateProperties.call(this,t),l.isNullOrEmpty(this.url)&&t.addFailure(this,{error:a.ValidationError.PropertyCantBeNull,message:"An Action.Http must have its url property set."}),this.headers.length>0)for(var n=0,i=this.headers;n<i.length;n++){i[n].name||t.addFailure(this,{error:a.ValidationError.PropertyCantBeNull,message:"All headers of an Action.Http must have their name and value properties set."})}},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),this.url=l.getStringValue(t.url),this.method=l.getStringValue(t.method),this.body=l.getStringValue(t.body),this._ignoreInputValidation=l.getBoolValue(t.ignoreInputValidation,this._ignoreInputValidation),this._headers=[],Array.isArray(t.headers))for(var i=0,r=t.headers;i<r.length;i++){var o=r[i],a=new Y;a.parse(o),this.headers.push(a)}},Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"headers",{get:function(){return this._headers?this._headers:[]},set:function(e){this._headers=e},enumerable:!0,configurable:!0}),t.JsonTypeName="Action.Http",t}(J);t.HttpAction=G;var K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.card=new fe,t}return r(t,e),t.prototype.addCssClasses=function(t){e.prototype.addCssClasses.call(this,t),t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))},t.prototype.getJsonTypeName=function(){return t.JsonTypeName},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return this.card&&l.setProperty(t,"card",this.card.toJSON()),t},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this.card.internalValidateProperties(t)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var i=t.card;i?this.card.parse(i,n):le({error:a.ValidationError.PropertyCantBeNull,message:'An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},n)},t.prototype.setParent=function(t){e.prototype.setParent.call(this,t),this.card.setParent(t)},t.prototype.getAllInputs=function(){return this.card.getAllInputs()},t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);return n||(n=this.card.getActionById(t)),n},t.JsonTypeName="Action.ShowCard",t}(J);t.ShowCardAction=K;var X=function(){function e(e){this._expandedAction=null,this._renderedActionCount=0,this._actionCard=null,this.items=[],this.buttons=[],this._owner=e}return e.prototype.refreshContainer=function(){if(this._actionCardContainer.innerHTML="",null!==this._actionCard){this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);null!==this._actionCard&&(this._actionCard.style.paddingLeft=t.left+"px",this._actionCard.style.paddingRight=t.right+"px",this._actionCard.style.marginLeft="-"+t.left+"px",this._actionCard.style.marginRight="-"+t.right+"px",0==t.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=t.bottom+"px",this._actionCard.style.marginBottom="-"+t.bottom+"px"),l.appendChild(this._actionCardContainer,this._actionCard))}else this._actionCardContainer.style.marginTop="0px"},e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()},e.prototype.hideActionCard=function(){var e=this._expandedAction;this._expandedAction=null,this._actionCard=null,this.refreshContainer(),e&&(this.layoutChanged(),ae(e,!1))},e.prototype.showActionCard=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!0),null!=e.card){e.card.suppressStyle=t;var i=e.card.renderedElement?e.card.renderedElement:e.card.render();this._actionCard=i,this._expandedAction=e,this.refreshContainer(),n&&(this.layoutChanged(),ae(e,!0))}},e.prototype.collapseExpandedAction=function(){for(var e=0;e<this.buttons.length;e++)this.buttons[e].state=z.Normal;this.hideActionCard()},e.prototype.expandShowCardAction=function(e,t){for(var n=0;n<this.buttons.length;n++)this.buttons[n].action!==e?this.buttons[n].state=z.Subdued:this.buttons[n].state=z.Expanded;this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)},e.prototype.actionClicked=function(e){if(e.action instanceof K)this._owner.hostConfig.actions.showCard.actionMode===a.ShowCardActionMode.Popup?e.action.execute():e.action===this._expandedAction?this.collapseExpandedAction():this.expandShowCardAction(e.action,!0);else{for(var t=0;t<this.buttons.length;t++)this.buttons[t].state=z.Normal;this.hideActionCard(),e.action.execute()}},e.prototype.getParentContainer=function(){return this._owner instanceof te?this._owner:this._owner.getParentContainer()},e.prototype.findActionButton=function(e){for(var t=0,n=this.buttons;t<n.length;t++){var i=n[t];if(i.action==e)return i}return null},e.prototype.parse=function(e,t){if(this.clear(),e&&e instanceof Array)for(var n=0,i=e;n<i.length;n++){var r=i[n],o=f(this._owner,r,[],!this._owner.isDesignMode(),t);o&&this.addAction(o)}},e.prototype.toJSON=function(){if(this.items.length>0){for(var e=[],t=0,n=this.items;t<n.length;t++){var i=n[t];e.push(i.toJSON())}return e}return null},e.prototype.getActionById=function(e){for(var t=null,n=0;n<this.items.length&&!(t=this.items[n].getActionById(e));n++);return t},e.prototype.validateProperties=function(e){this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,{error:a.ValidationError.TooManyActions,message:"A maximum of "+this._owner.hostConfig.actions.maxActions+" actions are allowed."}),this.items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,{error:a.ValidationError.InteractivityNotAllowed,message:"Interactivity is not allowed."});for(var t=0,n=this.items;t<n.length;t++){var i=n[t];d(i,this._owner.getForbiddenActionTypes())||e.addFailure(this._owner,{error:a.ValidationError.ActionTypeNotAllowed,message:"Actions of type "+i.getJsonTypeName()+" are not allowe."}),i.internalValidateProperties(e)}},e.prototype.render=function(e,t){var n=this,i=this._owner.hostConfig;if(!i.supportsInteractivity)return null;var r=document.createElement("div"),o=i.actions.maxActions?Math.min(i.actions.maxActions,this.items.length):this.items.length,s=this._owner.getForbiddenActionTypes();if(this._actionCardContainer=document.createElement("div"),this._renderedActionCount=0,i.actions.preExpandSingleShowCardAction&&1==o&&this.items[0]instanceof K&&d(this.items[0],s))this.showActionCard(this.items[0],!0),this._renderedActionCount=1;else{var c=document.createElement("div");if(c.className=i.makeCssClassName("ac-actionSet"),c.style.display="flex",e==a.Orientation.Horizontal)if(c.style.flexDirection="row",this._owner.horizontalAlignment&&i.actions.actionAlignment!=a.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case a.HorizontalAlignment.Center:c.style.justifyContent="center";break;case a.HorizontalAlignment.Right:c.style.justifyContent="flex-end";break;default:c.style.justifyContent="flex-start"}else switch(i.actions.actionAlignment){case a.ActionAlignment.Center:c.style.justifyContent="center";break;case a.ActionAlignment.Right:c.style.justifyContent="flex-end";break;default:c.style.justifyContent="flex-start"}else if(c.style.flexDirection="column",this._owner.horizontalAlignment&&i.actions.actionAlignment!=a.ActionAlignment.Stretch)switch(this._owner.horizontalAlignment){case a.HorizontalAlignment.Center:c.style.alignItems="center";break;case a.HorizontalAlignment.Right:c.style.alignItems="flex-end";break;default:c.style.alignItems="flex-start"}else switch(i.actions.actionAlignment){case a.ActionAlignment.Center:c.style.alignItems="center";break;case a.ActionAlignment.Right:c.style.alignItems="flex-end";break;case a.ActionAlignment.Stretch:c.style.alignItems="stretch";break;default:c.style.alignItems="flex-start"}for(var u=this.getParentContainer().getEffectiveStyle(),p=0;p<this.items.length;p++)if(d(this.items[p],s)){var h=this.findActionButton(this.items[p]);if(h||((h=new U(this.items[p],u)).onClick=function(e){n.actionClicked(e)},this.buttons.push(h)),h.render(),i.actions.actionsOrientation==a.Orientation.Horizontal&&i.actions.actionAlignment==a.ActionAlignment.Stretch?h.action.renderedElement.style.flex="0 1 100%":h.action.renderedElement.style.flex="0 1 auto",c.appendChild(h.action.renderedElement),this._renderedActionCount++,this._renderedActionCount>=i.actions.maxActions||p==this.items.length-1)break;if(i.actions.buttonSpacing>0){var f=document.createElement("div");e===a.Orientation.Horizontal?(f.style.flex="0 0 auto",f.style.width=i.actions.buttonSpacing+"px"):f.style.height=i.actions.buttonSpacing+"px",l.appendChild(c,f)}}var m=document.createElement("div");m.style.overflow="hidden",m.appendChild(c),l.appendChild(r,m)}l.appendChild(r,this._actionCardContainer);for(p=0;p<this.buttons.length;p++)if(this.buttons[p].state==z.Expanded){this.expandShowCardAction(this.buttons[p].action,!1);break}return this._renderedActionCount>0?r:null},e.prototype.addAction=function(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this.items.indexOf(e)<0))throw new Error("The action already belongs to another element.");this.items.push(e),e.parent||e.setParent(this._owner),p(e,this)},e.prototype.removeAction=function(e){this.expandedAction&&this._expandedAction==e&&this.collapseExpandedAction();var t=this.items.indexOf(e);if(t>=0){this.items.splice(t,1),e.setParent(null),p(e,null);for(var n=0;n<this.buttons.length;n++)if(this.buttons[n].action==e){this.buttons.splice(n,1);break}return!0}return!1},e.prototype.clear=function(){this.items=[],this.buttons=[],this._expandedAction=null,this._renderedActionCount=0},e.prototype.getAllInputs=function(){for(var e=[],t=0;t<this.items.length;t++){var n=this.items[t];e=e.concat(n.getAllInputs())}return e},e.prototype.getResourceInformation=function(){for(var e=[],t=0;t<this.items.length;t++)e=e.concat(this.items[t].getResourceInformation());return e},Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:!0,configurable:!0}),e}(),Z=function(e){function t(){var t=e.call(this)||this;return t.orientation=null,t._actionCollection=new X(t),t}return r(t,e),t.prototype.internalRender=function(){return this._actionCollection.render(this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setEnumProperty(a.Orientation,t,"orientation",this.orientation),l.setProperty(t,"actions",this._actionCollection.toJSON()),t},t.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},t.prototype.getJsonTypeName=function(){return"ActionSet"},t.prototype.getActionCount=function(){return this._actionCollection.items.length},t.prototype.getActionAt=function(t){if(t>=0&&t<this.getActionCount())return this._actionCollection.items[t];e.prototype.getActionAt.call(this,t)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection.validateProperties(t)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var i=t.orientation;i&&(this.orientation=l.getEnumValue(a.Orientation,i,a.Orientation.Horizontal)),this._actionCollection.parse(t.actions,n)},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.getAllInputs=function(){return this._actionCollection.getAllInputs()},t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()},Object.defineProperty(t.prototype,"isInteractive",{get:function(){return!0},enumerable:!0,configurable:!0}),t}(_);t.ActionSet=Z;var Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._style=null,t._bleed=!1,t}return r(t,e),t.prototype.applyBackground=function(){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));l.isNullOrEmpty(e.backgroundColor)||(this.renderedElement.style.backgroundColor=l.stringToCssColor(e.backgroundColor))},t.prototype.applyPadding=function(){if(e.prototype.applyPadding.call(this),this.renderedElement){var t=new s.SpacingDefinition;if(this.getEffectivePadding()&&(t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=t.top+"px",this.renderedElement.style.paddingRight=t.right+"px",this.renderedElement.style.paddingBottom=t.bottom+"px",this.renderedElement.style.paddingLeft=t.left+"px",this.isBleeding()){var n=new s.PaddingDefinition;this.getImmediateSurroundingPadding(n);var i=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.renderedElement.style.marginRight="-"+i.right+"px",this.renderedElement.style.marginLeft="-"+i.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+i.top+"px",this.renderedElement.style.marginBottom="-"+i.bottom+"px"),this.separatorElement&&this.separatorOrientation==a.Orientation.Horizontal&&(this.separatorElement.style.marginLeft="-"+i.left+"px",this.separatorElement.style.marginRight="-"+i.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}},t.prototype.getHasBackground=function(){for(var e=this.parent;e;){var n=e instanceof te&&e.backgroundImage.isValid();if(e instanceof t&&this.hasExplicitStyle&&(e.getEffectiveStyle()!=this.getEffectiveStyle()||n))return!0;e=e.parent}return!1},t.prototype.getDefaultPadding=function(){return this.getHasBackground()?new s.PaddingDefinition(a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding):e.prototype.getDefaultPadding.call(this)},t.prototype.getHasExpandedAction=function(){return!1},t.prototype.getBleed=function(){return this._bleed},t.prototype.setBleed=function(e){this._bleed=e},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return null!=this._style},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supportsMinHeight",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"style",this.style),t},t.prototype.internalValidateProperties=function(t){(e.prototype.internalValidateProperties.call(this,t),this._style)&&(this.hostConfig.containerStyles.getStyleByName(this._style)||t.addFailure(this,{error:a.ValidationError.InvalidPropertyValue,message:"Unknown container style: "+this._style}))},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this._style=l.getStringValue(t.style)},t.prototype.render=function(){var t=e.prototype.render.call(this);return t&&this.getHasBackground()&&this.applyBackground(),t},t.prototype.getEffectiveStyle=function(){var t=this.style;return t||e.prototype.getEffectiveStyle.call(this)},Object.defineProperty(t.prototype,"style",{get:function(){return this.allowCustomStyle&&this._style&&this.hostConfig.containerStyles.getStyleByName(this._style)?this._style:null},set:function(e){this._style=e},enumerable:!0,configurable:!0}),t}(I);t.StylableCardElementContainer=Q;var ee=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.fillMode=t.defaultFillMode,n.horizontalAlignment=t.defaultHorizontalAlignment,n.verticalAlignment=t.defaultVerticalAlignment,n}return r(t,e),t.prototype.reset=function(){this.url=void 0,this.fillMode=t.defaultFillMode,this.horizontalAlignment=t.defaultHorizontalAlignment,this.verticalAlignment=t.defaultVerticalAlignment},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.url=l.getStringValue(t.url),this.fillMode=l.getEnumValue(a.FillMode,t.fillMode,this.fillMode),this.horizontalAlignment=l.getEnumValue(a.HorizontalAlignment,t.horizontalAlignment,this.horizontalAlignment),this.verticalAlignment=l.getEnumValue(a.VerticalAlignment,t.verticalAlignment,this.verticalAlignment)},t.prototype.toJSON=function(){if(!this.isValid())return null;if(this.fillMode==t.defaultFillMode&&this.horizontalAlignment==t.defaultHorizontalAlignment&&this.verticalAlignment==t.defaultVerticalAlignment)return this.url;var n=e.prototype.toJSON.call(this);return l.setProperty(n,"url",this.url),l.setEnumProperty(a.FillMode,n,"fillMode",this.fillMode,t.defaultFillMode),l.setEnumProperty(a.HorizontalAlignment,n,"horizontalAlignment",this.horizontalAlignment,t.defaultHorizontalAlignment),l.setEnumProperty(a.VerticalAlignment,n,"verticalAlignment",this.verticalAlignment,t.defaultVerticalAlignment),n},t.prototype.apply=function(e){if(this.url){switch(e.style.backgroundImage="url('"+this.url+"')",this.fillMode){case a.FillMode.Repeat:e.style.backgroundRepeat="repeat";break;case a.FillMode.RepeatHorizontally:e.style.backgroundRepeat="repeat-x";break;case a.FillMode.RepeatVertically:e.style.backgroundRepeat="repeat-y";break;case a.FillMode.Cover:default:e.style.backgroundRepeat="no-repeat",e.style.backgroundSize="cover"}switch(this.horizontalAlignment){case a.HorizontalAlignment.Center:e.style.backgroundPositionX="center";break;case a.HorizontalAlignment.Right:e.style.backgroundPositionX="right"}switch(this.verticalAlignment){case a.VerticalAlignment.Center:e.style.backgroundPositionY="center";break;case a.VerticalAlignment.Bottom:e.style.backgroundPositionY="bottom"}}},t.prototype.isValid=function(){return!l.isNullOrEmpty(this.url)},t.defaultFillMode=a.FillMode.Cover,t.defaultHorizontalAlignment=a.HorizontalAlignment.Left,t.defaultVerticalAlignment=a.VerticalAlignment.Top,t}(g);t.BackgroundImage=ee;var te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._items=[],t._renderedItems=[],t.backgroundImage=new ee,t.verticalContentAlignment=a.VerticalAlignment.Top,t.rtl=null,t}return r(t,e),t.prototype.insertItemAt=function(e,t,n){if(e.parent&&!n)throw new Error("The element already belongs to another container.");if(!e.isStandalone)throw new Error("Elements of type "+e.getJsonTypeName()+" cannot be used as standalone elements.");t<0||t>=this._items.length?this._items.push(e):this._items.splice(t,0,e),e.setParent(this)},t.prototype.supportsExcplitiHeight=function(){return!0},t.prototype.getItemsCollectionPropertyName=function(){return"items"},t.prototype.applyBackground=function(){this.backgroundImage.isValid()&&this.backgroundImage.apply(this.renderedElement),e.prototype.applyBackground.call(this)},t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig,t=document.createElement("div");switch(null!=this.rtl&&this.rtl&&(t.dir="rtl"),t.classList.add(e.makeCssClassName("ac-container")),t.style.display="flex",t.style.flexDirection="column",he.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.verticalContentAlignment){case a.VerticalAlignment.Center:t.style.justifyContent="center";break;case a.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}if(this._items.length>0)for(var n=0;n<this._items.length;n++){var i=this.isElementAllowed(this._items[n],this.getForbiddenElementTypes())?this._items[n].render():null;i&&(this._renderedItems.length>0&&this._items[n].separatorElement&&(this._items[n].separatorElement.style.flex="0 0 auto",l.appendChild(t,this._items[n].separatorElement)),l.appendChild(t,i),this._renderedItems.push(this._items[n]))}else if(this.isDesignMode()){var r=this.createPlaceholderElement();r.style.width="100%",r.style.height="100%",t.appendChild(r)}return t},t.prototype.truncateOverflow=function(e){for(var t=this.renderedElement.offsetTop+e+1,n=function(e){var i=e.renderedElement;if(i)switch(l.getFitStatus(i,t)){case a.ContainerFitStatus.FullyInContainer:e.resetOverflow()&&n(e);break;case a.ContainerFitStatus.Overflowing:var r=t-i.offsetTop;e.handleOverflow(r);break;case a.ContainerFitStatus.FullyOutOfContainer:e.handleOverflow(0)}},i=0,r=this._items;i<r.length;i++){var o=r[i];n(o)}return!0},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++){t[e].resetOverflow()}},t.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this)},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);if(l.setProperty(t,"backgroundImage",this.backgroundImage.toJSON()),l.setEnumProperty(a.VerticalAlignment,t,"verticalContentAlignment",this.verticalContentAlignment,a.VerticalAlignment.Top),this._items.length>0){for(var n=[],i=0,r=this._items;i<r.length;i++){var o=r[i];n.push(o.toJSON())}l.setProperty(t,this.getItemsCollectionPropertyName(),n)}return l.setProperty(t,"bleed",this.bleed,!1),t},t.prototype.getItemCount=function(){return this._items.length},t.prototype.getItemAt=function(e){return this._items[e]},t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=0,t=this._renderedItems;e<t.length;e++){var n=t[e];if(n.isVisible)return n}return null},t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(var e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e];return null},t.prototype.getJsonTypeName=function(){return"Container"},t.prototype.isFirstElement=function(e){for(var t=this.isDesignMode(),n=0;n<this._items.length;n++)if(this._items[n].isVisible||t)return this._items[n]==e;return!1},t.prototype.isLastElement=function(e){for(var t=this.isDesignMode(),n=this._items.length-1;n>=0;n--)if(this._items[n].isVisible||t)return this._items[n]==e;return!1},t.prototype.isRtl=function(){if(null!=this.rtl)return this.rtl;var e=this.getParentContainer();return!!e&&e.isRtl()},t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()},t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()==this.getEffectiveStyle())},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.setShouldFallback(!1),this._items=[],this._renderedItems=[],this.backgroundImage.reset();var i=t.backgroundImage;if(i&&("string"==typeof i?(this.backgroundImage.url=i,this.backgroundImage.fillMode=a.FillMode.Cover):"object"==typeof i&&this.backgroundImage.parse(i,n)),this.verticalContentAlignment=l.getEnumValue(a.VerticalAlignment,t.verticalContentAlignment,this.verticalContentAlignment),null!=t[this.getItemsCollectionPropertyName()]){var r=t[this.getItemsCollectionPropertyName()];this.clear();for(var o=0;o<r.length;o++){var s=m(this,r[o],!this.isDesignMode(),n);s&&this.insertItemAt(s,-1,!0)}}this.bleed=l.getBoolValue(t.bleed,this.bleed)},t.prototype.indexOf=function(e){return this._items.indexOf(e)},t.prototype.addItem=function(e){this.insertItemAt(e,-1,!1)},t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),!1)},t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,!1)},t.prototype.removeItem=function(e){var t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(null),this.updateLayout(),!0)},t.prototype.clear=function(){this._items=[]},t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);return this.backgroundImage.isValid()&&t.push({url:this.backgroundImage.url,mimeType:"image"}),t},t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&(this.selectAction&&(n=this.selectAction.getActionById(t)),!n))for(var i=0;i<this._items.length&&!(n=this._items[i].getActionById(t));i++);return n},Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(e){this.setSelectAction(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!0,configurable:!0}),t}(Q);t.Container=te;var ne=function(e){function t(t){void 0===t&&(t="stretch");var n=e.call(this)||this;return n._computedWeight=0,n.width="stretch",n.width=t,n}return r(t,e),t.prototype.adjustRenderedElementSize=function(e){if(this.isDesignMode()?(e.style.minWidth="20px",e.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.style.minWidth="0",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width)e.style.flex="0 1 auto";else if("stretch"===this.width)e.style.flex="1 1 50px";else{var t=this.width;t.unit==a.SizeUnit.Pixel?(e.style.flex="0 0 auto",e.style.width=t.physicalSize+"px"):e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:t.physicalSize)+"%"}},Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return a.Orientation.Vertical},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"Column"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return this.width instanceof s.SizeAndUnit?this.width.unit==a.SizeUnit.Pixel?l.setProperty(t,"width",this.width.physicalSize+"px"):l.setNumberProperty(t,"width",this.width.physicalSize):l.setProperty(t,"width",this.width),t},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n);var i=t.width;if(void 0===i&&void 0!==(i=t.size)&&le({error:a.ValidationError.Deprecated,message:'The "Column.size" property is deprecated and will be removed. Use the "Column.width" property instead.'},n),i){var r=!1;try{this.width=s.SizeAndUnit.parse(i)}catch(e){"string"!=typeof i||"auto"!==i&&"stretch"!==i?r=!0:this.width=i}r&&le({error:a.ValidationError.InvalidPropertyValue,message:"Invalid column width:"+i+' - defaulting to "auto"'},n)}},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!!(this.parent&&this.parent instanceof ie)&&(this.separatorElement&&!this.parent.isLeftMostElement(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(te);t.Column=ne;var ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._columns=[],t}return r(t,e),t.prototype.createColumnInstance=function(e,t){return h(this,e,[],!this.isDesignMode(),function(e){return e&&"Column"!==e?null:new ne},function(e,t){return t==o.UnknownType?{error:a.ValidationError.UnknownElementType,message:"Unknown element type: "+e+". Fallback will be used if present."}:{error:a.ValidationError.ElementTypeNotAllowed,message:"Element type "+e+" isn't allowed in a ColumnSet."}},t)},t.prototype.internalRender=function(){if(this._renderedColumns=[],this._columns.length>0){var e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",he.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.horizontalAlignment){case a.HorizontalAlignment.Center:t.style.justifyContent="center";break;case a.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}for(var n=0,i=0,r=this._columns;i<r.length;i++){(u=r[i]).width instanceof s.SizeAndUnit&&u.width.unit==a.SizeUnit.Weight&&(n+=u.width.physicalSize)}for(var o=0,c=this._columns;o<c.length;o++){var u;if((u=c[o]).width instanceof s.SizeAndUnit&&u.width.unit==a.SizeUnit.Weight&&n>0){var p=100/n*u.width.physicalSize;u._computedWeight=p}var d=u.render();d&&(this._renderedColumns.length>0&&u.separatorElement&&(u.separatorElement.style.flex="0 0 auto",l.appendChild(t,u.separatorElement)),l.appendChild(t,d),this._renderedColumns.push(u))}return this._renderedColumns.length>0?t:null}return null},t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++){n[t].handleOverflow(e)}return!0},t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++){t[e].resetOverflow()}},Object.defineProperty(t.prototype,"isSelectable",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);if(this._columns.length>0){for(var n=[],i=0,r=this._columns;i<r.length;i++){var o=r[i];n.push(o.toJSON())}l.setProperty(t,"columns",n)}return l.setProperty(t,"bleed",this.bleed,!1),t},t.prototype.isFirstElement=function(e){for(var t=0;t<this._columns.length;t++)if(this._columns[t].isVisible)return this._columns[t]==e;return!1},t.prototype.isBleedingAtTop=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtTop())return!0}return!1},t.prototype.isBleedingAtBottom=function(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(var e=0,t=this._columns;e<t.length;e++){if(t[e].isBleedingAtBottom())return!0}return!1},t.prototype.getCount=function(){return this._columns.length},t.prototype.getItemCount=function(){return this.getCount()},t.prototype.getFirstVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:null},t.prototype.getLastVisibleRenderedItem=function(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:null},t.prototype.getColumnAt=function(e){return this._columns[e]},t.prototype.getItemAt=function(e){return this.getColumnAt(e)},t.prototype.getJsonTypeName=function(){return"ColumnSet"},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),null!=t.columns){var i=t.columns;this._columns=[];for(var r=0;r<i.length;r++){var o=this.createColumnInstance(i[r],n);o&&this._columns.push(o)}}this.bleed=l.getBoolValue(t.bleed,this.bleed)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0,i=0,r=0,o=this._columns;r<o.length;r++){var s=o[r];"number"==typeof s.width?n++:"stretch"===s.width&&i++}n>0&&i>0&&t.addFailure(this,{error:a.ValidationError.Hint,message:"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."})},t.prototype.addColumn=function(e){if(e.parent)throw new Error("This column already belongs to another ColumnSet.");this._columns.push(e),e.setParent(this)},t.prototype.removeItem=function(e){if(e instanceof ne){var t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(null),this.updateLayout(),!0}return!1},t.prototype.indexOf=function(e){return e instanceof ne?this._columns.indexOf(e):-1},t.prototype.isLeftMostElement=function(e){return 0==this._columns.indexOf(e)},t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)==this._columns.length-1},t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0},t.prototype.getActionById=function(e){for(var t=null,n=0;n<this._columns.length&&!(t=this._columns[n].getActionById(e));n++);return t},Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectAction",{get:function(){return this.getSelectAction()},set:function(e){this.setSelectAction(e)},enumerable:!0,configurable:!0}),t}(Q);function re(e){var t=e.getRootElement(),n=t&&t.onImageLoaded?t.onImageLoaded:he.onImageLoaded;n&&n(e)}function oe(e,t){var n=e.getRootElement(),i=n&&n.onAnchorClicked?n.onAnchorClicked:he.onAnchorClicked;return null!=i&&i(e,t)}function ae(e,t){var n=e.parent.getRootElement(),i=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:he.onInlineCardExpanded;i&&i(e,t)}function se(e,t){void 0===t&&(t=!0);var n=e.getRootElement();t&&n.updateLayout();var i=n,r=i&&i.onElementVisibilityChanged?i.onElementVisibilityChanged:he.onElementVisibilityChanged;null!=r&&r(e)}function le(e,t){t&&t.push(e),null!=he.onParseError&&he.onParseError(e)}t.ColumnSet=ie;var ce=function(e){function t(){var t=e.call(this)||this;return t._actionCollection=new X(t),t}return r(t,e),t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this),n=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,!1);return n&&(l.appendChild(t,l.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),lineThickness:null,lineColor:null},a.Orientation.Horizontal)),l.appendChild(t,n)),this.renderIfEmpty?t:t.children.length>0?t:null},t.prototype.getHasExpandedAction=function(){return 0!=this.renderedActionCount&&(1==this.renderedActionCount?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction)},Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"actions",this._actionCollection.toJSON()),t},t.prototype.getActionCount=function(){return this._actionCollection.items.length},t.prototype.getActionAt=function(t){if(t>=0&&t<this.getActionCount())return this._actionCollection.items[t];e.prototype.getActionAt.call(this,t)},t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n||e.prototype.getActionById.call(this,t)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this._actionCollection.parse(t.actions,n)},t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t),this._actionCollection&&this._actionCollection.validateProperties(t)},t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&0==this._actionCollection.items.length},t.prototype.addAction=function(e){this._actionCollection.addAction(e)},t.prototype.clear=function(){e.prototype.clear.call(this),this._actionCollection.clear()},t.prototype.getAllInputs=function(){return e.prototype.getAllInputs.call(this).concat(this._actionCollection.getAllInputs())},t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())},t.prototype.isBleedingAtBottom=function(){return 0==this._actionCollection.renderedActionCount?e.prototype.isBleedingAtBottom.call(this):1==this._actionCollection.items.length?null!=this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:null!=this._actionCollection.expandedAction},Object.defineProperty(t.prototype,"isStandalone",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(te);t.ContainerWithActions=ce;var ue=function(){function e(){this._items=[],this.reset()}return e.prototype.findTypeRegistration=function(e){for(var t=0;t<this._items.length;t++)if(this._items[t].typeName===e)return this._items[t];return null},e.prototype.clear=function(){this._items=[]},e.prototype.registerType=function(e,t){var n=this.findTypeRegistration(e);null!=n?n.createInstance=t:(n={typeName:e,createInstance:t},this._items.push(n))},e.prototype.unregisterType=function(e){for(var t=0;t<this._items.length;t++)if(this._items[t].typeName===e)return void this._items.splice(t,1)},e.prototype.createInstance=function(e){var t=this.findTypeRegistration(e);return t?t.createInstance():null},e.prototype.getItemCount=function(){return this._items.length},e.prototype.getItemAt=function(e){return this._items[e]},e}();t.TypeRegistry=ue;var pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.reset=function(){this.clear(),this.registerType("Container",function(){return new te}),this.registerType("TextBlock",function(){return new E}),this.registerType("RichTextBlock",function(){return new P}),this.registerType("TextRun",function(){return new x}),this.registerType("Image",function(){return new A}),this.registerType("ImageSet",function(){return new O}),this.registerType("Media",function(){return new D}),this.registerType("FactSet",function(){return new T}),this.registerType("ColumnSet",function(){return new ie}),this.registerType("ActionSet",function(){return new Z}),this.registerType("Input.Text",function(){return new L}),this.registerType("Input.Date",function(){return new R}),this.registerType("Input.Time",function(){return new H}),this.registerType("Input.Number",function(){return new j}),this.registerType("Input.ChoiceSet",function(){return new B}),this.registerType("Input.Toggle",function(){return new M})},t}(ue);t.ElementTypeRegistry=pe;var de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.reset=function(){this.clear(),this.registerType($.JsonTypeName,function(){return new $}),this.registerType(W.JsonTypeName,function(){return new W}),this.registerType(K.JsonTypeName,function(){return new K}),this.registerType(q.JsonTypeName,function(){return new q})},t}(ue);t.ActionTypeRegistry=de;var he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._cardTypeName="AdaptiveCard",t._fallbackCard=null,t.onAnchorClicked=null,t.onExecuteAction=null,t.onElementVisibilityChanged=null,t.onImageLoaded=null,t.onInlineCardExpanded=null,t.onInputValueChanged=null,t.onParseElement=null,t.onParseAction=null,t.version=new c.Version(1,0),t.designMode=!1,t}return r(t,e),Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},set:function(e){throw new Error("The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.")},enumerable:!0,configurable:!0}),t.applyMarkdown=function(e){var n={didProcess:!1};return t.onProcessMarkdown?t.onProcessMarkdown(e,n):window.markdownit?(n.outputHtml=window.markdownit().render(e),n.didProcess=!0):console.warn("Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"),n},t.prototype.isVersionSupported=function(){return!!this.bypassVersionCheck||!(!this.version||!this.version.isValid||t.currentVersion.major<this.version.major||t.currentVersion.major==this.version.major&&t.currentVersion.minor<this.version.minor)},t.prototype.getItemsCollectionPropertyName=function(){return"body"},t.prototype.internalRender=function(){var n=e.prototype.internalRender.call(this);return t.useAdvancedCardBottomTruncation&&(n.style.minHeight=null),n},t.prototype.getHasBackground=function(){return!0},t.prototype.getDefaultPadding=function(){return new s.PaddingDefinition(a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding,a.Spacing.Padding)},Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasBackground",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.getJsonTypeName=function(){return"AdaptiveCard"},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return l.setProperty(t,"$schema","http://adaptivecards.io/schemas/adaptive-card.json"),!this.bypassVersionCheck&&this.version&&l.setProperty(t,"version",this.version.toString()),l.setProperty(t,"fallbackText",this.fallbackText),l.setProperty(t,"lang",this.lang),l.setProperty(t,"speak",this.speak),t},t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n),"AdaptiveCard"!=this._cardTypeName&&n.addFailure(this,{error:a.ValidationError.MissingCardType,message:'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'}),this.bypassVersionCheck||this.version?this.isVersionSupported()||n.addFailure(this,{error:a.ValidationError.UnsupportedCardVersion,message:"The specified card version ("+this.version+") is not supported. The maximum supported card version is "+t.currentVersion}):n.addFailure(this,{error:a.ValidationError.PropertyCantBeNull,message:"The version property must be specified."})},t.prototype.parse=function(n,i){this._fallbackCard=null,this._cardTypeName=l.getStringValue(n.type),this.speak=l.getStringValue(n.speak);var r=l.getStringValue(n.lang);if(r&&"string"==typeof r)try{this.lang=r}catch(e){le({error:a.ValidationError.InvalidPropertyValue,message:e.message},i)}this.version=c.Version.parse(n.version,i),this.fallbackText=l.getStringValue(n.fallbackText);var o=m(null,n.fallback,!this.isDesignMode(),i);o&&(this._fallbackCard=new t,this._fallbackCard.addItem(o)),e.prototype.parse.call(this,n,i)},t.prototype.render=function(t){var n;return this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,n=this._fallbackCard.render()):(n=e.prototype.render.call(this))&&(n.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),n.tabIndex=0,l.isNullOrEmpty(this.speak)||n.setAttribute("aria-label",this.speak)),t&&(t.appendChild(n),this.updateLayout()),n},t.prototype.updateLayout=function(n){if(void 0===n&&(n=!0),e.prototype.updateLayout.call(this,n),t.useAdvancedCardBottomTruncation&&this.isRendered()){var i=this.renderedElement,r=this.hostConfig.getEffectiveSpacing(a.Spacing.Default);this.handleOverflow(i.offsetHeight-r)}},t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()},Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return!1},enumerable:!0,configurable:!0}),t.currentVersion=new c.Version(1,2),t.useAdvancedTextBlockTruncation=!0,t.useAdvancedCardBottomTruncation=!1,t.useMarkdownInRadioButtonAndCheckbox=!0,t.allowMarkForTextHighlighting=!1,t.alwaysBleedSeparators=!1,t.enableFullJsonRoundTrip=!1,t.useBuiltInInputValidation=!0,t.displayInputValidationErrors=!0,t.elementTypeRegistry=new pe,t.actionTypeRegistry=new de,t.onAnchorClicked=null,t.onExecuteAction=null,t.onElementVisibilityChanged=null,t.onImageLoaded=null,t.onInlineCardExpanded=null,t.onInputValueChanged=null,t.onParseElement=null,t.onParseAction=null,t.onParseError=null,t.onProcessMarkdown=null,t}(ce);t.AdaptiveCard=he;var fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.suppressStyle=!1,t}return r(t,e),t.prototype.getDefaultPadding=function(){return new s.PaddingDefinition(this.suppressStyle?a.Spacing.None:a.Spacing.Padding,a.Spacing.Padding,this.suppressStyle?a.Spacing.None:a.Spacing.Padding,a.Spacing.Padding)},Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return this.suppressStyle?a.ContainerStyle.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:a.ContainerStyle.Emphasis},enumerable:!0,configurable:!0}),t.prototype.render=function(t){var n=e.prototype.render.call(this,t);return n.setAttribute("aria-live","polite"),n.removeAttribute("tabindex"),n},t.prototype.getForbiddenActionTypes=function(){return[K]},t}(he),me=new c.HostConfig({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#54a254",subtle:"#DD54a254"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},actions:{maxActions:5,spacing:a.Spacing.Default,buttonSpacing:10,showCard:{actionMode:a.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:a.Orientation.Horizontal,actionAlignment:a.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:a.Size.Medium,maxImageHeight:100},factSet:{title:{color:a.TextColor.Default,size:a.TextSize.Default,isSubtle:!1,weight:a.TextWeight.Bolder,wrap:!0,maxWidth:150},value:{color:a.TextColor.Default,size:a.TextSize.Default,isSubtle:!1,weight:a.TextWeight.Default,wrap:!0},spacing:10}})},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._regularExpression=e}return e.prototype.format=function(e,t){for(var n,i=t;null!=(n=this._regularExpression.exec(t));)i=i.replace(n[0],this.internalFormat(e,n));return i},e}(),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1])),i=null!=t[2]?t[2].toLowerCase():"compact";return"compact"!=i?n.toLocaleDateString(e,{day:"numeric",weekday:i,month:i,year:"numeric"}):n.toLocaleDateString()},t}(o),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.internalFormat=function(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})},t}(o);t.formatText=function(e,t){for(var n=[new a(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new s(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)],i=t,r=0;r<n.length;r++)i=n[r].format(e,i);return i}},function(e){e.exports=JSON.parse('{"spacing":{"small":3,"default":8,"medium":20,"large":30,"extraLarge":40,"padding":10},"separator":{"lineThickness":1,"lineColor":"#EEEEEE"},"supportsInteractivity":true,"fontTypes":{"default":{"fontFamily":"\'Segoe UI\', \'Roboto\', \'Oxygen\', \'Ubuntu\', \'Cantarell\', \'Fira Sans\', \'Droid Sans\', \'Helvetica Neue\', sans-serif","fontSizes":{"small":12,"default":14,"medium":17,"large":21,"extraLarge":26},"fontWeights":{"lighter":200,"default":400,"bolder":600}},"monospace":{"fontFamily":"\'Courier New\', Courier, monospace","fontSizes":{"small":12,"default":14,"medium":17,"large":21,"extraLarge":26},"fontWeights":{"lighter":200,"default":400,"bolder":600}}},"containerStyles":{"default":{"backgroundColor":"#FFFFFF","foregroundColors":{"default":{"default":"#000000","subtle":"#767676"},"accent":{"default":"#0063B1","subtle":"#0063B1"},"attention":{"default":"#FF0000","subtle":"#DDFF0000"},"good":{"default":"#54a254","subtle":"#DD54a254"},"warning":{"default":"#c3ab23","subtle":"#DDc3ab23"}}},"emphasis":{"backgroundColor":"#F0F0F0","foregroundColors":{"default":{"default":"#000000","subtle":"#767676"},"accent":{"default":"#2E89FC","subtle":"#882E89FC"},"attention":{"default":"#FF0000","subtle":"#DDFF0000"},"good":{"default":"#54a254","subtle":"#DD54a254"},"warning":{"default":"#c3ab23","subtle":"#DDc3ab23"}}},"accent":{"backgroundColor":"#C7DEF9","foregroundColors":{"default":{"default":"#333333","subtle":"#EE333333"},"dark":{"default":"#000000","subtle":"#66000000"},"light":{"default":"#FFFFFF","subtle":"#33000000"},"accent":{"default":"#2E89FC","subtle":"#882E89FC"},"attention":{"default":"#cc3300","subtle":"#DDcc3300"},"good":{"default":"#54a254","subtle":"#DD54a254"},"warning":{"default":"#e69500","subtle":"#DDe69500"}}},"good":{"backgroundColor":"#CCFFCC","foregroundColors":{"default":{"default":"#333333","subtle":"#EE333333"},"dark":{"default":"#000000","subtle":"#66000000"},"light":{"default":"#FFFFFF","subtle":"#33000000"},"accent":{"default":"#2E89FC","subtle":"#882E89FC"},"attention":{"default":"#cc3300","subtle":"#DDcc3300"},"good":{"default":"#54a254","subtle":"#DD54a254"},"warning":{"default":"#e69500","subtle":"#DDe69500"}}},"attention":{"backgroundColor":"#FFC5B2","foregroundColors":{"default":{"default":"#333333","subtle":"#EE333333"},"dark":{"default":"#000000","subtle":"#66000000"},"light":{"default":"#FFFFFF","subtle":"#33000000"},"accent":{"default":"#2E89FC","subtle":"#882E89FC"},"attention":{"default":"#cc3300","subtle":"#DDcc3300"},"good":{"default":"#54a254","subtle":"#DD54a254"},"warning":{"default":"#e69500","subtle":"#DDe69500"}}},"warning":{"backgroundColor":"#FFE2B2","foregroundColors":{"default":{"default":"#333333","subtle":"#EE333333"},"dark":{"default":"#000000","subtle":"#66000000"},"light":{"default":"#FFFFFF","subtle":"#33000000"},"accent":{"default":"#2E89FC","subtle":"#882E89FC"},"attention":{"default":"#cc3300","subtle":"#DDcc3300"},"good":{"default":"#54a254","subtle":"#DD54a254"},"warning":{"default":"#e69500","subtle":"#DDe69500"}}}},"imageSizes":{"small":40,"medium":80,"large":160},"actions":{"maxActions":5,"spacing":"default","buttonSpacing":8,"showCard":{"actionMode":"inline","inlineTopMargin":8},"actionsOrientation":"horizontal","actionAlignment":"stretch"},"adaptiveCard":{"allowCustomStyle":false},"imageSet":{"imageSize":"medium","maxImageHeight":100},"factSet":{"title":{"color":"default","size":"default","isSubtle":false,"weight":"bolder","wrap":true,"maxWidth":150},"value":{"color":"default","size":"default","isSubtle":false,"weight":"default","wrap":true},"spacing":8}}')},function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(20)),i(n(8)),i(n(1)),i(n(12)),i(n(9)),i(n(48)),i(n(29)),i(n(6)),i(n(23)),i(n(24)),i(n(11)),i(n(18)),i(n(34)),i(n(17)),i(n(32)),i(n(33)),i(n(35)),i(n(16)),i(n(25)),i(n(36)),i(n(30)),i(n(1)),i(n(12))},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=n(15),s=n(10),l=function(){function e(e,t){this.key=e,this._value=t}return e.prototype.click=function(){this.onClick&&this.onClick(this)},e.prototype.toString=function(){return this.value},e.prototype.render=function(){var e=this;return this._element||(this._element=document.createElement("span"),this._element.className="ms-ctrl ms-ctrl-dropdown-item",this._element.innerText=this.value,this._element.onmouseup=function(t){e.click()}),this._element},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this._element&&(this._element.innerText=e)},enumerable:!0,configurable:!0}),e}();t.DropDownItem=l;var c=function(e){function t(t){var n=e.call(this)||this;return n._renderedItems=[],n._selectedIndex=-1,n._owner=t,n}return r(t,e),t.prototype.renderContent=function(){var e=document.createElement("div");e.className="ms-ctrl ms-popup";for(var t=this._owner.selectedIndex,n=0;n<this._owner.items.length;n++){var i=this._owner.items.get(n).render();i.tabIndex=0,e.appendChild(i),n==t&&i.focus(),this._renderedItems.push(i)}return e},t.prototype.keyDown=function(t){e.prototype.keyDown.call(this,t);var n=this._selectedIndex;switch(t.keyCode){case o.KEY_TAB:this.close();break;case o.KEY_ENTER:this.selectedIndex>=0&&(this._owner.selectedIndex=this.selectedIndex,this.close());break;case o.KEY_UP:n<=0?n=this._renderedItems.length-1:--n<0&&(n=this._renderedItems.length-1),this.selectedIndex=n,t.cancelBubble=!0;break;case o.KEY_DOWN:n<0?n=0:++n>=this._renderedItems.length&&(n=0),this.selectedIndex=n,t.cancelBubble=!0}},t.prototype.render=function(t){var n=e.prototype.render.call(this,t);return n.style.minWidth=t.width/2+"px",n.style.maxWidth=t.width+"px",n},Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){e>=0&&e<this._renderedItems.length&&(this._renderedItems[e].focus(),this._selectedIndex=e)},enumerable:!0,configurable:!0}),t}(s.PopupControl);t.DropDownPopupControl=c;var u=function(e){function t(){var t=e.call(this)||this;return t._items=new a.Collection,t._items.onItemAdded=function(e){e.onClick=function(e){t.itemClicked(e)}},t._items.onItemRemoved=function(e){e.onClick=null},t}return r(t,e),t.prototype.itemClicked=function(e){this.selectedItem=e,this.closePopup(),this.rootElement.focus()},t.prototype.validateRootElement=function(e){if(!(e instanceof HTMLDivElement))throw new Error("DropDown requires a DIV element as its root.")},t.prototype.createPopupControl=function(){return new c(this)},t.prototype.getCssClassName=function(){return"ms-ctrl ms-ctrl-dropdown"},t.prototype.attach=function(t){e.prototype.attach.call(this,t);for(var n=0;n<this.rootElement.children.length;n++){var i=this.rootElement.children[n];if("ms-dropdown-item"==i.tagName.toLowerCase()){var r=new l(i.attributes.getNamedItem("key").value,i.attributes.getNamedItem("value").value);this._items.add(r)}}},t.prototype.popup=function(){e.prototype.popup.call(this),this.popupControl.selectedIndex=this.selectedIndex},Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedItem",{get:function(){return this.value},set:function(e){this.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this.items.indexOf(this.value)},set:function(e){e>=0&&this.items.length>e&&(this.selectedItem=this.items.get(e))},enumerable:!0,configurable:!0}),t}(s.InputWithPopup);t.DropDown=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(10),a=n(22),s=function(e){function t(t){var n=e.call(this)||this;return n._owner=t,n}return r(t,e),t.prototype.renderContent=function(){var e=this,t=document.createElement("div");return t.className="ms-ctrl ms-calendarPopup",this._calendar=new a.Calendar,this._calendar.date=this._owner.value,this._calendar.onDateChanged=function(t){e._owner.value=t.date,e.close()},this._calendar.attach(t),t},t.prototype.focus=function(){this._calendar&&this._calendar.focus()},t}(o.PopupControl);t.CalendarPopupControl=s;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.validateRootElement=function(e){if(!(e instanceof HTMLDivElement))throw new Error("DatePicker requires a DIV element as its root.")},t.prototype.createPopupControl=function(){return new s(this)},t.prototype.getValueAsString=function(){return this.value.toLocaleDateString()},t.prototype.getCssClassName=function(){return"ms-ctrl ms-ctrl-datePicker"},t.prototype.getButtonIconCssClassName=function(){return"ms-icon-calendar"},t.prototype.popup=function(){e.prototype.popup.call(this),this.isOpen&&this.popupControl.focus()},t}(o.InputWithPopup);t.DatePicker=l},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._label="",t._checkboxElement=null,t._spanElement=null,t}return r(t,e),t.createId=function(){var e=t.creationIndex;return t.creationIndex++,e},t.prototype.changed=function(){this.onChange&&this.onChange(this)},t.prototype.keyDown=function(e){switch(e.keyCode){case o.KEY_ENTER:this.isChecked=!this.isChecked}},t.prototype.attach=function(n){var i=this;e.prototype.attach.call(this,n),n.className="ms-ctrl ms-ctrl-checkbox",n.tabIndex=0;var r=n.attributes.label;r&&(this._label=r.value);var o=n.attributes.ischecked;o&&(this._isChecked="true"===o.value),this._checkboxElement=document.createElement("input"),this._checkboxElement.id="ms-ctrl-checkbox-"+t.createId(),this._checkboxElement.type="checkbox",this._checkboxElement.style.position="absolute",this._checkboxElement.checked=this.isChecked,this._checkboxElement.onchange=function(e){i.changed()};var a=document.createElement("label");a.htmlFor=this._checkboxElement.id,this._spanElement=document.createElement("span"),this._spanElement.innerText=this._label,a.appendChild(this._spanElement),n.innerHTML="",n.appendChild(this._checkboxElement),n.appendChild(a)},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(e){this._label=e,this._spanElement&&(this._spanElement.innerText=this._label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){this._isChecked!=e&&(this._isChecked=e,this._checkboxElement&&(this._checkboxElement.checked=this._isChecked),this.changed())},enumerable:!0,configurable:!0}),t.creationIndex=0,t}(n(3).InputControl);t.CheckBox=a},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._label="",t._checkboxElement=null,t._spanElement=null,t}return r(t,e),t.createId=function(){var e=t.creationIndex;return t.creationIndex++,e},t.prototype.changed=function(){this.onChange&&this.onChange(this)},t.prototype.keyDown=function(e){switch(e.keyCode){case o.KEY_ENTER:this.isChecked=!this.isChecked}},t.prototype.attach=function(n){var i=this;e.prototype.attach.call(this,n),n.className="ms-ctrl ms-ctrl-radiobutton",n.tabIndex=0;var r=n.attributes.label;r&&(this._label=r.value);var o=n.attributes.ischecked;o&&(this._isChecked="true"===o.value),this._checkboxElement=document.createElement("input"),this._checkboxElement.id="ms-ctrl-radio-"+t.createId(),this._checkboxElement.type="radio",this._checkboxElement.style.position="absolute",this._checkboxElement.checked=this.isChecked,this._checkboxElement.onchange=function(e){i.changed()};var a=n.attributes.groupname;a&&(this._checkboxElement.name=a.value);var s=document.createElement("label");s.htmlFor=this._checkboxElement.id,this._spanElement=document.createElement("span"),this._spanElement.innerText=this._label,s.appendChild(this._spanElement),n.innerHTML="",n.appendChild(this._checkboxElement),n.appendChild(s)},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},set:function(e){this._label=e,this._spanElement&&(this._spanElement.innerText=this._label)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isChecked",{get:function(){return this._isChecked},set:function(e){this._isChecked!=e&&(this._isChecked=e,this._checkboxElement&&(this._checkboxElement.checked=this._isChecked),this.changed())},enumerable:!0,configurable:!0}),t.creationIndex=0,t}(n(3).InputControl);t.RadioButton=a},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(3),s=function(){function e(){}return e.prototype.changed=function(){this.onChange&&this.onChange()},e}(),l=function(e){function t(){var t=e.call(this)||this;return t._inputElement=document.createElement("input"),t._inputElement.className="ms-ctrl ms-ctrl-textbox",t._inputElement.type="text",t._inputElement.oninput=function(e){t.changed()},t}return r(t,e),Object.defineProperty(t.prototype,"element",{get:function(){return this._inputElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{set:function(e){this._inputElement.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCount",{set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLength",{set:function(e){this._inputElement.maxLength!=e&&(this._inputElement.maxLength=e,this.value=this.value.substr(0,e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._inputElement.value},set:function(e){this._inputElement.value=e},enumerable:!0,configurable:!0}),t}(s),c=function(e){function t(){var t=e.call(this)||this;return t._textareaElement=document.createElement("textarea"),t._textareaElement.className="ms-ctrl ms-ctrl-textbox ms-ctrl-textbox-multiline",t._textareaElement.oninput=function(e){t.changed()},t}return r(t,e),Object.defineProperty(t.prototype,"element",{get:function(){return this._textareaElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{set:function(e){this._textareaElement.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCount",{set:function(e){this._textareaElement.rows=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLength",{set:function(e){this._textareaElement.maxLength!=e&&(this._textareaElement.maxLength=e,this.value=this.value.substr(0,e))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._textareaElement.value},set:function(e){this._textareaElement.value=e},enumerable:!0,configurable:!0}),t}(s),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._isMultiline=!1,t._lineCount=3,t}return r(t,e),t.prototype.editBoxChanged=function(){this.onChange&&this.onChange(this)},t.prototype.recreateEditBox=function(){var e=this,t=null;t=this._editBox?this._editBox.value:this.rootElement.innerText,this._isMultiline?this._editBox=new c:this._editBox=new l,t&&(this._editBox.value=t),this._editBox.lineCount=this._lineCount,this._editBox.maxLength=this._maxLength,this._editBox.placeholder=this._placeholder,this._editBox.onChange=function(){e.editBoxChanged()},this.rootElement.innerHTML="",this.rootElement.appendChild(this._editBox.element)},Object.defineProperty(t.prototype,"editBox",{get:function(){return this._editBox||this.recreateEditBox(),this._editBox},enumerable:!0,configurable:!0}),t.prototype.attach=function(t){e.prototype.attach.call(this,t),this._isMultiline=o.getAttributeValueAsBool(t,"ismultiline",!1),this._lineCount=o.getAttributeValueAsInt(t,"lines",3),this._maxLength=o.getAttributeValueAsInt(t,"maxlength",5e4),this._placeholder=o.getAttributeValueAsString(t,"placeholder",null),this.recreateEditBox()},Object.defineProperty(t.prototype,"value",{get:function(){return this.editBox.value},set:function(e){this.editBox.value=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._placeholder},set:function(e){this._placeholder=e,this.editBox.placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMultiline",{get:function(){return this._isMultiline},set:function(e){this._isMultiline!=e&&(this._isMultiline=e,this.recreateEditBox())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineCount",{get:function(){return this._lineCount},set:function(e){e>0&&(this._lineCount=e,this.editBox.lineCount=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLength",{get:function(){return this._maxLength},set:function(e){e>0&&(this._maxLength=e,this.editBox.maxLength=e)},enumerable:!0,configurable:!0}),t}(a.InputControl);t.TextBox=u},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),a=n(2),s=n(15),l=function(e){function t(){var t=e.call(this)||this;return t._items=new s.Collection,t._renderedItems=[],t._selectedIndex=-1,t}return r(t,e),t.prototype.renderContent=function(){var e=document.createElement("div");e.className="ms-ctrl ms-popup";for(var t=0;t<this._items.length;t++){var n=this._items.get(t).render();n.tabIndex=0,e.appendChild(n),t==this.selectedIndex&&n.focus(),this._renderedItems.push(n)}return e},t.prototype.keyDown=function(t){e.prototype.keyDown.call(this,t);var n=this._selectedIndex;switch(t.keyCode){case a.KEY_TAB:this.close();break;case a.KEY_UP:n<=0?n=this._renderedItems.length-1:--n<0&&(n=this._renderedItems.length-1),this.selectedIndex=n,t.cancelBubble=!0;break;case a.KEY_DOWN:n<0?n=0:++n>=this._renderedItems.length&&(n=0),this.selectedIndex=n,t.cancelBubble=!0}},t.prototype.popup=function(e){var t=this;if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className="ms-ctrl-overlay",this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=function(e){t.closePopup()},document.body.appendChild(this._overlayElement);var n=e.getBoundingClientRect();this._popupControlElement=this.render(n),this._popupControlElement.classList.remove("ms-ctrl-slide","ms-ctrl-slideLeftToRight","ms-ctrl-slideRightToLeft","ms-ctrl-slideTopToBottom","ms-ctrl-slideRightToLeft"),this._overlayElement.appendChild(this._popupControlElement);var i,r=this._popupControlElement.getBoundingClientRect(),a=window.innerHeight-n.bottom,s=n.top,l=n.left+o.getScrollX();if(s<r.height&&a<r.height){var c=window.innerHeight;this._popupControlElement.style.maxHeight=c+"px",i=c<r.height?o.getScrollY():o.getScrollY()+n.top+(n.height-c)/2;var u=window.innerWidth-n.right;if(n.left<r.width&&u<r.width){var p=window.innerWidth;this._popupControlElement.style.maxWidth=p+"px",l=p<r.width?o.getScrollX():o.getScrollX()+n.left+(n.width-p)/2}else u>=r.width?(l=o.getScrollX()+n.right,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideLeftToRight")):(l=o.getScrollX()+n.left-r.width,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideRightToLeft"))}else a>=r.height?(i=o.getScrollY()+n.bottom,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideTopToBottom")):(i=o.getScrollY()+n.top-r.height,this._popupControlElement.classList.add("ms-ctrl-slide","ms-ctrl-slideBottomToTop"));this._popupControlElement.style.left=l+"px",this._popupControlElement.style.top=i+"px",this._popupControlElement.focus(),this._isOpen=!0}},t.prototype.closePopup=function(){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1)},Object.defineProperty(t.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){e>=0&&e<this._renderedItems.length&&(this._renderedItems[e].focus(),this._selectedIndex=e)},enumerable:!0,configurable:!0}),t}(n(10).PopupControl);t.PopupMenu=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(27),r=n(28),o=function(){function e(){this._parts=[],this._shouldDropOwner=!1}return e.parse=function(t){var n=new e,r=0;do{var o=!1,a=r,s=void 0;do{s=!1,(a=t.indexOf("{",a))>=0&&a+1<t.length&&"{"===t[a+1]&&(a+=2,s=!0)}while(s);if(a>=0){var l=t.indexOf("}",a);if(l>=0){o=!0,a>r&&n._parts.push(t.substring(r,a));var c=t.substring(a,l+1),u=void 0;try{u=i.ExpressionParser.parseBinding(c)}catch(e){u=c}n._parts.push(u),r=l+1}}if(!o){n._parts.push(t.substr(r));break}}while(r<t.length);return 1===n._parts.length&&"string"==typeof n._parts[0]?n._parts[0]:n},e.prototype.evalExpression=function(e,t){var n=e.evaluate(t);return void 0===n&&(this._shouldDropOwner=this._shouldDropOwner||!e.allowNull),n},e.prototype.internalEvaluate=function(e){if(0!==this._parts.length){if(1===this._parts.length)return"string"==typeof this._parts[0]?this._parts[0]:this.evalExpression(this._parts[0],e);for(var t="",n=0,i=this._parts;n<i.length;n++){var o=i[n];if("string"==typeof o)t+=o;else{var a=this.evalExpression(o,e);void 0===a&&(a=r.GlobalSettings.undefinedExpressionValueSubstitutionString?r.GlobalSettings.undefinedExpressionValueSubstitutionString:o.expressionString),t+=a}}return t}},e.prototype.evaluate=function(e){return this._shouldDropOwner=!1,this.internalEvaluate(e)},Object.defineProperty(e.prototype,"shouldDropOwner",{get:function(){return this._shouldDropOwner},enumerable:!0,configurable:!0}),e}(),a=function(){function e(t){this.preparedPayload=e.prepare(t)}return e.prepare=function(t){if("string"==typeof t)return o.parse(t);if("object"==typeof t&&null!==t){if(Array.isArray(t)){for(var n=[],i=0,r=t;i<r.length;i++){var a=r[i];n.push(e.prepare(a))}return n}n={};for(var s=0,l=Object.keys(t);s<l.length;s++){var c=l[s];n[c]=e.prepare(t[c])}return n}return t},e.prototype.expandSingleObject=function(e){for(var t={},n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(!this._context.isReservedField(r)){var o=this.internalExpand(e[r]);void 0!==o&&(t[r]=o)}}return t},e.prototype.internalExpand=function(e){var t;if(this._context.saveState(),Array.isArray(e)){for(var n=[],i=0,r=e;i<r.length;i++){var a=r[i],s=this.internalExpand(a);null!==s&&(Array.isArray(s)?n=n.concat(s):n.push(s))}t=n}else if(e instanceof o)t=e.evaluate(this._context),e.shouldDropOwner&&(t=null);else if("object"==typeof e&&null!==e){var l=!1,c=e.$when;if(c instanceof o){var u=void 0;try{"boolean"!=typeof(u=c.evaluate(this._context))&&(u=!1)}catch(e){u=!1}l=!u}if(l)t=null;else{var p=e.$data;if(void 0!==p)if(p instanceof o&&(p=p.evaluate(this._context)),Array.isArray(p)){t=[];for(var d=0;d<p.length;d++){this._context.$data=p[d],this._context.$index=d;var h=this.expandSingleObject(e);null!==h&&t.push(h)}}else this._context.$data=p,t=this.expandSingleObject(e);else t=this.expandSingleObject(e)}}else t=e;return this._context.restoreLastState(),t},e.prototype.expand=function(e){return this._context=e,this.internalExpand(this.preparedPayload)},e}();t.Template=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(49),r=n(0),o=n(29),a=n(9),s=n(50),l=n(52),c=n(53),u=n(32),p=n(11),d=n(33),h=n(12),f=n(34),m=n(17),g=n(36),y=n(54),v=n(20),b=n(8),_=function(){function e(t){void 0===t&&(t=null),this._isAttached=!1,this._isMonacoEditorLoaded=!1,this._undoStack=[],this._undoStackIndex=-1,this.preventCardUpdate=!1,this._cardEditorUpdateCounter=0,this.preventJsonUpdate=!1,this._fullScreenHandler=new c.FullScreenHandler,this.toolbar=new u.Toolbar,this.sampleCatalogueUrl=void 0,r.AdaptiveCard.enableFullJsonRoundTrip=!0,r.AdaptiveCard.onProcessMarkdown=function(t,n){e.internalProcessMarkdown(t,n)},this._hostContainers=t||[],this.prepareToolbar()}return e.internalProcessMarkdown=function(t,n){e.onProcessMarkdown?e.onProcessMarkdown(t,n):window.markdownit&&(n.outputHtml=window.markdownit().render(t),n.didProcess=!0)},e.prototype.togglePreview=function(){this._designerSurface.isPreviewMode=!this._designerSurface.isPreviewMode,this._designerSurface.isPreviewMode?this._togglePreviewButton.toolTip="Return to Design mode":(this._togglePreviewButton.toolTip="Switch to Preview mode",this._designerSurface.updateLayout()),this.buildTreeView()},e.prototype.buildTreeView=function(){this._treeViewToolbox.content&&(this._treeViewToolbox.content.innerHTML="",this.designerSurface.isPreviewMode?this.treeViewToolbox.content.innerHTML='<div style="padding: 8px; display: flex; justify-content: center;"><div>The Card Structure isn\'t available in Preview mode.</div></div>':this._treeViewToolbox.content.appendChild(this.designerSurface.rootPeer.treeItem.render()))},e.prototype.setupDataTreeItemEvents=function(e){var t=this;e.onStartDrag=function(n){t._draggedPaletteItem=new d.DataPaletteItem(e.field),t._draggedElement=t._draggedPaletteItem.renderDragVisual(),t._draggedElement.style.position="absolute",t._draggedElement.style.left=t._currentMousePosition.x+"px",t._draggedElement.style.top=t._currentMousePosition.y+"px",document.body.appendChild(t._draggedElement),e.endDrag()};for(var n=0;n<e.getChildCount();n++)this.setupDataTreeItemEvents(e.getChildAt(n))},e.prototype.buildDataExplorer=function(){if(this._dataToolbox&&this._dataToolbox.content&&(this._dataToolbox.content.innerHTML="",this._dataStructure)){var e=new y.DataTreeItem(this._dataStructure);this._dataToolbox.content.appendChild(e.render()),this.setupDataTreeItemEvents(e)}},e.prototype.buildPropertySheet=function(e){if(this._propertySheetToolbox.content){this._propertySheetToolbox.content.innerHTML="";var t=void 0;e?t=e.buildPropertySheetCard(this.currentTargetVersion):((t=new r.AdaptiveCard).parse({type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",wrap:!0,text:"**Nothing is selected**"},{type:"TextBlock",wrap:!0,text:"Select an element in the card to modify its properties."}]}),t.padding=new r.PaddingDefinition(r.Spacing.Small,r.Spacing.Small,r.Spacing.Small,r.Spacing.Small)),t.hostConfig=p.defaultHostConfig,this._propertySheetToolbox.content.appendChild(t.render())}},e.prototype.addPaletteItem=function(e,t){var n=this;e.render(),e.onStartDrag=function(e){n._draggedPaletteItem=e,n._draggedElement=e.renderDragVisual(),n._draggedElement.style.position="absolute",n._draggedElement.style.left=n._currentMousePosition.x+"px",n._draggedElement.style.top=n._currentMousePosition.y+"px",document.body.appendChild(n._draggedElement)},t.appendChild(e.renderedElement)},e.prototype.buildPalette=function(){if(this._isAttached){this._toolPaletteToolbox.content.innerHTML="";for(var e={},t=0;t<r.AdaptiveCard.elementTypeRegistry.getItemCount();t++){var n=r.AdaptiveCard.elementTypeRegistry.getItemAt(t).createInstance(),i=a.CardDesignerSurface.cardElementPeerRegistry.findTypeRegistration(n.constructor);if(i){e.hasOwnProperty(i.category)||(e[i.category]=[]);var o=new d.ElementPaletteItem(r.AdaptiveCard.elementTypeRegistry.getItemAt(t),i);e[i.category].push(o)}}if(this.customPaletteItems)for(var s=0,l=this.customPaletteItems;s<l.length;s++){var c=l[s];e.hasOwnProperty(c.category)||(e[c.category]=[]),e[c.category].push(c)}for(var u in e){var p=document.createElement("div");p.innerText=u,p.className="acd-palette-category",this._toolPaletteToolbox.content.appendChild(p);for(var h=0;h<e[u].length;h++)this.addPaletteItem(e[u][h],this._toolPaletteToolbox.content)}}},e.prototype.endDrag=function(){this._draggedPaletteItem&&(this._draggedPaletteItem.endDrag(),this._draggedElement.remove(),this._draggedPaletteItem=null,this._draggedElement=null)},e.prototype.renderErrorPaneElement=function(e,t){var n=this,i=document.createElement("div");return i.className="acd-error-pane-message",t&&(i.classList.add("selectable"),i.title="Click to select this element",i.onclick=function(e){var i=n.designerSurface.findPeer(t);i&&(i.isSelected=!0,i.scrollIntoView())}),i.innerText=e,i},e.prototype.recreateDesignerSurface=function(){var e=this,t=document.getElementById("adaptiveCardStylesheet");null==t&&((t=document.createElement("link")).id="adaptiveCardStylesheet",document.getElementsByTagName("head")[0].appendChild(t)),t.rel="stylesheet",t.type="text/css",p.Utils.isAbsoluteUrl(this.activeHostContainer.styleSheet)?t.href=this.activeHostContainer.styleSheet:t.href=p.Utils.joinPaths(this._assetPath,this.activeHostContainer.styleSheet);var n=document.getElementById("cardArea");n&&(n.style.backgroundColor=this.activeHostContainer.getBackgroundColor()),this.activeHostContainer.initialize(),this._designerHostElement.innerHTML="",this.activeHostContainer.renderTo(this._designerHostElement);var i=!!this._designerSurface&&this._designerSurface.isPreviewMode;this._designerSurface=new a.CardDesignerSurface(this.activeHostContainer.cardHost),this._designerSurface.fixedHeightCard=this.activeHostContainer.isFixedHeight,this._designerSurface.onSelectedPeerChanged=function(t){e.buildPropertySheet(t)},this._designerSurface.onLayoutUpdated=function(t){t&&e.scheduleUpdateJsonFromCard(),e.buildTreeView()},this._designerSurface.onCardValidated=function(t,n){var i=document.getElementById("errorPane");if(i.innerHTML="",t.length>0){for(var r=[],o=0,a=t;o<a.length;o++){var s=a[o];r.indexOf(s.message)<0&&r.push(s.message)}for(var l=0,c=r;l<c.length;l++){var u=c[l];i.appendChild(e.renderErrorPaneElement("[Error] "+u))}}if(n.failures.length>0)for(var p=0,d=n.failures;p<d.length;p++)for(var h=d[p],f=0,m=h.errors;f<m.length;f++){s=m[f];i.appendChild(e.renderErrorPaneElement("["+h.cardObject.getJsonTypeName()+"] "+s.message,h.cardObject))}i.childElementCount>0?i.classList.remove("acd-hidden"):i.classList.add("acd-hidden")},this.buildPalette(),this.buildPropertySheet(null),this._card&&(this._card.hostConfig=this.activeHostContainer.getHostConfig()),this._designerSurface.card=this._card,this.updateSampleData(),this._designerSurface.isPreviewMode=i,this.updateFullLayout()},e.prototype.activeHostContainerChanged=function(){this.recreateDesignerSurface(),this.onActiveHostContainerChanged&&this.onActiveHostContainerChanged(this)},e.prototype.updateToolboxLayout=function(e,t){if(e){var n=e.getHeaderBoundingRect();e.content.style.height=t.height-n.height+"px"}},e.prototype.updateJsonEditorsLayout=function(){if(this._isMonacoEditorLoaded){var e=this._jsonEditorsPanel.contentHost.getBoundingClientRect();this.updateToolboxLayout(this._cardEditorToolbox,e),this._cardEditor.layout(),this._sampleDataEditorToolbox&&(this.updateToolboxLayout(this._sampleDataEditorToolbox,e),this._sampleDataEditor.layout())}},e.prototype.updateFullLayout=function(){this.scheduleLayoutUpdate(),this.updateJsonEditorsLayout()},e.prototype.cardPayloadChanged=function(){this.onCardPayloadChanged&&this.onCardPayloadChanged(this)},e.prototype.beginCardEditorUpdate=function(){this._cardEditorUpdateCounter++},e.prototype.endCardEditorUpdate=function(){this._cardEditorUpdateCounter>0&&this._cardEditorUpdateCounter--},e.prototype.setCardPayload=function(e,t){if(this._isMonacoEditorLoaded){this.beginCardEditorUpdate();try{this._cardEditor.setValue(JSON.stringify(e,null,4)),this.updateCardFromJson(t)}finally{this.endCardEditorUpdate()}}this.cardPayloadChanged()},e.prototype.setSampleDataPayload=function(e){this._isMonacoEditorLoaded&&this._sampleDataEditor&&this._sampleDataEditor.setValue(JSON.stringify(e,null,4))},e.prototype.updateJsonFromCard=function(e){void 0===e&&(e=!0);try{if(this.preventCardUpdate=!0,!this.preventJsonUpdate&&this._isMonacoEditorLoaded){var t=this.card.toJSON();this.setCardPayload(t,e)}}finally{this.preventCardUpdate=!1}},e.prototype.scheduleUpdateJsonFromCard=function(){var e=this;clearTimeout(this.jsonUpdateTimer),this.preventJsonUpdate||(this.jsonUpdateTimer=setTimeout(function(){e.updateJsonFromCard()},100))},e.prototype.getCurrentCardEditorPayload=function(){return this._isMonacoEditorLoaded?this._cardEditor.getValue():o.defaultPayload},e.prototype.getCurrentSampleDataEditorPayload=function(){return this._isMonacoEditorLoaded&&this._sampleDataEditor?this._sampleDataEditor.getValue():""},e.prototype.updateCardFromJson=function(e){try{this.preventJsonUpdate=!0;var t=this.getCurrentCardEditorPayload();if(e)try{var n=JSON.parse(t);this.addToUndoStack(n)}catch(e){}this.preventCardUpdate||(this.designerSurface.setCardPayloadAsString(t),this.cardPayloadChanged())}finally{this.preventJsonUpdate=!1}},e.prototype.scheduleUpdateCardFromJson=function(){var e=this;clearTimeout(this.cardUpdateTimer),this.preventCardUpdate||(this.cardUpdateTimer=setTimeout(function(){e.updateCardFromJson(!0)},300))},e.prototype.scheduleLayoutUpdate=function(){var e=this;clearTimeout(this.updateLayoutTimer),this.updateLayoutTimer=setTimeout(function(){e.designerSurface.updateLayout(!1)},50)},e.prototype.prepareToolbar=function(){var t=this;if(b.GlobalSettings.showVersionPicker){this._versionChoicePicker=new u.ToolbarChoicePicker(e.ToolbarCommands.VersionPicker),this._versionChoicePicker.label="Target version:",this._versionChoicePicker.width=80,this._versionChoicePicker.alignment=u.ToolbarElementAlignment.Right,this._versionChoicePicker.separator=!0;for(var n=0;n<b.SupportedTargetVersions.length;n++)this._versionChoicePicker.choices.push({name:b.SupportedTargetVersions[n].label,value:n.toString()});this.toolbar.addElement(this._versionChoicePicker)}this._fullScreenButton=new u.ToolbarButton(e.ToolbarCommands.FullScreen,"Enter Full Screen","acd-icon-fullScreen",function(e){t._fullScreenHandler.toggleFullScreen()}),this._fullScreenButton.displayCaption=!1,this._fullScreenButton.toolTip="Enter full screen",this._fullScreenButton.alignment=u.ToolbarElementAlignment.Right,this._fullScreenButton.isVisible=!1,this.toolbar.addElement(this._fullScreenButton);var i=new u.ToolbarButton(e.ToolbarCommands.OpenPayload,"Open Sample","acd-icon-open",function(e){var n=new s.SamplePickerDialog;n.title="Pick a sample",n.width="30%",n.height="60%",n.catalogueUrl=t.sampleCatalogueUrl,n.onClose=function(e){n.selectedSample&&(n.selectedSample.onDownloaded=function(){try{var e=JSON.parse(n.selectedSample.cardPayload);t.setCardPayload(e,!0)}catch(e){alert("The sample could not be loaded.")}if(!r.isNullOrEmpty(n.selectedSample.sampleData))try{var i=JSON.parse(n.selectedSample.sampleData);t.setSampleDataPayload(i),t.dataStructure=g.FieldDefinition.create(i)}catch(e){alert("The sample could not be loaded.")}},n.selectedSample.download())},n.open()});if(this.toolbar.addElement(i),this._hostContainers&&this._hostContainers.length>0){this._hostContainerChoicePicker=new u.ToolbarChoicePicker(e.ToolbarCommands.HostAppPicker),this._hostContainerChoicePicker.separator=!0,this._hostContainerChoicePicker.label="Select host app:",this._hostContainerChoicePicker.width=350;for(n=0;n<this._hostContainers.length;n++)this._hostContainerChoicePicker.choices.push({name:this._hostContainers[n].name,value:n.toString()});this._hostContainerChoicePicker.onChanged=function(e){t.activeHostContainer=t._hostContainers[Number.parseInt(t._hostContainerChoicePicker.value)],t.activeHostContainerChanged()},this.toolbar.addElement(this._hostContainerChoicePicker)}this._undoButton=new u.ToolbarButton(e.ToolbarCommands.Undo,"Undo","acd-icon-undo",function(e){t.undo()}),this._undoButton.separator=!0,this._undoButton.toolTip="Undo your last change",this._undoButton.isEnabled=!1,this._undoButton.displayCaption=!1,this.toolbar.addElement(this._undoButton),this._redoButton=new u.ToolbarButton(e.ToolbarCommands.Redo,"Redo","acd-icon-redo",function(e){t.redo()}),this._redoButton.toolTip="Redo your last changes",this._redoButton.isEnabled=!1,this._redoButton.displayCaption=!1,this.toolbar.addElement(this._redoButton),this._newCardButton=new u.ToolbarButton(e.ToolbarCommands.NewCard,"New card","acd-icon-newCard",function(e){t.newCard()}),this._newCardButton.separator=!0,this.toolbar.addElement(this._newCardButton),this._copyJSONButton=new u.ToolbarButton(e.ToolbarCommands.CopyJSON,"Copy card JSON","acd-icon-copy"),this.toolbar.addElement(this._copyJSONButton),this._togglePreviewButton=new u.ToolbarButton(e.ToolbarCommands.TogglePreview,"Preview mode","acd-icon-preview",function(e){t.togglePreview()}),this._togglePreviewButton.separator=!0,this._togglePreviewButton.allowToggle=!0,this._togglePreviewButton.isVisible=b.GlobalSettings.enableDataBindingSupport,this.toolbar.addElement(this._togglePreviewButton),this._fullScreenHandler=new c.FullScreenHandler,this._fullScreenHandler.onFullScreenChanged=function(e){t._fullScreenButton.toolTip=e?"Exit full screen":"Enter full screen",t.updateFullLayout()}},e.prototype.onResize=function(){this._cardEditor.layout(),this._sampleDataEditor&&this._sampleDataEditor.layout()},e.prototype.updateSampleData=function(){try{this._sampleData=JSON.parse(this.getCurrentSampleDataEditorPayload()),this.designerSurface.sampleData=this._sampleData}catch(e){}},e.prototype.monacoModuleLoaded=function(e){var t=this;void 0===e&&(e=null),e||(e=window.monaco);var n={schemas:[{uri:"http://adaptivecards.io/schemas/adaptive-card.json",schema:l.adaptiveCardSchema,fileMatch:["*"]}],validate:!1,allowComments:!0};e.languages.json.jsonDefaults.setDiagnosticsOptions(n),this._cardEditorToolbox.content=document.createElement("div"),this._cardEditorToolbox.content.style.overflow="hidden",this._cardEditor=e.editor.create(this._cardEditorToolbox.content,{folding:!0,fontSize:13.5,language:"json",minimap:{enabled:!1}}),this._cardEditor.onDidChangeModelContent(function(){0==t._cardEditorUpdateCounter&&t.scheduleUpdateCardFromJson()}),this._sampleDataEditorToolbox&&(this._sampleDataEditorToolbox.content=document.createElement("div"),this._sampleDataEditorToolbox.content.style.overflow="hidden",this._sampleDataEditor=e.editor.create(this._sampleDataEditorToolbox.content,{folding:!0,fontSize:13.5,language:"json",minimap:{enabled:!1}}),this._sampleDataEditor.onDidChangeModelContent(function(){t.updateSampleData()})),window.addEventListener("resize",function(){t.onResize()}),this._isMonacoEditorLoaded=!0,this.updateJsonEditorsLayout(),this.updateJsonFromCard(!1)},e.prototype.updateToolbar=function(){this._undoButton.isEnabled=this.canUndo,this._redoButton.isEnabled=this.canRedo},e.prototype.addToUndoStack=function(t){var n=!0;if(this._undoStack.length>0&&(n=this._undoStack[this._undoStack.length-1]!=t),n){var i=this._undoStack.length-(this._undoStackIndex+1);i>0&&this._undoStack.splice(this._undoStackIndex+1,i),this._undoStack.push(t),this._undoStack.length>e.MAX_UNDO_STACK_SIZE&&this._undoStack.splice(0,1),this._undoStackIndex=this._undoStack.length-1,this.updateToolbar()}},e.prototype.handlePointerUp=function(e){this.endDrag(),this.designerSurface.endDrag()},e.prototype.handlePointerMove=function(e){this._currentMousePosition={x:e.x,y:e.y};var t=this.designerSurface.isPointerOver(this._currentMousePosition.x,this._currentMousePosition.y),n=!1;if(this._draggedPaletteItem&&t){var i=this._draggedPaletteItem.createPeer(this.designerSurface),r=this.designerSurface.pageToClientCoordinates(this._currentMousePosition.x,this._currentMousePosition.y);this.designerSurface.tryDrop(r,i)&&(this.endDrag(),this.designerSurface.startDrag(i),n=!0)}!n&&this._draggedElement&&(this._draggedElement.style.left=this._currentMousePosition.x-10+"px",this._draggedElement.style.top=this._currentMousePosition.y-10+"px")},e.prototype.attachTo=function(e){var t=this,n=document.createElement("link");n.id="__ac-designer",n.rel="stylesheet",n.type="text/css",n.href=p.Utils.joinPaths(this._assetPath,"adaptivecards-designer.css"),document.getElementsByTagName("head")[0].appendChild(n),this._hostContainers&&this._hostContainers.length>0?this._activeHostContainer=this._hostContainers[0]:this._activeHostContainer=new h.DefaultContainer("Default","adaptivecards-defaulthost.css"),e.style.flex="1 1 auto",e.style.display="flex",e.style.flexDirection="column",e.style.overflow="hidden",e.innerHTML='<div id="toolbarHost"></div><div class="content" style="display: flex; flex: 1 1 auto; overflow-y: hidden;"><div id="leftCollapsedPaneTabHost" class="acd-verticalCollapsedTabContainer acd-dockedLeft" style="border-right: 1px solid #D2D2D2;"></div><div id="toolPalettePanel" class="acd-toolPalette-pane"></div><div style="display: flex; flex-direction: column; flex: 1 1 100%; overflow: hidden;"><div style="display: flex; flex: 1 1 100%; overflow: hidden;"><div id="cardArea" class="acd-designer-cardArea"><div style="flex: 1 1 100%; overflow: auto;"><div id="designerHost" style="margin: 20px 40px 20px 20px;"></div></div><div id="errorPane" class="acd-error-pane acd-hidden"></div></div><div id="treeViewPanel" class="acd-treeView-pane"></div><div id="propertySheetPanel" class="acd-propertySheet-pane"></div></div><div id="jsonEditorPanel" class="acd-json-editor-pane"></div><div id="bottomCollapsedPaneTabHost" class="acd-horizontalCollapsedTabContainer" style="border-top: 1px solid #D2D2D2;"></div></div><div id="rightCollapsedPaneTabHost" class="acd-verticalCollapsedTabContainer acd-dockedRight" style="border-left: 1px solid #D2D2D2;"></div></div>',this.toolbar.attachTo(document.getElementById("toolbarHost")),this._versionChoicePicker&&(this._versionChoicePicker.selectedIndex=b.SupportedTargetVersions.indexOf(b.Versions.v1_2),this._versionChoicePicker.onChanged=function(e){t.buildPropertySheet(t._designerSurface.selectedPeer)}),this._copyJSONButton.isVisible&&new i(this._copyJSONButton.renderedElement,{text:function(e){return JSON.stringify(t.card.toJSON(),null,4)}});var o=document.createElement("div");o.className="acd-dockedPane",this._toolPaletteToolbox=new m.Toolbox("toolPalette",v.Strings.toolboxes.toolPalette.title),this._toolPaletteToolbox.content=o;var a=new f.SidePanel("toolPalettePanel",f.SidePanelAlignment.Left,document.getElementById("leftCollapsedPaneTabHost"));a.addToolbox(this._toolPaletteToolbox),a.isResizable=!1,a.attachTo(document.getElementById("toolPalettePanel")),this._cardEditorToolbox=new m.Toolbox("cardEditor",v.Strings.toolboxes.cardEditor.title),this._cardEditorToolbox.content=document.createElement("div"),this._cardEditorToolbox.content.style.padding="8px",this._cardEditorToolbox.content.innerText=v.Strings.loadingEditor,this._jsonEditorsPanel=new f.SidePanel("jsonEditorPanel",f.SidePanelAlignment.Bottom,document.getElementById("bottomCollapsedPaneTabHost")),this._jsonEditorsPanel.onResized=function(e){t.updateJsonEditorsLayout()},this._jsonEditorsPanel.onToolboxResized=function(e){t.updateJsonEditorsLayout()},this._jsonEditorsPanel.onToolboxExpandedOrCollapsed=function(e){t.updateJsonEditorsLayout()},this._jsonEditorsPanel.addToolbox(this._cardEditorToolbox),b.GlobalSettings.enableDataBindingSupport&&b.GlobalSettings.showSampleDataEditorToolbox&&(this._sampleDataEditorToolbox=new m.Toolbox("sampleDataEditor",v.Strings.toolboxes.sampleDataEditor.title),this._sampleDataEditorToolbox.content=document.createElement("div"),this._sampleDataEditorToolbox.content.style.padding="8px",this._sampleDataEditorToolbox.content.innerText=v.Strings.loadingEditor,this._sampleDataEditorToolbox.commands=[{title:"Copy the structure of this data into the Data Structure toolbox",iconClass:"acd-icon-dataStructure",execute:function(e){t.dataStructure=g.FieldDefinition.create(JSON.parse(t.getCurrentSampleDataEditorPayload()))}}],this._jsonEditorsPanel.addToolbox(this._sampleDataEditorToolbox)),this._jsonEditorsPanel.attachTo(document.getElementById("jsonEditorPanel"));var s=document.createElement("div");s.className="acd-propertySheet-host",this._propertySheetToolbox=new m.Toolbox("propertySheet",v.Strings.toolboxes.propertySheet.title),this._propertySheetToolbox.content=s;var l=new f.SidePanel("propertySheetPanel",f.SidePanelAlignment.Right,document.getElementById("rightCollapsedPaneTabHost"));l.addToolbox(this._propertySheetToolbox),l.onResized=function(e){t.scheduleLayoutUpdate()},l.attachTo(document.getElementById("propertySheetPanel"));var c=document.createElement("div");c.className="acd-treeView-host",this._treeViewToolbox=new m.Toolbox("treeView",v.Strings.toolboxes.cardStructure.title),this._treeViewToolbox.content=c;var u=new f.SidePanel("treeViewPanel",f.SidePanelAlignment.Right,document.getElementById("rightCollapsedPaneTabHost"));if(u.addToolbox(this._treeViewToolbox),u.onResized=function(e){t.scheduleLayoutUpdate()},b.GlobalSettings.enableDataBindingSupport&&b.GlobalSettings.showDataStructureToolbox){var d=document.createElement("div");d.className="acd-treeView-host",this._dataToolbox=new m.Toolbox("data",v.Strings.toolboxes.dataStructure.title),this._dataToolbox.content=d,u.addToolbox(this._dataToolbox)}u.attachTo(document.getElementById("treeViewPanel")),this._designerHostElement=document.getElementById("designerHost"),window.addEventListener("pointermove",function(e){t.handlePointerMove(e)}),window.addEventListener("resize",function(){t.scheduleLayoutUpdate()}),window.addEventListener("pointerup",function(e){t.handlePointerUp(e)}),this._isAttached=!0,this.recreateDesignerSurface();var y=new r.AdaptiveCard;y.onImageLoaded=function(e){t.scheduleLayoutUpdate()},this.card=y},e.prototype.undo=function(){if(this.canUndo){this._undoStackIndex--;var e=this._undoStack[this._undoStackIndex];this.setCardPayload(e,!1),this.updateToolbar()}},e.prototype.redo=function(){if(this._undoStackIndex<this._undoStack.length-1){this._undoStackIndex++;var e=this._undoStack[this._undoStackIndex];this.setCardPayload(e,!1),this.updateToolbar()}},e.prototype.newCard=function(){this.setCardPayload({type:"AdaptiveCard",version:"1.0",body:[]},!0)},e.prototype.setCard=function(e){try{this.preventJsonUpdate=!0,this.preventCardUpdate||this.designerSurface.setCardPayloadAsObject(e)}finally{this.preventJsonUpdate=!1}this.updateJsonFromCard()},e.prototype.getCard=function(){return this.designerSurface.card.toJSON()},Object.defineProperty(e.prototype,"currentTargetVersion",{get:function(){return this._versionChoicePicker?b.SupportedTargetVersions[parseInt(this._versionChoicePicker.value)]:b.Versions.latest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataStructure",{get:function(){return this._dataStructure},set:function(e){this._dataStructure=e,this.buildDataExplorer()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sampleData",{get:function(){return this._sampleData},set:function(e){this._sampleData=e,this.setSampleDataPayload(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeHostContainer",{get:function(){return this._activeHostContainer},set:function(e){this._activeHostContainer!==e&&(this._activeHostContainer=e,this.activeHostContainerChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canUndo",{get:function(){return this._undoStackIndex>=1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canRedo",{get:function(){return this._undoStackIndex<this._undoStack.length-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"card",{get:function(){return this._card},set:function(e){this._card!=e&&(this._card&&(this._card.designMode=!1),this._card=e,this._card&&(this._card.designMode=!0,this._card.hostConfig=this.activeHostContainer.getHostConfig()),this.recreateDesignerSurface(),this.updateCardFromJson(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"designerSurface",{get:function(){return this._designerSurface},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"treeViewToolbox",{get:function(){return this._treeViewToolbox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertySheetToolbox",{get:function(){return this._propertySheetToolbox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jsonEditorToolbox",{get:function(){return this._cardEditorToolbox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"toolPaletteToolbox",{get:function(){return this._toolPaletteToolbox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataToolbox",{get:function(){return this._dataToolbox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assetPath",{get:function(){return this._assetPath},set:function(e){this._assetPath=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customPaletteItems",{get:function(){return this._customPeletteItems},set:function(e){this._customPeletteItems=e,this.buildPalette()},enumerable:!0,configurable:!0}),e.onProcessMarkdown=null,e.MAX_UNDO_STACK_SIZE=50,e}();t.CardDesigner=_,function(e){var t=function(){function e(){}return e.FullScreen="__fullScreenButton",e.OpenPayload="__openPayload",e.HostAppPicker="__hostAppPicker",e.VersionPicker="__versionPicker",e.Undo="__undoButton",e.Redo="__redoButton",e.NewCard="__newCardButton",e.CopyJSON="__copyJsonButton",e.TogglePreview="__togglePreviewButton",e}();e.ToolbarCommands=t}(_=t.CardDesigner||(t.CardDesigner={})),t.CardDesigner=_},function(e,t,n){
/*!
 * clipboard.js v2.0.1
 * https://zenorocha.github.io/clipboard.js
 * 
 * Licensed MIT  Zeno Rocha
 */
var i;i=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){var i,r,o;r=[e,n(7)],void 0===(o="function"==typeof(i=function(e,t){"use strict";var n,i=(n=t)&&n.__esModule?n:{default:n},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolveOptions(t),this.initSelection()}return o(e,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=e.action,this.container=e.container,this.emitter=e.emitter,this.target=e.target,this.text=e.text,this.trigger=e.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var e=this,t="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return e.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[t?"right":"left"]="-9999px";var n=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=n+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,i.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,i.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var e=void 0;try{e=document.execCommand(this.action)}catch(t){e=!1}this.handleResult(e)}},{key:"handleResult",value:function(e){this.emitter.emit(e?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=e,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(e){if(void 0!==e){if(!e||"object"!==(void 0===e?"undefined":r(e))||1!==e.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&e.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(e.hasAttribute("readonly")||e.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=e}},get:function(){return this._target}}]),e}();e.exports=a})?i.apply(t,r):i)||(e.exports=o)},function(e,t,n){var i=n(6),r=n(5);e.exports=function(e,t,n){if(!e&&!t&&!n)throw new Error("Missing required arguments");if(!i.string(t))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(e))return function(e,t,n){return e.addEventListener(t,n),{destroy:function(){e.removeEventListener(t,n)}}}(e,t,n);if(i.nodeList(e))return function(e,t,n){return Array.prototype.forEach.call(e,function(e){e.addEventListener(t,n)}),{destroy:function(){Array.prototype.forEach.call(e,function(e){e.removeEventListener(t,n)})}}}(e,t,n);if(i.string(e))return function(e,t,n){return r(document.body,e,t,n)}(e,t,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function r(){i.off(e,r),t.apply(n,arguments)}return r._=t,this.on(e,r,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],r=[];if(i&&t)for(var o=0,a=i.length;o<a;o++)i[o].fn!==t&&i[o].fn._!==t&&r.push(i[o]);return r.length?n[e]=r:delete n[e],this}},e.exports=n},function(e,t,n){var i,r,o;r=[e,n(0),n(2),n(1)],void 0===(o="function"==typeof(i=function(e,t,n,i){"use strict";var r=s(t),o=s(n),a=s(i);function s(e){return e&&e.__esModule?e:{default:e}}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.resolveOptions(n),i.listenClick(e),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),c(t,[{key:"resolveOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof e.action?e.action:this.defaultAction,this.target="function"==typeof e.target?e.target:this.defaultTarget,this.text="function"==typeof e.text?e.text:this.defaultText,this.container="object"===l(e.container)?e.container:document.body}},{key:"listenClick",value:function(e){var t=this;this.listener=(0,a.default)(e,"click",function(e){return t.onClick(e)})}},{key:"onClick",value:function(e){var t=e.delegateTarget||e.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new r.default({action:this.action(t),target:this.target(t),text:this.text(t),container:this.container,trigger:t,emitter:this})}},{key:"defaultAction",value:function(e){return p("action",e)}},{key:"defaultTarget",value:function(e){var t=p("target",e);if(t)return document.querySelector(t)}},{key:"defaultText",value:function(e){return p("text",e)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],t="string"==typeof e?[e]:e,n=!!document.queryCommandSupported;return t.forEach(function(e){n=n&&!!document.queryCommandSupported(e)}),n}}]),t}(o.default);function p(e,t){var n="data-clipboard-"+e;if(t.hasAttribute(n))return t.getAttribute(n)}e.exports=u})?i.apply(t,r):i)||(e.exports=o)},function(e,t){var n=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var i=Element.prototype;i.matches=i.matchesSelector||i.mozMatchesSelector||i.msMatchesSelector||i.oMatchesSelector||i.webkitMatchesSelector}e.exports=function(e,t){for(;e&&e.nodeType!==n;){if("function"==typeof e.matches&&e.matches(t))return e;e=e.parentNode}}},function(e,t,n){var i=n(4);function r(e,t,n,r,o){var a=function(e,t,n,r){return function(n){n.delegateTarget=i(n.target,t),n.delegateTarget&&r.call(e,n)}}.apply(this,arguments);return e.addEventListener(n,a,o),{destroy:function(){e.removeEventListener(n,a,o)}}}e.exports=function(e,t,n,i,o){return"function"==typeof e.addEventListener?r.apply(null,arguments):"function"==typeof n?r.bind(null,document).apply(null,arguments):("string"==typeof e&&(e=document.querySelectorAll(e)),Array.prototype.map.call(e,function(e){return r(e,t,n,i,o)}))}},function(e,t){t.node=function(e){return void 0!==e&&e instanceof HTMLElement&&1===e.nodeType},t.nodeList=function(e){var n=Object.prototype.toString.call(e);return void 0!==e&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in e&&(0===e.length||t.node(e[0]))},t.string=function(e){return"string"==typeof e||e instanceof String},t.fn=function(e){return"[object Function]"===Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var i=window.getSelection(),r=document.createRange();r.selectNodeContents(e),i.removeAllRanges(),i.addRange(r),t=i.toString()}return t}}])},e.exports=i()},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(30),a=n(26),s=n(0),l=n(51),c=n(11),u=n(31),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.renderMessage=function(e){var t=this,n=new a.Template({type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:"**{title}**",size:"large"},{type:"Container",verticalContentAlignment:"center",height:"stretch",items:[{type:"TextBlock",text:"{message}",horizontalAlignment:"center",wrap:!0}]},{type:"ActionSet",horizontalAlignment:"right",actions:[{type:"Action.Submit",id:"cancel",title:"Cancel"}]}]}),i=new a.EvaluationContext;i.$root={title:this.title,message:e};var r=n.expand(i),o=new s.AdaptiveCard;o.hostConfig=c.defaultHostConfig,o.onExecuteAction=function(e){"cancel"==e.id&&t.close()},o.parse(r);var l=o.render();l.style.height="100%",this._renderedElement.innerHTML="",this._renderedElement.appendChild(l)},t.prototype.renderCatalogue=function(e){var t=this,n=new a.Template({type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:"**{title}**",size:"large"},{type:"Container",height:"stretch",allowVerticalOverflow:!0,items:[{type:"Container",$data:"{catalogue}",minHeight:"36px",verticalContentAlignment:"center",selectAction:{type:"Action.Submit",data:{catalogueIndex:"{$index}"}},spacing:"none",items:[{type:"TextBlock",text:"{displayName}",size:"medium"}]}]},{type:"ActionSet",horizontalAlignment:"right",actions:[{type:"Action.Submit",id:"cancel",title:"Cancel"}]}]}),i=new a.EvaluationContext;i.$root={title:this.title,catalogue:e};var r=n.expand(i),o=new s.AdaptiveCard;o.hostConfig=c.defaultHostConfig,o.onExecuteAction=function(n){"cancel"==n.id?t.close():n instanceof s.SubmitAction&&(t._selectedSample=e[n.data.catalogueIndex],t.close())},o.onParseElement=function(e,t,n){e instanceof s.CardElementContainer&&(e.allowVerticalOverflow=s.getBoolValue(t.allowVerticalOverflow,!1))},o.parse(r);var l=o.render();l.style.height="100%",this._renderedElement.innerHTML="",this._renderedElement.appendChild(l)},t.prototype.renderContent=function(){var e=this;this._renderedElement=document.createElement("div"),this._renderedElement.style.overflow="auto",this.renderMessage("Loading sample catalogue...");var t=new u.Downloader(this.catalogueUrl);return t.onError=function(){e.renderMessage("The catalogue couldn't be loaded. Please try again later.")},t.onSuccess=function(){if(!s.isNullOrEmpty(t.data))try{var n=o.parseCatalogue(JSON.parse(t.data));e.renderCatalogue(n)}catch(t){e.renderMessage("The catalogue couldn't be loaded. Please try again later.")}},t.download(),this._renderedElement},Object.defineProperty(t.prototype,"selectedSample",{get:function(){return this._selectedSample},enumerable:!0,configurable:!0}),t}(l.Dialog);t.SamplePickerDialog=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._isOpen=!1,this.onClose=null}return e.prototype.open=function(){if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className="acd-dialog-overlay";var e=document.createElement("div");e.className="acd-dialog-frame",e.style.width=this.width,e.style.height=this.height;var t=this.renderContent();t.style.flex="1 1 auto",e.appendChild(t),this._overlayElement.appendChild(e),document.body.appendChild(this._overlayElement),this._isOpen=!0}},e.prototype.close=function(){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this))},e}();t.Dialog=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adaptiveCardSchema={$schema:"http://json-schema.org/draft-06/schema#",id:"http://adaptivecards.io/schemas/adaptive-card.json",type:"object",title:"Microsoft Adaptive Card Schema",additionalProperties:!0,allOf:[{$ref:"#/definitions/AdaptiveCard"}],properties:{version:{type:"string",description:"version of schema that this card was authored "},minVersion:{type:"string",description:"if a client doesn't support the minVersion the card should be rejected and return the fallbackText.  If it does, then the elements that are not supported are safe to ignore"},fallbackText:{type:"string",description:"if a client is not able to show the card, show fallbackText to the user. This can be in markdown format. "},speak:{type:"string",description:"Specifies what should be spoken for this entire Item. This is simple text or SSML fragment"}},required:["version"],definitions:{Action:{anyOf:[{$ref:"#/definitions/Action.Submit"},{$ref:"#/definitions/Action.ShowCard"},{$ref:"#/definitions/Action.OpenUrl"}]},"Action.OpenUrl":{additionalProperties:!0,description:"When Action.OpenUrl is invoked it will show the given url, either by launching it to an external web browser or showing in-situ with embedded web browser.",properties:{title:{type:"string",description:"Label for button or link that represents this action"},type:{type:"string",description:"Must be Action.OpenUrl",enum:["Action.OpenUrl"]},url:{type:"string",description:"The URL to open"}},required:["type","url"],type:"object"},"Action.ShowCard":{type:"object",additionalProperties:!0,description:"Action.ShowCard defines an inline AdaptiveCard which is shown to the user when it is clicked.",properties:{type:{type:"string",description:"Must be Action.ShowCard",enum:["Action.ShowCard"]},title:{type:"string",description:"Label for button or link that represents this action"},card:{$ref:"#/definitions/AdaptiveCard"}},required:["type","card"]},"Action.Submit":{type:"object",additionalProperties:!0,description:"Submit action gathers up input fields, merges with optional data field and generates event to client asking for data to be submitted. It is up to the client to determine how that data is processed. For example: With BotFramework bots the client would send an activity through the messaging medium to the bot.",properties:{type:{type:"string",description:"Must be Action.Submit",enum:["Action.Submit"]},title:{type:"string",description:"Label for button or link that represents this action"},data:{type:["string","object"],description:"initial data that input fields will be combined with. This is essentially 'hidden' properties"}},required:["type"]},Actions:{additionalItems:!0,items:{$ref:"#/definitions/Action"},type:"array"},AdaptiveCard:{additionalProperties:!0,type:"object",description:"Card schema for an adaptive card",properties:{type:{type:"string",description:"Must be AdaptiveCard",enum:["AdaptiveCard"]},actions:{description:"The Actions to show in the card's action bar",$ref:"#/definitions/Actions"},body:{description:"The Card Elements to show in the primary card region",$ref:"#/definitions/CardElements"}},required:["type","version"]},CardElement:{additionalProperties:!0,properties:{type:{type:"string"},id:{type:"string",description:"A unique Id associated with the element"},spacing:{$ref:"#/definitions/SpacingStyle"},separator:{type:"boolean",description:"The Separator object type describes the look and feel of a separation line between two elements.",default:!1}},required:["type"]},CardElements:{type:"array",additionalItems:!0,items:[{anyOf:[{$ref:"#/definitions/TextBlock"},{$ref:"#/definitions/Image"},{$ref:"#/definitions/Container"},{$ref:"#/definitions/ColumnSet"},{$ref:"#/definitions/FactSet"},{$ref:"#/definitions/ImageSet"},{$ref:"#/definitions/Input.Text"},{$ref:"#/definitions/Input.Number"},{$ref:"#/definitions/Input.Date"},{$ref:"#/definitions/Input.Time"},{$ref:"#/definitions/Input.Toggle"},{$ref:"#/definitions/Input.ChoiceSet"}]}]},"Input.Choice":{type:"object",description:'Describes a Choice input. The value should be a simple string without a ","',additionalProperties:!0,properties:{type:{type:"string",enum:["Input.Choice"]},title:{type:"string",description:"The text for a choice"},value:{type:"string",description:'The raw value for the choice. NOTE: do not use a "," in the value, since MultiSelect ChoiceSet returns a comma-delimited string of choice values'}},required:["title","value"]},ChoiceInputStyle:{type:"string",description:"Style hint for Input.ChoiceSet",enum:["compact","expanded"]},Column:{additionalProperties:!0,type:"object",description:"Defines a container that is part of a ColumnSet",allOf:[{$ref:"#/definitions/CardElement"}],properties:{items:{description:"The Card Elements to include in the Column",$ref:"#/definitions/CardElements"},selectAction:{description:"An Action that will be invoked when the Column is tapped or selected",$ref:"#/definitions/Action"},width:{type:["string","number"],description:'"auto", "stretch", or a number representing relative width of the column in the column group'},type:{type:"string",description:"Must be Column",enum:["Column"]}},required:["items"]},ColumnSet:{additionalProperties:!0,type:"object",description:"ColumnSet divides a region into Column's allowing elements to sit side-by-side",allOf:[{$ref:"#/definitions/CardElement"}],properties:{columns:{type:"array",description:"The array of Columns to divide the region into",items:{$ref:"#/definitions/Column"}},selectAction:{$ref:"#/definitions/Action",description:"The Action that is executed when the ColumnSet is clicked/tapped"},type:{type:"string",description:"Must be ColumnSet",enum:["ColumnSet"]}}},Container:{additionalProperties:!0,type:"object",description:"Containers group items together",allOf:[{$ref:"#/definitions/CardElement"}],properties:{items:{description:"The Card Elements to render inside the Container",$ref:"#/definitions/CardElements"},selectAction:{description:"An Action that will be invoked when the Image is tapped or selected",$ref:"#/definitions/Action"},style:{type:"string",description:"Style hint for Container",enum:["default","emphasis"]},type:{type:"string",description:"Must be Container",enum:["Container"]}},required:["items"]},Fact:{additionalProperties:!0,type:"object",description:"Describes a Fact in a FactSet as a key/value pair",properties:{type:{type:"string",enum:["Fact"]},title:{type:"string",description:"The title of the fact"},value:{type:"string",description:"The value of the fact"}},required:["title","value"]},FactSet:{additionalProperties:!0,type:"object",description:"The FactSet Item makes it simple to display a series of facts (e.g. name/value pairs) in a tabular form.",allOf:[{$ref:"#/definitions/CardElement"}],properties:{facts:{type:"array",description:"The array of Facts",items:{$ref:"#/definitions/Fact"}},type:{type:"string",description:"Must be FactSet",enum:["FactSet"]}},required:["facts"]},HorizontalAlignment:{type:"string",description:"Controls how Items are horizontally positioned within their container.",enum:["left","center","right"]},Image:{additionalProperties:!0,type:"object",description:"The Image Item allows for the inclusion of images in an Adaptive Card.",allOf:[{$ref:"#/definitions/CardElement"}],properties:{altText:{type:"string",description:"Alternate text for the image for accessibility"},horizontalAlignment:{$ref:"#/definitions/HorizontalAlignment"},selectAction:{description:"An Action that will be invoked when the Image is tapped or selected",$ref:"#/definitions/Action"},size:{type:"object",$ref:"#/definitions/ImageSize"},style:{$ref:"#/definitions/ImageStyle"},type:{type:"string",description:"Must be Image",enum:["Image"]},url:{type:"string",description:"The URL to the image."}},required:["url"]},ImageSet:{additionalProperties:!0,type:"object",description:"The ImageSet allows for the inclusion of a collection images like a photogallery.",allOf:[{$ref:"#/definitions/CardElement"}],properties:{images:{type:"array",description:"The array of Image elements to show",items:{$ref:"#/definitions/Image"}},imageSize:{$ref:"#/definitions/ImageSize"},type:{type:"string",description:"Must be ImageSet",enum:["ImageSet"]}},required:["images"]},ImageSize:{type:"string",description:'Controls the approximate size of the image. The physical dimensions will vary per host. Specify "auto" for true image dimension or "stretch" to force it to fill the container',default:"auto",enum:["auto","stretch","small","medium","large"]},ImageStyle:{type:"string",description:"Controls the way Images are displayed",enum:["default","person"]},"Input.ChoiceSet":{additionalProperties:!0,type:"object",description:"Shows an array of Choice objects",allOf:[{$ref:"#/definitions/CardElement"}],properties:{choices:{type:"array",description:"the choice options",items:{$ref:"#/definitions/Input.Choice"}},id:{type:"string",description:"Id for the value (will be used to identify collected input when SUBMIT is clicked)"},isMultiSelect:{type:"boolean",description:"allow multiple choices to be selected",default:!1},style:{$ref:"#/definitions/ChoiceInputStyle"},type:{description:"Must be Input.ChoiceInput",enum:["Input.ChoiceSet"],type:"string"},value:{type:"string",description:"The initial choice (or set of choices) that should be selected. For multi-select, specifcy a comma-separated string of values"}},required:["id","choices"]},"Input.Date":{additionalProperties:!0,type:"object",description:"Input.Date collects Date from the user,",allOf:[{$ref:"#/definitions/CardElement"}],properties:{id:{type:"string",description:"Id for the value (will be used to identify collected input when SUBMIT is clicked)"},max:{type:"string",description:"hint of maximum value expressed in ISO-8601 format (may be ignored by some clients)"},min:{type:"string",description:"hint of minimum value expressed in ISO-8601 format (may be ignored by some clients)"},placeholder:{type:"string",description:"Title Description of the input desired"},type:{type:"string",description:"The type must be Input.Date",enum:["Input.Date"]},value:{type:"string",description:"The initial value for a field expressed in ISO-8601 format"}},required:["id"]},"Input.Number":{additionalProperties:!0,type:"object",description:"Input.Number collects number from the user,",allOf:[{$ref:"#/definitions/CardElement"}],properties:{id:{type:"string",description:"Id for the value (will be used to identify collected input when SUBMIT is clicked)"},max:{type:"number",description:"hint of maximum value (may be ignored by some clients)"},min:{type:"number",description:"hint of minimum value (may be ignored by some clients)"},placeholder:{type:"string",description:"Title Description of the input desired"},type:{type:"string",description:"The type must be Input.Number",enum:["Input.Number"]},value:{type:"number",description:"The initial value for a field"}},required:["id"]},"Input.Text":{additionalProperties:!0,type:"object",description:"Input.Text collects text from the user,",allOf:[{$ref:"#/definitions/CardElement"}],properties:{id:{type:"string",description:"Id for the value (will be used to identify collected input when SUBMIT is clicked)"},isMultiline:{type:"boolean",description:"Do you want to allow multiple lines of input"},maxLength:{type:"number",description:"hint of maximum length characters to collect (may be ignored by some clients)"},placeholder:{type:"string",description:"Title Description of the input desired"},style:{$ref:"#/definitions/TextInputStyle"},type:{type:"string",description:"Input.Text",enum:["Input.Text"]},value:{type:"string",description:"The initial value for a field"}},required:["id"]},"Input.Time":{additionalProperties:!0,type:"object",description:"Input.Time collects Time from the user,",allOf:[{$ref:"#/definitions/CardElement"}],properties:{id:{type:"string",description:"Id for the value (will be used to identify collected input when SUBMIT is clicked)"},max:{type:"string",description:"hint of maximum value (may be ignored by some clients)"},min:{type:"string",description:"hint of minimum value (may be ignored by some clients)"},placeholder:{type:"string",description:"Title Description of the input desired"},type:{type:"string",description:"The type must be Input.Time",enum:["Input.Time"]},value:{type:"string",description:"The initial value for a field expressed in ISO-8601 format"}},required:["id"]},"Input.Toggle":{additionalProperties:!0,type:"object",description:"Input.Toggle collects a true/false response from the user",allOf:[{$ref:"#/definitions/CardElement"}],properties:{id:{type:"string",description:"Id for the value (will be used to identify collected input when SUBMIT is clicked)"},title:{type:"string",description:"Title for the toggle"},type:{type:"string",description:"Input.Toggle",enum:["Input.Toggle"]},value:{type:"string",description:"The current selected value (default:false)"},valueOff:{type:"string",description:"The value when toggle is off (default:false)"},valueOn:{type:"string",description:"The value when toggle is on (default:true)"}},required:["id","title"]},TextBlock:{additionalProperties:!0,type:"object",description:"The TextBlock Item allows for the inclusion of text, with various font sizes, weight and color, in Adaptive Cards.",allOf:[{$ref:"#/definitions/CardElement"}],properties:{color:{type:"string",description:"Controls the color of TextBlock Items.",enum:["default","dark","light","accent","good","warning","attention"]},horizontalAlignment:{$ref:"#/definitions/HorizontalAlignment"},isSubtle:{type:"boolean",description:"Indicates whether the color of the text should be slightly toned down to appear less prominent"},maxLines:{type:"number",description:"When Wrap is true, you can specify the maximum number of lines to allow the textBlock to use."},size:{type:"string",description:"controls size of the text.",enum:["small","default","medium","large","extraLarge"]},text:{type:"string",description:"The actual text to display"},type:{type:"string",description:"Must be TextBlock",enum:["TextBlock"]},weight:{type:"string",description:"Controls the weight of TextBlock Items",enum:["lighter","default","bolder"]},wrap:{type:"boolean",description:"True if be is allowed to wrap"}},required:["text"]},SeparatorStyle:{type:"object",description:"Indicates whether there should be a visible separator (e.g. a line) between the element and the one before it. If this property is not specified, no separator is displayed. If it is, a separator line is displayed. A separator will only appear if there was a preceding element.",properties:{thickness:{type:"string",description:"Specifies the thickness of the separation line.",enum:["default","thick"]},color:{type:"string",description:"Specifies the color of the separation line.",enum:["default","accent"]}}},SpacingStyle:{type:"string",description:"Controls the amount of spacing between this element and the previous element.",enum:["none","small","default","medium","large","extraLarge","padding"]},TextInputStyle:{type:"string",description:"Style hint for Input.Text.",enum:["text","tel","url","email"]}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){var e=this,t=document.body;void 0!==t.onfullscreenchange?t.onfullscreenchange=function(){return e.fullScrerenChanged()}:void 0!==t.onwebkitfullscreenchange?t.onwebkitfullscreenchange=function(){return e.fullScrerenChanged()}:void 0!==t.onwebkitfullscreenchange?t.onmozfullscreenchange=function(){return e.fullScrerenChanged()}:void 0!==t.onwebkitfullscreenchange&&(t.MSFullscreenChange=function(){return e.fullScrerenChanged()})}return e.prototype.fullScrerenChanged=function(){this.onFullScreenChanged&&this.onFullScreenChanged(this.isFullScreen)},e.prototype.enterFullScreen=function(){if(!this.isFullScreen){var e=document.body;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen?e.msRequestFullscreen():alert("Your browser doesn't support fullscreen.")}},e.prototype.exitFullScreen=function(){if(this.isFullScreen){var e=document;e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen()}},e.prototype.toggleFullScreen=function(){this.isFullScreen?this.exitFullScreen():this.enterFullScreen()},Object.defineProperty(e.prototype,"isFullScreen",{get:function(){var e=document;return e.fullscreen||e.webkitIsFullScreen||e.mozFullScreen},enumerable:!0,configurable:!0}),e}();t.FullScreenHandler=i},function(e,t,n){"use strict";var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){var n=e.call(this)||this;n._children=null,n.field=t,n._level=0;for(var i=t;i;)n._level++,i=i.parent;return n}return r(t,e),t.prototype.buildChildList=function(){if(!this._children){this._children=[];var e=this.field.children;if(e)for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];this._children.push(new t(e[r]))}}},t.prototype.getLabelText=function(){return this.field.name},t.prototype.getAdditionalText=function(){return this.field.typeName},t.prototype.getAdditionalTextClass=function(){return"acd-data-tree-item-additionalText"},t.prototype.isDraggable=function(){return!0},t.prototype.getChildCount=function(){return this.buildChildList(),this._children.length},t.prototype.getChildAt=function(e){return this.buildChildList(),this._children[e]},t}(n(16).BaseTreeItem);t.DataTreeItem=o}]);
//# sourceMappingURL=adaptivecards-designer-standalone.min.js.map